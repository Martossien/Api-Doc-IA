var ir=Object.defineProperty;var or=(n,e,t)=>e in n?ir(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var pt=(n,e,t)=>or(n,typeof e!="symbol"?e+"":e,t);import{s as Be,e as I,k as j,c as M,a as k,d as g,o as z,f as h,i as V,g as p,n as ve,t as F,b as J,y as Ue,z as it,u as ue,h as K,Q as Fe,I as Xe,j as Ee,p as Je,G as gt,q as bt,A as je,C as Ke,r as ar,v as fr,w as ur,x as cr,E as we,F as ye,l as he,S as Rt,D as De,N as dr,an as hr,V as Lt,P as Bt,T as mr,U as gr}from"./BGNgVYh3.js";import{S as Re,i as Le,b as x,d as ee,m as te,t as b,a as D,e as le,f as Qe,g as se,c as ne,j as St}from"./C6dEUarp.js";import{e as Ve,u as Gt,o as In,d as _r}from"./turx_FrY.js";import{m as jt,d as ul,i as Mn,a as yt,h as pr,G as vr,H as br,c as En,T as cl,u as zt,l as Zt,e as Pt,W as kr,b as dl,z as hl,C as wr}from"./Ddw9c9t3.js";import{t as Ae,m as At}from"./DkM_xcvk.js";import{f as yr,u as Ir,i as Mr}from"./B9iOIv0q.js";import{b as Jt,u as Er,m as Nn,w as Nr,f as vt,r as Ht,l as Dn,v as ml}from"./DrS-4eQT.js";import{d as ot}from"./aTHIJebK.js";import"./BFK-koEx.js";import{u as gl,c as Dr}from"./D3sf5Q8i.js";import{c as Vr}from"./A_kjc2DP.js";import{s as Cr}from"./BWegKEMO.js";import{i as Tr,E as Br}from"./DojZQdIM.js";import{P as Vn,N as Kt}from"./Bzt6H4Jo.js";import{aG as Cn,aV as Sr,aK as It,aW as Or,aL as Tn,aX as Rr}from"./DZGcT-Hq.js";import{T as Se}from"./BgYnntxx.js";import{T as Lr}from"./CB8dXRyf.js";import{S as Ut}from"./DXnw_on2.js";import{C as Bn}from"./Dmj69WAY.js";import{C as Sn}from"./B0RiTW03.js";import{M as Pr}from"./C07PinlS.js";import{C as On}from"./C4WLwjDy.js";import{I as Ar}from"./D_0mvULt.js";import{M as Rn}from"./CIrONVe_.js";import{B as Qt}from"./BXIh2GG5.js";import{C as Hr}from"./BKvpN_Dy.js";import{X as jr}from"./CAYxTtyO.js";import{E as zr}from"./DOrDDWcM.js";import"./CF4_YkFU.js";import{c as _l}from"./CMrSS5J_.js";import{F as Ln}from"./3TXs4Mjm.js";import{L as Ur}from"./DuBcfHpe.js";import{f as Ot}from"./vGXHMVqm.js";import{F as Wr}from"./CU2r43ac.js";function qr(n){return new Worker(""+new URL("../workers/kokoro.worker-Cev3ZHQt.js",import.meta.url).href,{type:"module",name:n==null?void 0:n.name})}class Fr{constructor(e="fp32"){pt(this,"worker",null);pt(this,"initialized",!1);pt(this,"dtype");pt(this,"requestQueue",[]);pt(this,"processing",!1);this.dtype=e}async init(){if(this.worker){console.warn("KokoroWorker is already initialized.");return}return this.worker=new qr,this.worker.onmessage=e=>{const{status:t,error:l,audioUrl:s}=e.data;if(t==="init:complete")this.initialized=!0;else if(t==="init:error")console.error(l),this.initialized=!1;else if(t==="generate:complete"){const r=this.requestQueue.shift();r&&(r.resolve(s),this.processNextRequest())}else if(t==="generate:error"){const r=this.requestQueue.shift();r&&(r.reject(new Error(l)),this.processNextRequest())}},new Promise((e,t)=>{this.worker.postMessage({type:"init",payload:{dtype:this.dtype}});const l=s=>{s.data.status==="init:complete"?(this.worker.removeEventListener("message",l),this.initialized=!0,e()):s.data.status==="init:error"&&(this.worker.removeEventListener("message",l),t(new Error(s.data.error)))};this.worker.addEventListener("message",l)})}async generate({text:e,voice:t}){if(!this.initialized||!this.worker)throw new Error("KokoroTTS Worker is not initialized yet.");return new Promise((l,s)=>{this.requestQueue.push({text:e,voice:t,resolve:l,reject:s}),this.processing||this.processNextRequest()})}processNextRequest(){if(this.requestQueue.length===0){this.processing=!1;return}this.processing=!0;const{text:e,voice:t}=this.requestQueue[0];this.worker.postMessage({type:"generate",payload:{text:e,voice:t}})}terminate(){this.worker&&(this.worker.terminate(),this.worker=null,this.initialized=!1,this.requestQueue=[],this.processing=!1)}}function Jr(n){let e,t,l,s,r,i,o,a,f,u,c,m,d,_,w,y,E,C,S,L,R,v,N,B,O,T;return{c(){e=I("div"),t=I("div"),l=I("div"),s=I("div"),i=j(),o=I("div"),a=I("div"),u=j(),c=I("div"),d=j(),_=I("div"),w=I("div"),E=j(),C=I("div"),L=j(),R=I("div"),N=j(),B=I("div"),this.h()},l(H){e=M(H,"DIV",{class:!0});var A=k(e);t=M(A,"DIV",{class:!0});var X=k(t);l=M(X,"DIV",{class:!0});var oe=k(l);s=M(oe,"DIV",{class:!0}),k(s).forEach(g),i=z(oe),o=M(oe,"DIV",{class:!0});var ie=k(o);a=M(ie,"DIV",{class:!0}),k(a).forEach(g),u=z(ie),c=M(ie,"DIV",{class:!0}),k(c).forEach(g),ie.forEach(g),d=z(oe),_=M(oe,"DIV",{class:!0});var re=k(_);w=M(re,"DIV",{class:!0}),k(w).forEach(g),E=z(re),C=M(re,"DIV",{class:!0}),k(C).forEach(g),L=z(re),R=M(re,"DIV",{class:!0}),k(R).forEach(g),re.forEach(g),N=z(oe),B=M(oe,"DIV",{class:!0}),k(B).forEach(g),oe.forEach(g),X.forEach(g),A.forEach(g),this.h()},h(){h(s,"class",r=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm mr-14"),h(a,"class",f=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2"),h(c,"class",m=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1"),h(o,"class","grid grid-cols-3 gap-4"),h(w,"class",y=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1"),h(C,"class",S=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2"),h(R,"class",v=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1 mr-4"),h(_,"class","grid grid-cols-4 gap-4"),h(B,"class",O=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm"),h(l,"class",T=(n[0]==="md"?"space-y-2":"space-y-1.5")+" w-full"),h(t,"class","animate-pulse flex w-full"),h(e,"class","w-full mt-2 mb-2")},m(H,A){V(H,e,A),p(e,t),p(t,l),p(l,s),p(l,i),p(l,o),p(o,a),p(o,u),p(o,c),p(l,d),p(l,_),p(_,w),p(_,E),p(_,C),p(_,L),p(_,R),p(l,N),p(l,B)},p(H,[A]){A&1&&r!==(r=(H[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm mr-14")&&h(s,"class",r),A&1&&f!==(f=(H[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2")&&h(a,"class",f),A&1&&m!==(m=(H[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1")&&h(c,"class",m),A&1&&y!==(y=(H[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1")&&h(w,"class",y),A&1&&S!==(S=(H[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2")&&h(C,"class",S),A&1&&v!==(v=(H[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1 mr-4")&&h(R,"class",v),A&1&&O!==(O=(H[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm")&&h(B,"class",O),A&1&&T!==(T=(H[0]==="md"?"space-y-2":"space-y-1.5")+" w-full")&&h(l,"class",T)},i:ve,o:ve,d(H){H&&g(e)}}}function Gr(n,e,t){let{size:l="md"}=e;return n.$$set=s=>{"size"in s&&t(0,l=s.size)},[l]}class Xt extends Re{constructor(e){super(),Le(this,e,Gr,Jr,Be,{size:0})}}function pl(n,e,t){const l=n.slice();return l[23]=e[t],l}function vl(n,e,t){const l=n.slice();return l[26]=e[t],l}function bl(n){var s;let e,t=n[8].t('This response was generated by "{{model}}"',{model:n[7]?((s=n[7])==null?void 0:s.name)??n[7].id:n[1].selectedModelId})+"",l;return{c(){e=I("div"),l=F(t),this.h()},l(r){e=M(r,"DIV",{class:!0});var i=k(e);l=J(i,t),i.forEach(g),this.h()},h(){h(e,"class","text-xs font-medium pt-1.5 -mb-0.5")},m(r,i){V(r,e,i),p(e,l)},p(r,i){var o;i&386&&t!==(t=r[8].t('This response was generated by "{{model}}"',{model:r[7]?((o=r[7])==null?void 0:o.name)??r[7].id:r[1].selectedModelId})+"")&&K(l,t)},d(r){r&&g(e)}}}function kl(n){let e,t=n[26]+"",l,s,r,i,o,a;function f(){return n[12](n[26])}return{c(){e=I("button"),l=F(t),s=j(),this.h()},l(u){e=M(u,"BUTTON",{class:!0});var c=k(e);l=J(c,t),s=z(c),c.forEach(g),this.h()},h(){var u,c;h(e,"class",r="size-7 text-sm border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[6]===n[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900"),e.disabled=i=((c=(u=n[1])==null?void 0:u.annotation)==null?void 0:c.rating)===-1?n[26]>5:n[26]<6},m(u,c){V(u,e,c),p(e,l),p(e,s),o||(a=ue(e,"click",f),o=!0)},p(u,c){var m,d;n=u,c&64&&r!==(r="size-7 text-sm border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[6]===n[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900")&&h(e,"class",r),c&2&&i!==(i=((d=(m=n[1])==null?void 0:m.annotation)==null?void 0:d.rating)===-1?n[26]>5:n[26]<6)&&(e.disabled=i)},d(u){u&&g(e),o=!1,a()}}}function wl(n){let e,t=n[8].t("Why?")+"",l,s,r,i=Ve(n[3]),o=[];for(let a=0;a<i.length;a+=1)o[a]=yl(pl(n,i,a));return{c(){e=I("div"),l=F(t),s=j(),r=I("div");for(let a=0;a<o.length;a+=1)o[a].c();this.h()},l(a){e=M(a,"DIV",{class:!0});var f=k(e);l=J(f,t),f.forEach(g),s=z(a),r=M(a,"DIV",{class:!0});var u=k(r);for(let c=0;c<o.length;c+=1)o[c].l(u);u.forEach(g),this.h()},h(){h(e,"class","text-sm mt-1.5 font-medium"),h(r,"class","flex flex-wrap gap-1.5 text-sm mt-1.5")},m(a,f){V(a,e,f),p(e,l),V(a,s,f),V(a,r,f);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(r,null)},p(a,f){if(f&256&&t!==(t=a[8].t("Why?")+"")&&K(l,t),f&280){i=Ve(a[3]);let u;for(u=0;u<i.length;u+=1){const c=pl(a,i,u);o[u]?o[u].p(c,f):(o[u]=yl(c),o[u].c(),o[u].m(r,null))}for(;u<o.length;u+=1)o[u].d(1);o.length=i.length}},d(a){a&&(g(e),g(s),g(r)),Fe(o,a)}}}function Zr(n){let e=n[23]+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){V(l,t,s)},p(l,s){s&8&&e!==(e=l[23]+"")&&K(t,e)},d(l){l&&g(t)}}}function Kr(n){let e=n[8].t("Other")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Other")+"")&&K(t,e)},d(l){l&&g(t)}}}function Qr(n){let e=n[8].t("Being lazy")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Being lazy")+"")&&K(t,e)},d(l){l&&g(t)}}}function Xr(n){let e=n[8].t("Refused when it shouldn't have")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Refused when it shouldn't have")+"")&&K(t,e)},d(l){l&&g(t)}}}function Yr(n){let e=n[8].t("Didn't fully follow instructions")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Didn't fully follow instructions")+"")&&K(t,e)},d(l){l&&g(t)}}}function $r(n){let e=n[8].t("Not factually correct")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not factually correct")+"")&&K(t,e)},d(l){l&&g(t)}}}function xr(n){let e=n[8].t("Not helpful")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not helpful")+"")&&K(t,e)},d(l){l&&g(t)}}}function ei(n){let e=n[8].t("Too verbose")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Too verbose")+"")&&K(t,e)},d(l){l&&g(t)}}}function ti(n){let e=n[8].t("Don't like the style")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Don't like the style")+"")&&K(t,e)},d(l){l&&g(t)}}}function li(n){let e=n[8].t("Thorough explanation")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Thorough explanation")+"")&&K(t,e)},d(l){l&&g(t)}}}function si(n){let e=n[8].t("Attention to detail")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Attention to detail")+"")&&K(t,e)},d(l){l&&g(t)}}}function ni(n){let e=n[8].t("Positive attitude")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Positive attitude")+"")&&K(t,e)},d(l){l&&g(t)}}}function ri(n){let e=n[8].t("Showcased creativity")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Showcased creativity")+"")&&K(t,e)},d(l){l&&g(t)}}}function ii(n){let e=n[8].t("Followed instructions perfectly")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Followed instructions perfectly")+"")&&K(t,e)},d(l){l&&g(t)}}}function oi(n){let e=n[8].t("Accurate information")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Accurate information")+"")&&K(t,e)},d(l){l&&g(t)}}}function yl(n){let e,t,l,s,r;function i(u,c){return u[23]==="accurate_information"?oi:u[23]==="followed_instructions_perfectly"?ii:u[23]==="showcased_creativity"?ri:u[23]==="positive_attitude"?ni:u[23]==="attention_to_detail"?si:u[23]==="thorough_explanation"?li:u[23]==="dont_like_the_style"?ti:u[23]==="too_verbose"?ei:u[23]==="not_helpful"?xr:u[23]==="not_factually_correct"?$r:u[23]==="didnt_fully_follow_instructions"?Yr:u[23]==="refused_when_it_shouldnt_have"?Xr:u[23]==="being_lazy"?Qr:u[23]==="other"?Kr:Zr}let o=i(n),a=o(n);function f(){return n[13](n[23])}return{c(){e=I("button"),a.c(),t=j(),this.h()},l(u){e=M(u,"BUTTON",{class:!0});var c=k(e);a.l(c),t=z(c),c.forEach(g),this.h()},h(){h(e,"class",l="px-3 py-0.5 border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[4]===n[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")},m(u,c){V(u,e,c),a.m(e,null),p(e,t),s||(r=ue(e,"click",f),s=!0)},p(u,c){n=u,o===(o=i(n))&&a?a.p(n,c):(a.d(1),a=o(n),a&&(a.c(),a.m(e,t))),c&24&&l!==(l="px-3 py-0.5 border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[4]===n[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")&&h(e,"class",l)},d(u){u&&g(e),a.d(),s=!1,r()}}}function ai(n){var $;let e,t,l,s,r=n[8].t("How would you rate this response?")+"",i,o,a,f='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"></path></svg>',u,c,m,d,_,w,y,E,C=n[8].t("Awful")+"",S,L,R,v,N=n[8].t("Amazing")+"",B,O,T,H,A,X,oe,ie,re,ce,me,Ie,W,G=n[8].t("Save")+"",ge,pe,q,de,fe,_e=(($=n[1])==null?void 0:$.arena)&&bl(n),be=Ve(Array.from({length:10}).map(Il)),P=[];for(let Z=0;Z<be.length;Z+=1)P[Z]=kl(vl(n,be,Z));let Q=n[3].length>0&&wl(n);return me=new Lr({props:{tags:n[2]}}),me.$on("delete",n[15]),me.$on("add",n[16]),{c(){_e&&_e.c(),e=j(),t=I("div"),l=I("div"),s=I("div"),i=F(r),o=j(),a=I("button"),a.innerHTML=f,u=j(),c=I("div"),m=I("div"),d=I("div");for(let Z=0;Z<P.length;Z+=1)P[Z].c();_=j(),w=I("div"),y=I("div"),E=F("1 - "),S=F(C),L=j(),R=I("div"),v=F("10 - "),B=F(N),O=j(),T=I("div"),Q&&Q.c(),H=j(),A=I("div"),X=I("textarea"),ie=j(),re=I("div"),ce=I("div"),x(me.$$.fragment),Ie=j(),W=I("button"),ge=F(G),this.h()},l(Z){_e&&_e.l(Z),e=z(Z),t=M(Z,"DIV",{class:!0,id:!0});var ae=k(t);l=M(ae,"DIV",{class:!0});var ke=k(l);s=M(ke,"DIV",{class:!0});var Ce=k(s);i=J(Ce,r),Ce.forEach(g),o=z(ke),a=M(ke,"BUTTON",{"data-svelte-h":!0}),Ue(a)!=="svelte-1ew22ui"&&(a.innerHTML=f),ke.forEach(g),u=z(ae),c=M(ae,"DIV",{class:!0});var Y=k(c);m=M(Y,"DIV",{class:!0});var Pe=k(m);d=M(Pe,"DIV",{class:!0});var He=k(d);for(let nt=0;nt<P.length;nt+=1)P[nt].l(He);He.forEach(g),_=z(Pe),w=M(Pe,"DIV",{class:!0});var ze=k(w);y=M(ze,"DIV",{});var qe=k(y);E=J(qe,"1 - "),S=J(qe,C),qe.forEach(g),L=z(ze),R=M(ze,"DIV",{});var Ye=k(R);v=J(Ye,"10 - "),B=J(Ye,N),Ye.forEach(g),ze.forEach(g),Pe.forEach(g),Y.forEach(g),O=z(ae),T=M(ae,"DIV",{});var st=k(T);Q&&Q.l(st),st.forEach(g),H=z(ae),A=M(ae,"DIV",{class:!0});var at=k(A);X=M(at,"TEXTAREA",{class:!0,placeholder:!0,rows:!0}),k(X).forEach(g),at.forEach(g),ie=z(ae),re=M(ae,"DIV",{class:!0});var lt=k(re);ce=M(lt,"DIV",{class:!0});var ft=k(ce);ee(me.$$.fragment,ft),ft.forEach(g),Ie=z(lt),W=M(lt,"BUTTON",{class:!0});var ut=k(W);ge=J(ut,G),ut.forEach(g),lt.forEach(g),ae.forEach(g),this.h()},h(){h(s,"class","text-sm font-medium"),h(l,"class","flex justify-between items-center"),h(d,"class","mt-1.5 w-fit flex gap-1 pb-5"),h(w,"class","absolute bottom-0 left-0 right-0 flex justify-between text-xs"),h(m,"class","relative w-fit"),h(c,"class","w-full flex justify-center"),h(X,"class","w-full text-sm px-1 py-2 bg-transparent outline-hidden resize-none rounded-xl"),h(X,"placeholder",oe=n[8].t("Feel free to add specific details")),h(X,"rows","3"),h(A,"class","mt-2"),h(ce,"class","flex items-end group"),h(W,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),h(re,"class","mt-2 gap-1.5 flex justify-between"),h(t,"class","my-2.5 rounded-xl px-4 py-3 border border-gray-100 dark:border-gray-850"),h(t,"id",pe="message-feedback-"+n[1].id)},m(Z,ae){_e&&_e.m(Z,ae),V(Z,e,ae),V(Z,t,ae),p(t,l),p(l,s),p(s,i),p(l,o),p(l,a),p(t,u),p(t,c),p(c,m),p(m,d);for(let ke=0;ke<P.length;ke+=1)P[ke]&&P[ke].m(d,null);p(m,_),p(m,w),p(w,y),p(y,E),p(y,S),p(w,L),p(w,R),p(R,v),p(R,B),p(t,O),p(t,T),Q&&Q.m(T,null),p(t,H),p(t,A),p(A,X),it(X,n[5]),p(t,ie),p(t,re),p(re,ce),te(me,ce,null),p(re,Ie),p(re,W),p(W,ge),q=!0,de||(fe=[ue(a,"click",n[11]),ue(X,"input",n[14]),ue(W,"click",n[17])],de=!0)},p(Z,[ae]){var Ce;if((Ce=Z[1])!=null&&Ce.arena?_e?_e.p(Z,ae):(_e=bl(Z),_e.c(),_e.m(e.parentNode,e)):_e&&(_e.d(1),_e=null),(!q||ae&256)&&r!==(r=Z[8].t("How would you rate this response?")+"")&&K(i,r),ae&66){be=Ve(Array.from({length:10}).map(Il));let Y;for(Y=0;Y<be.length;Y+=1){const Pe=vl(Z,be,Y);P[Y]?P[Y].p(Pe,ae):(P[Y]=kl(Pe),P[Y].c(),P[Y].m(d,null))}for(;Y<P.length;Y+=1)P[Y].d(1);P.length=be.length}(!q||ae&256)&&C!==(C=Z[8].t("Awful")+"")&&K(S,C),(!q||ae&256)&&N!==(N=Z[8].t("Amazing")+"")&&K(B,N),Z[3].length>0?Q?Q.p(Z,ae):(Q=wl(Z),Q.c(),Q.m(T,null)):Q&&(Q.d(1),Q=null),(!q||ae&256&&oe!==(oe=Z[8].t("Feel free to add specific details")))&&h(X,"placeholder",oe),ae&32&&it(X,Z[5]);const ke={};ae&4&&(ke.tags=Z[2]),me.$set(ke),(!q||ae&256)&&G!==(G=Z[8].t("Save")+"")&&K(ge,G),(!q||ae&2&&pe!==(pe="message-feedback-"+Z[1].id))&&h(t,"id",pe)},i(Z){q||(b(me.$$.fragment,Z),q=!0)},o(Z){D(me.$$.fragment,Z),q=!1},d(Z){Z&&(g(e),g(t)),_e&&_e.d(Z),Fe(P,Z),Q&&Q.d(),le(me),de=!1,Xe(fe)}}}const Il=(n,e)=>e+1;function fi(n,e,t){let l,s;Ee(n,jt,T=>t(18,s=T));const r=Je("i18n");Ee(n,r,T=>t(8,l=T));const i=gt();let{message:o}=e,{show:a=!1}=e,f=["accurate_information","followed_instructions_perfectly","showcased_creativity","positive_attitude","attention_to_detail","thorough_explanation","other"],u=["dont_like_the_style","too_verbose","not_helpful","not_factually_correct","didnt_fully_follow_instructions","refused_when_it_shouldnt_have","being_lazy","other"],c=[],m=[],d=null,_="",w=null,y=null;const E=()=>{var T,H,A,X,oe;d||t(4,d=((T=o==null?void 0:o.annotation)==null?void 0:T.reason)??""),_||t(5,_=((H=o==null?void 0:o.annotation)==null?void 0:H.comment)??""),t(2,c=(((A=o==null?void 0:o.annotation)==null?void 0:A.tags)??[]).map(ie=>({name:ie}))),w||t(6,w=((oe=(X=o==null?void 0:o.annotation)==null?void 0:X.details)==null?void 0:oe.rating)??null)};bt(()=>{o!=null&&o.arena&&(t(7,y=s.find(T=>T.id===o.selectedModelId)),Ae.success(l.t('This response was generated by "{{model}}"',{model:y?(y==null?void 0:y.name)??y.id:o.selectedModelId})))});const C=()=>{console.log("saveHandler"),i("save",{reason:d,comment:_,tags:c.map(T=>T.name),details:{rating:w}}),Ae.success(l.t("Thanks for your feedback!")),t(0,a=!1)},S=()=>{t(0,a=!1)},L=T=>{t(6,w=T)},R=T=>{t(4,d=T)};function v(){_=this.value,t(5,_)}const N=T=>{t(2,c=c.filter(H=>H.name.replaceAll(" ","_").toLowerCase()!==T.detail.replaceAll(" ","_").toLowerCase()))},B=T=>{t(2,c=[...c,{name:T.detail}])},O=()=>{C()};return n.$$set=T=>{"message"in T&&t(1,o=T.message),"show"in T&&t(0,a=T.show)},n.$$.update=()=>{var T,H;n.$$.dirty&2&&(((T=o==null?void 0:o.annotation)==null?void 0:T.rating)===1?t(3,m=f):((H=o==null?void 0:o.annotation)==null?void 0:H.rating)===-1&&t(3,m=u)),n.$$.dirty&2&&o&&E()},[a,o,c,m,d,_,w,y,l,r,C,S,L,R,v,N,B,O]}class ui extends Re{constructor(e){super(),Le(this,e,fi,ai,Be,{message:1,show:0})}}function Ml(n,e,t){const l=n.slice();return l[5]=e[t],l[7]=t,l}function ci(n){let e,t;return e=new Bn({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function di(n){let e,t;return e=new Sn({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function hi(n){let e,t,l,s,r;const i=n[2].default,o=ar(i,n,n[4],null),a=[di,ci],f=[];function u(c,m){return c[1]?0:1}return l=u(n),s=f[l]=a[l](n),{c(){e=I("div"),o&&o.c(),t=j(),s.c(),this.h()},l(c){e=M(c,"DIV",{class:!0});var m=k(e);o&&o.l(m),t=z(m),s.l(m),m.forEach(g),this.h()},h(){h(e,"class","flex items-center gap-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition")},m(c,m){V(c,e,m),o&&o.m(e,null),p(e,t),f[l].m(e,null),r=!0},p(c,m){o&&o.p&&(!r||m&16)&&fr(o,i,c,c[4],r?cr(i,c[4],m,null):ur(c[4]),null);let d=l;l=u(c),l!==d&&(se(),D(f[d],1,1,()=>{f[d]=null}),ne(),s=f[l],s||(s=f[l]=a[l](c),s.c()),b(s,1),s.m(e,null))},i(c){r||(b(o,c),b(s),r=!0)},o(c){D(o,c),D(s),r=!1},d(c){c&&g(e),o&&o.d(c),f[l].d()}}}function El(n){let e,t,l,s,r,i=n[0].query+"",o,a,f,u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',c,m;return l=new Pr({}),{c(){e=I("a"),t=I("div"),x(l.$$.fragment),s=j(),r=I("div"),o=F(i),a=j(),f=I("div"),f.innerHTML=u,this.h()},l(d){e=M(d,"A",{href:!0,target:!0,class:!0});var _=k(e);t=M(_,"DIV",{class:!0});var w=k(t);ee(l.$$.fragment,w),s=z(w),r=M(w,"DIV",{class:!0});var y=k(r);o=J(y,i),y.forEach(g),w.forEach(g),a=z(_),f=M(_,"DIV",{class:!0,"data-svelte-h":!0}),Ue(f)!=="svelte-14xjows"&&(f.innerHTML=u),_.forEach(g),this.h()},h(){h(r,"class","line-clamp-1"),h(t,"class","flex gap-2 items-center"),h(f,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),h(e,"href",c="https://www.google.com/search?q="+n[0].query),h(e,"target","_blank"),h(e,"class","flex w-full items-center p-3 px-4 border-b border-gray-300/30 dark:border-gray-700/50 group/item justify-between font-normal text-gray-800 dark:text-gray-300 no-underline")},m(d,_){V(d,e,_),p(e,t),te(l,t,null),p(t,s),p(t,r),p(r,o),p(e,a),p(e,f),m=!0},p(d,_){(!m||_&1)&&i!==(i=d[0].query+"")&&K(o,i),(!m||_&1&&c!==(c="https://www.google.com/search?q="+d[0].query))&&h(e,"href",c)},i(d){m||(b(l.$$.fragment,d),m=!0)},o(d){D(l.$$.fragment,d),m=!1},d(d){d&&g(e),le(l)}}}function Nl(n){let e,t,l=n[5]+"",s,r,i,o='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',a,f,u;return{c(){e=I("a"),t=I("div"),s=F(l),r=j(),i=I("div"),i.innerHTML=o,a=j(),this.h()},l(c){e=M(c,"A",{href:!0,target:!0,class:!0});var m=k(e);t=M(m,"DIV",{class:!0});var d=k(t);s=J(d,l),d.forEach(g),r=z(m),i=M(m,"DIV",{class:!0,"data-svelte-h":!0}),Ue(i)!=="svelte-14xjows"&&(i.innerHTML=o),a=z(m),m.forEach(g),this.h()},h(){h(t,"class","line-clamp-1"),h(i,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),h(e,"href",f=n[5]),h(e,"target","_blank"),h(e,"class",u="flex w-full items-center p-3 px-4 "+(n[7]===n[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")},m(c,m){V(c,e,m),p(e,t),p(t,s),p(e,r),p(e,i),p(e,a)},p(c,m){m&1&&l!==(l=c[5]+"")&&K(s,l),m&1&&f!==(f=c[5])&&h(e,"href",f),m&1&&u!==(u="flex w-full items-center p-3 px-4 "+(c[7]===c[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")&&h(e,"class",u)},d(c){c&&g(e)}}}function mi(n){var o;let e,t,l,s=((o=n[0])==null?void 0:o.query)&&El(n),r=Ve(n[0].urls),i=[];for(let a=0;a<r.length;a+=1)i[a]=Nl(Ml(n,r,a));return{c(){e=I("div"),s&&s.c(),t=j();for(let a=0;a<i.length;a+=1)i[a].c();this.h()},l(a){e=M(a,"DIV",{class:!0,slot:!0});var f=k(e);s&&s.l(f),t=z(f);for(let u=0;u<i.length;u+=1)i[u].l(f);f.forEach(g),this.h()},h(){h(e,"class","text-sm border border-gray-300/30 dark:border-gray-700/50 rounded-xl mb-1.5"),h(e,"slot","content")},m(a,f){V(a,e,f),s&&s.m(e,null),p(e,t);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(e,null);l=!0},p(a,f){var u;if((u=a[0])!=null&&u.query?s?(s.p(a,f),f&1&&b(s,1)):(s=El(a),s.c(),b(s,1),s.m(e,t)):s&&(se(),D(s,1,1,()=>{s=null}),ne()),f&1){r=Ve(a[0].urls);let c;for(c=0;c<r.length;c+=1){const m=Ml(a,r,c);i[c]?i[c].p(m,f):(i[c]=Nl(m),i[c].c(),i[c].m(e,null))}for(;c<i.length;c+=1)i[c].d(1);i.length=r.length}},i(a){l||(b(s),l=!0)},o(a){D(s),l=!1},d(a){a&&g(e),s&&s.d(),Fe(i,a)}}}function gi(n){let e,t,l;function s(i){n[3](i)}let r={className:"w-full space-y-1",$$slots:{content:[mi],default:[hi]},$$scope:{ctx:n}};return n[1]!==void 0&&(r.open=n[1]),e=new Cn({props:r}),je.push(()=>Qe(e,"open",s)),{c(){x(e.$$.fragment)},l(i){ee(e.$$.fragment,i)},m(i,o){te(e,i,o),l=!0},p(i,[o]){const a={};o&19&&(a.$$scope={dirty:o,ctx:i}),!t&&o&2&&(t=!0,a.open=i[1],Ke(()=>t=!1)),e.$set(a)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){le(e,i)}}}function _i(n,e,t){let{$$slots:l={},$$scope:s}=e,{status:r={urls:[],query:""}}=e,i=!1;function o(a){i=a,t(1,i)}return n.$$set=a=>{"status"in a&&t(0,r=a.status),"$$scope"in a&&t(4,s=a.$$scope)},[r,i,l,o,s]}class pi extends Re{constructor(e){super(),Le(this,e,_i,gi,Be,{status:0})}}function vi(n){let e,t;return{c(){e=we("svg"),t=we("path"),this.h()},l(l){e=ye(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ye(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(g),s.forEach(g),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width",n[1]),h(e,"stroke","currentColor"),h(e,"class",n[0])},m(l,s){V(l,e,s),p(e,t)},p(l,[s]){s&2&&h(e,"stroke-width",l[1]),s&1&&h(e,"class",l[0])},i:ve,o:ve,d(l){l&&g(e)}}}function bi(n,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class ki extends Re{constructor(e){super(),Le(this,e,bi,vi,Be,{className:0,strokeWidth:1})}}function wi(n){let e,t,l,s,r,i=(typeof n[0]=="string"?n[0]:JSON.stringify(n[0]))+"",o,a;return l=new Ar({props:{className:"size-5 text-red-700 dark:text-red-400"}}),{c(){e=I("div"),t=I("div"),x(l.$$.fragment),s=j(),r=I("div"),o=F(i),this.h()},l(f){e=M(f,"DIV",{class:!0});var u=k(e);t=M(u,"DIV",{class:!0});var c=k(t);ee(l.$$.fragment,c),c.forEach(g),s=z(u),r=M(u,"DIV",{class:!0});var m=k(r);o=J(m,i),m.forEach(g),u.forEach(g),this.h()},h(){h(t,"class","self-start mt-0.5"),h(r,"class","self-center text-sm"),h(e,"class","flex my-2 gap-2.5 border px-4 py-3 border-red-600/10 bg-red-600/10 rounded-lg")},m(f,u){V(f,e,u),p(e,t),te(l,t,null),p(e,s),p(e,r),p(r,o),a=!0},p(f,[u]){(!a||u&1)&&i!==(i=(typeof f[0]=="string"?f[0]:JSON.stringify(f[0]))+"")&&K(o,i)},i(f){a||(b(l.$$.fragment,f),a=!0)},o(f){D(l.$$.fragment,f),a=!1},d(f){f&&g(e),le(l)}}}function yi(n,e,t){let{content:l=""}=e;return n.$$set=s=>{"content"in s&&t(0,l=s.content)},[l]}let Ii=class extends Re{constructor(e){super(),Le(this,e,yi,wi,Be,{content:0})}};function Dl(n,e,t){const l=n.slice();return l[10]=e[t],l[12]=t,l}function Mi(n){const e=n.slice(),t=Pi(e[10].distance);return e[13]=t,e}function Ei(n){let e,t=n[4].t("No source available")+"",l;return{c(){e=I("div"),l=F(t),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=k(e);l=J(r,t),r.forEach(g),this.h()},h(){h(e,"class","text-sm dark:text-gray-400")},m(s,r){V(s,e,r),p(e,l)},p(s,r){r&16&&t!==(t=s[4].t("No source available")+"")&&K(l,t)},i:ve,o:ve,d(s){s&&g(e)}}}function Ni(n){let e,t,l,s;e=new Se({props:{className:"w-fit",content:n[4].t("Open file"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[Di]},$$scope:{ctx:n}}});let r=n[2]&&Cl(n);return{c(){x(e.$$.fragment),t=j(),r&&r.c(),l=he()},l(i){ee(e.$$.fragment,i),t=z(i),r&&r.l(i),l=he()},m(i,o){te(e,i,o),V(i,t,o),r&&r.m(i,o),V(i,l,o),s=!0},p(i,o){const a={};o&16&&(a.content=i[4].t("Open file")),o&16408&&(a.$$scope={dirty:o,ctx:i}),e.$set(a),i[2]?r?(r.p(i,o),o&4&&b(r,1)):(r=Cl(i),r.c(),b(r,1),r.m(l.parentNode,l)):r&&(se(),D(r,1,1,()=>{r=null}),ne())},i(i){s||(b(e.$$.fragment,i),b(r),s=!0)},o(i){D(e.$$.fragment,i),D(r),s=!1},d(i){i&&(g(t),g(l)),le(e,i),r&&r.d(i)}}}function Vl(n){let e,t,l=n[4].t("page")+"",s,r,i=n[10].metadata.page+1+"",o,a;return{c(){e=I("span"),t=F("("),s=F(l),r=j(),o=F(i),a=F(")"),this.h()},l(f){e=M(f,"SPAN",{class:!0});var u=k(e);t=J(u,"("),s=J(u,l),r=z(u),o=J(u,i),a=J(u,")"),u.forEach(g),this.h()},h(){h(e,"class","text-xs text-gray-500 dark:text-gray-400")},m(f,u){V(f,e,u),p(e,t),p(e,s),p(e,r),p(e,o),p(e,a)},p(f,u){u&16&&l!==(l=f[4].t("page")+"")&&K(s,l),u&8&&i!==(i=f[10].metadata.page+1+"")&&K(o,i)},d(f){f&&g(e)}}}function Di(n){var a,f,u,c;let e,t,l=n[6](((f=(a=n[10])==null?void 0:a.metadata)==null?void 0:f.name)??n[10].source.name)+"",s,r,i,o=((c=(u=n[10])==null?void 0:u.metadata)==null?void 0:c.page)&&Vl(n);return{c(){e=I("div"),t=I("a"),s=F(l),i=j(),o&&o.c(),this.h()},l(m){e=M(m,"DIV",{class:!0});var d=k(e);t=M(d,"A",{class:!0,href:!0,target:!0});var _=k(t);s=J(_,l),_.forEach(g),i=z(d),o&&o.l(d),d.forEach(g),this.h()},h(){var m,d,_,w,y,E,C,S;h(t,"class","hover:text-gray-500 dark:hover:text-gray-100 underline grow"),h(t,"href",r=(d=(m=n[10])==null?void 0:m.metadata)!=null&&d.file_id?`${ul}/files/${(w=(_=n[10])==null?void 0:_.metadata)==null?void 0:w.file_id}/content${((E=(y=n[10])==null?void 0:y.metadata)==null?void 0:E.page)!==void 0?`#page=${n[10].metadata.page+1}`:""}`:(S=(C=n[10].source)==null?void 0:C.url)!=null&&S.includes("http")?n[10].source.url:"#"),h(t,"target","_blank"),h(e,"class","text-sm dark:text-gray-400 flex items-center gap-2 w-fit")},m(m,d){V(m,e,d),p(e,t),p(t,s),p(e,i),o&&o.m(e,null)},p(m,d){var _,w,y,E,C,S,L,R,v,N,B,O;d&8&&l!==(l=m[6](((w=(_=m[10])==null?void 0:_.metadata)==null?void 0:w.name)??m[10].source.name)+"")&&K(s,l),d&8&&r!==(r=(E=(y=m[10])==null?void 0:y.metadata)!=null&&E.file_id?`${ul}/files/${(S=(C=m[10])==null?void 0:C.metadata)==null?void 0:S.file_id}/content${((R=(L=m[10])==null?void 0:L.metadata)==null?void 0:R.page)!==void 0?`#page=${m[10].metadata.page+1}`:""}`:(N=(v=m[10].source)==null?void 0:v.url)!=null&&N.includes("http")?m[10].source.url:"#")&&h(t,"href",r),(O=(B=m[10])==null?void 0:B.metadata)!=null&&O.page?o?o.p(m,d):(o=Vl(m),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(m){m&&g(e),o&&o.d()}}}function Cl(n){let e,t=n[4].t("Relevance")+"",l,s,r,i,o,a;const f=[Ci,Vi],u=[];function c(m,d){return m[10].distance!==void 0?0:1}return r=c(n),i=u[r]=f[r](n),{c(){e=I("div"),l=F(t),s=j(),i.c(),o=he(),this.h()},l(m){e=M(m,"DIV",{class:!0});var d=k(e);l=J(d,t),d.forEach(g),s=z(m),i.l(m),o=he(),this.h()},h(){h(e,"class","text-sm font-medium dark:text-gray-300 mt-2")},m(m,d){V(m,e,d),p(e,l),V(m,s,d),u[r].m(m,d),V(m,o,d),a=!0},p(m,d){(!a||d&16)&&t!==(t=m[4].t("Relevance")+"")&&K(l,t);let _=r;r=c(m),r===_?u[r].p(m,d):(se(),D(u[_],1,1,()=>{u[_]=null}),ne(),i=u[r],i?i.p(m,d):(i=u[r]=f[r](m),i.c()),b(i,1),i.m(o.parentNode,o))},i(m){a||(b(i),a=!0)},o(m){D(i),a=!1},d(m){m&&(g(e),g(s),g(o)),u[r].d(m)}}}function Vi(n){let e,t=n[4].t("No distance available")+"",l;return{c(){e=I("div"),l=F(t),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=k(e);l=J(r,t),r.forEach(g),this.h()},h(){h(e,"class","text-sm dark:text-gray-400")},m(s,r){V(s,e,r),p(e,l)},p(s,r){r&16&&t!==(t=s[4].t("No distance available")+"")&&K(l,t)},i:ve,o:ve,d(s){s&&g(e)}}}function Ci(n){let e,t;return e=new Se({props:{className:"w-fit",content:n[4].t("Semantic distance to query"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[Bi]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s&16&&(r.content=l[4].t("Semantic distance to query")),s&16394&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Ti(n){var s;let e,t=(((s=n[10])==null?void 0:s.distance)??0).toFixed(4)+"",l;return{c(){e=I("span"),l=F(t),this.h()},l(r){e=M(r,"SPAN",{class:!0});var i=k(e);l=J(i,t),i.forEach(g),this.h()},h(){h(e,"class","text-gray-500 dark:text-gray-500")},m(r,i){V(r,e,i),p(e,l)},p(r,i){var o;i&8&&t!==(t=(((o=r[10])==null?void 0:o.distance)??0).toFixed(4)+"")&&K(l,t)},d(r){r&&g(e)}}}function Tl(n){var a;let e,t,l,s=(((a=n[10])==null?void 0:a.distance)??0).toFixed(4)+"",r,i,o=typeof n[13]=="number"&&Bl(n);return{c(){o&&o.c(),e=j(),t=I("span"),l=F("("),r=F(s),i=F(")"),this.h()},l(f){o&&o.l(f),e=z(f),t=M(f,"SPAN",{class:!0});var u=k(t);l=J(u,"("),r=J(u,s),i=J(u,")"),u.forEach(g),this.h()},h(){h(t,"class","text-gray-500 dark:text-gray-500")},m(f,u){o&&o.m(f,u),V(f,e,u),V(f,t,u),p(t,l),p(t,r),p(t,i)},p(f,u){var c;typeof f[13]=="number"?o?o.p(f,u):(o=Bl(f),o.c(),o.m(e.parentNode,e)):o&&(o.d(1),o=null),u&8&&s!==(s=(((c=f[10])==null?void 0:c.distance)??0).toFixed(4)+"")&&K(r,s)},d(f){f&&(g(e),g(t)),o&&o.d(f)}}}function Bl(n){let e,t=n[13].toFixed(2)+"",l,s,r;return{c(){e=I("span"),l=F(t),s=F("%"),this.h()},l(i){e=M(i,"SPAN",{class:!0});var o=k(e);l=J(o,t),s=J(o,"%"),o.forEach(g),this.h()},h(){h(e,"class",r=`px-1 rounded-sm font-medium ${Rl(n[13])}`)},m(i,o){V(i,e,o),p(e,l),p(e,s)},p(i,o){o&8&&t!==(t=i[13].toFixed(2)+"")&&K(l,t),o&8&&r!==(r=`px-1 rounded-sm font-medium ${Rl(i[13])}`)&&h(e,"class",r)},d(i){i&&g(e)}}}function Bi(n){let e;function t(i,o){return i[1]?Tl:Ti}function l(i,o){return o===Tl?Mi(i):i}let s=t(n),r=s(l(n,s));return{c(){e=I("div"),r.c(),this.h()},l(i){e=M(i,"DIV",{class:!0});var o=k(e);r.l(o),o.forEach(g),this.h()},h(){h(e,"class","text-sm my-1 dark:text-gray-400 flex items-center gap-2 w-fit")},m(i,o){V(i,e,o),r.m(e,null)},p(i,o){s===(s=t(i))&&r?r.p(l(i,s),o):(r.d(1),r=s(l(i,s)),r&&(r.c(),r.m(e,null)))},d(i){i&&g(e),r.d()}}}function Si(n){let e,t,l=n[10].document+"",s,r;return{c(){e=I("pre"),t=F("                "),s=F(l),r=F(`
              `),this.h()},l(i){e=M(i,"PRE",{class:!0});var o=k(e);t=J(o,"                "),s=J(o,l),r=J(o,`
              `),o.forEach(g),this.h()},h(){h(e,"class","text-sm dark:text-gray-400 whitespace-pre-line")},m(i,o){V(i,e,o),p(e,t),p(e,s),p(e,r)},p(i,o){o&8&&l!==(l=i[10].document+"")&&K(s,l)},d(i){i&&g(e)}}}function Oi(n){let e,t,l;return{c(){e=I("iframe"),this.h()},l(s){e=M(s,"IFRAME",{class:!0,sandbox:!0,srcdoc:!0,title:!0}),k(e).forEach(g),this.h()},h(){h(e,"class","w-full border-0 h-auto rounded-none"),h(e,"sandbox","allow-scripts allow-forms allow-same-origin"),h(e,"srcdoc",t=n[10].document),h(e,"title",l=n[4].t("Content"))},m(s,r){V(s,e,r)},p(s,r){r&8&&t!==(t=s[10].document)&&h(e,"srcdoc",t),r&16&&l!==(l=s[4].t("Content"))&&h(e,"title",l)},d(s){s&&g(e)}}}function Sl(n){let e;return{c(){e=I("hr"),this.h()},l(t){e=M(t,"HR",{class:!0}),this.h()},h(){h(e,"class","border-gray-100 dark:border-gray-850 my-3")},m(t,l){V(t,e,l)},d(t){t&&g(e)}}}function Ol(n){let e,t,l=n[4].t("Source")+"",s,r,i,o,a,f,u,c=n[4].t("Content")+"",m,d,_,w,y;const E=[Ni,Ei],C=[];function S(B,O){var T;return(T=B[10].source)!=null&&T.name?0:1}i=S(n),o=C[i]=E[i](n);function L(B,O){var T;return(T=B[10].metadata)!=null&&T.html?Oi:Si}let R=L(n),v=R(n),N=n[12]!==n[3].length-1&&Sl();return{c(){e=I("div"),t=I("div"),s=F(l),r=j(),o.c(),a=j(),f=I("div"),u=I("div"),m=F(c),d=j(),v.c(),_=j(),N&&N.c(),w=he(),this.h()},l(B){e=M(B,"DIV",{class:!0});var O=k(e);t=M(O,"DIV",{class:!0});var T=k(t);s=J(T,l),T.forEach(g),r=z(O),o.l(O),O.forEach(g),a=z(B),f=M(B,"DIV",{class:!0});var H=k(f);u=M(H,"DIV",{class:!0});var A=k(u);m=J(A,c),A.forEach(g),d=z(H),v.l(H),H.forEach(g),_=z(B),N&&N.l(B),w=he(),this.h()},h(){h(t,"class","text-sm font-medium dark:text-gray-300"),h(e,"class","flex flex-col w-full"),h(u,"class","text-sm font-medium dark:text-gray-300 mt-2"),h(f,"class","flex flex-col w-full")},m(B,O){V(B,e,O),p(e,t),p(t,s),p(e,r),C[i].m(e,null),V(B,a,O),V(B,f,O),p(f,u),p(u,m),p(f,d),v.m(f,null),V(B,_,O),N&&N.m(B,O),V(B,w,O),y=!0},p(B,O){(!y||O&16)&&l!==(l=B[4].t("Source")+"")&&K(s,l);let T=i;i=S(B),i===T?C[i].p(B,O):(se(),D(C[T],1,1,()=>{C[T]=null}),ne(),o=C[i],o?o.p(B,O):(o=C[i]=E[i](B),o.c()),b(o,1),o.m(e,null)),(!y||O&16)&&c!==(c=B[4].t("Content")+"")&&K(m,c),R===(R=L(B))&&v?v.p(B,O):(v.d(1),v=R(B),v&&(v.c(),v.m(f,null))),B[12]!==B[3].length-1?N||(N=Sl(),N.c(),N.m(w.parentNode,w)):N&&(N.d(1),N=null)},i(B){y||(b(o),y=!0)},o(B){D(o),y=!1},d(B){B&&(g(e),g(a),g(f),g(_),g(w)),C[i].d(),v.d(),N&&N.d(B)}}}function Ri(n){let e,t,l,s=n[4].t("Citation")+"",r,i,o,a='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',f,u,c,m,d,_,w=Ve(n[3]),y=[];for(let C=0;C<w.length;C+=1)y[C]=Ol(Dl(n,w,C));const E=C=>D(y[C],1,1,()=>{y[C]=null});return{c(){e=I("div"),t=I("div"),l=I("div"),r=F(s),i=j(),o=I("button"),o.innerHTML=a,f=j(),u=I("div"),c=I("div");for(let C=0;C<y.length;C+=1)y[C].c();this.h()},l(C){e=M(C,"DIV",{});var S=k(e);t=M(S,"DIV",{class:!0});var L=k(t);l=M(L,"DIV",{class:!0});var R=k(l);r=J(R,s),R.forEach(g),i=z(L),o=M(L,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(o)!=="svelte-745w2y"&&(o.innerHTML=a),L.forEach(g),f=z(S),u=M(S,"DIV",{class:!0});var v=k(u);c=M(v,"DIV",{class:!0});var N=k(c);for(let B=0;B<y.length;B+=1)y[B].l(N);N.forEach(g),v.forEach(g),S.forEach(g),this.h()},h(){h(l,"class","text-lg font-medium self-center capitalize"),h(o,"class","self-center"),h(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),h(c,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),h(u,"class","flex flex-col md:flex-row w-full px-6 pb-5 md:space-x-4")},m(C,S){V(C,e,S),p(e,t),p(t,l),p(l,r),p(t,i),p(t,o),p(e,f),p(e,u),p(u,c);for(let L=0;L<y.length;L+=1)y[L]&&y[L].m(c,null);m=!0,d||(_=ue(o,"click",n[8]),d=!0)},p(C,S){if((!m||S&16)&&s!==(s=C[4].t("Citation")+"")&&K(r,s),S&94){w=Ve(C[3]);let L;for(L=0;L<w.length;L+=1){const R=Dl(C,w,L);y[L]?(y[L].p(R,S),b(y[L],1)):(y[L]=Ol(R),y[L].c(),b(y[L],1),y[L].m(c,null))}for(se(),L=w.length;L<y.length;L+=1)E(L);ne()}},i(C){if(!m){for(let S=0;S<w.length;S+=1)b(y[S]);m=!0}},o(C){y=y.filter(Boolean);for(let S=0;S<y.length;S+=1)D(y[S]);m=!1},d(C){C&&g(e),Fe(y,C),d=!1,_()}}}function Li(n){let e,t,l;function s(i){n[9](i)}let r={size:"lg",$$slots:{default:[Ri]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.show=n[0]),e=new Rn({props:r}),je.push(()=>Qe(e,"show",s)),{c(){x(e.$$.fragment)},l(i){ee(e.$$.fragment,i)},m(i,o){te(e,i,o),l=!0},p(i,[o]){const a={};o&16415&&(a.$$scope={dirty:o,ctx:i}),!t&&o&1&&(t=!0,a.show=i[0],Ke(()=>t=!1)),e.$set(a)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){le(e,i)}}}function Pi(n){return typeof n!="number"?null:n<0?0:n>1?100:Math.round(n*1e4)/100}function Rl(n){return n>=80?"bg-green-200 dark:bg-green-800 text-green-800 dark:text-green-200":n>=60?"bg-yellow-200 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200":n>=40?"bg-orange-200 dark:bg-orange-800 text-orange-800 dark:text-orange-200":"bg-red-200 dark:bg-red-800 text-red-800 dark:text-red-200"}function Ai(n,e,t){let l;const s=Je("i18n");Ee(n,s,d=>t(4,l=d));let{show:r=!1}=e,{citation:i}=e,{showPercentage:o=!1}=e,{showRelevance:a=!0}=e,f=[];const u=d=>{try{return decodeURIComponent(d)}catch{return d}},c=()=>{t(0,r=!1)};function m(d){r=d,t(0,r)}return n.$$set=d=>{"show"in d&&t(0,r=d.show),"citation"in d&&t(7,i=d.citation),"showPercentage"in d&&t(1,o=d.showPercentage),"showRelevance"in d&&t(2,a=d.showRelevance)},n.$$.update=()=>{var d;n.$$.dirty&136&&i&&(t(3,f=(d=i.document)==null?void 0:d.map((_,w)=>{var y,E;return{source:i.source,document:_,metadata:(y=i.metadata)==null?void 0:y[w],distance:(E=i.distances)==null?void 0:E[w]}})),f.every(_=>_.distance!==void 0)&&t(3,f=f.sort((_,w)=>(w.distance??1/0)-(_.distance??1/0))))},[r,o,a,f,l,s,u,i,c,m]}class Hi extends Re{constructor(e){super(),Le(this,e,Ai,Li,Be,{show:0,citation:7,showPercentage:1,showRelevance:2})}}function Ll(n,e,t){const l=n.slice();return l[19]=e[t],l[21]=t,l}function Pl(n,e,t){const l=n.slice();return l[19]=e[t],l[21]=t,l}function Al(n,e,t){const l=n.slice();return l[19]=e[t],l[21]=t,l}function Hl(n){let e,t,l,s;const r=[zi,ji],i=[];function o(a,f){return a[1].length<=3?0:1}return t=o(n),l=i[t]=r[t](n),{c(){e=I("div"),l.c(),this.h()},l(a){e=M(a,"DIV",{class:!0});var f=k(e);l.l(f),f.forEach(g),this.h()},h(){h(e,"class","py-0.5 -mx-0.5 w-full flex gap-1 items-center flex-wrap")},m(a,f){V(a,e,f),i[t].m(e,null),s=!0},p(a,f){let u=t;t=o(a),t===u?i[t].p(a,f):(se(),D(i[u],1,1,()=>{i[u]=null}),ne(),l=i[t],l?l.p(a,f):(l=i[t]=r[t](a),l.c()),b(l,1),l.m(e,null))},i(a){s||(b(l),s=!0)},o(a){D(l),s=!1},d(a){a&&g(e),i[t].d()}}}function ji(n){let e,t,l;function s(i){n[18](i)}let r={id:`collapsible-${n[0]}`,className:"w-full max-w-full ",buttonClassName:"w-fit max-w-full",$$slots:{content:[Fi],default:[qi]},$$scope:{ctx:n}};return n[6]!==void 0&&(r.open=n[6]),e=new Cn({props:r}),je.push(()=>Qe(e,"open",s)),{c(){x(e.$$.fragment)},l(i){ee(e.$$.fragment,i)},m(i,o){te(e,i,o),l=!0},p(i,o){const a={};o&1&&(a.id=`collapsible-${i[0]}`),o&16777459&&(a.$$scope={dirty:o,ctx:i}),!t&&o&64&&(t=!0,a.open=i[6],Ke(()=>t=!1)),e.$set(a)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){le(e,i)}}}function zi(n){let e,t=Ve(n[1]),l=[];for(let s=0;s<t.length;s+=1)l[s]=Fl(Al(n,t,s));return{c(){e=I("div");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){e=M(s,"DIV",{class:!0});var r=k(e);for(let i=0;i<l.length;i+=1)l[i].l(r);r.forEach(g),this.h()},h(){h(e,"class","flex text-xs font-medium flex-wrap")},m(s,r){V(s,e,r);for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(e,null)},p(s,r){if(r&563){t=Ve(s[1]);let i;for(i=0;i<t.length;i+=1){const o=Al(s,t,i);l[i]?l[i].p(o,r):(l[i]=Fl(o),l[i].c(),l[i].m(e,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=t.length}},i:ve,o:ve,d(s){s&&g(e),Fe(l,s)}}}function jl(n){let e,t=n[21]+1+"",l;return{c(){e=I("div"),l=F(t),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=k(e);l=J(r,t),r.forEach(g),this.h()},h(){h(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){V(s,e,r),p(e,l)},d(s){s&&g(e)}}}function zl(n){let e,t=n[1].every(n[13]),l,s,r=n[9](n[19].source.name)+"",i,o,a,f,u=t&&jl(n);function c(){return n[17](n[19])}return{c(){e=I("button"),u&&u.c(),l=j(),s=I("div"),i=F(r),o=j(),this.h()},l(m){e=M(m,"BUTTON",{class:!0});var d=k(e);u&&u.l(d),l=z(d),s=M(d,"DIV",{class:!0});var _=k(s);i=J(_,r),_.forEach(g),o=z(d),d.forEach(g),this.h()},h(){h(s,"class","flex-1 mx-1 truncate"),h(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(m,d){V(m,e,d),u&&u.m(e,null),p(e,l),p(e,s),p(s,i),p(e,o),a||(f=[ue(e,"click",c),ue(e,"pointerup",Ki)],a=!0)},p(m,d){n=m,d&2&&(t=n[1].every(n[13])),t?u||(u=jl(n),u.c(),u.m(e,l)):u&&(u.d(1),u=null),d&2&&r!==(r=n[9](n[19].source.name)+"")&&K(i,r)},d(m){m&&g(e),u&&u.d(),a=!1,Xe(f)}}}function Ui(n){let e,t;return e=new Bn({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Wi(n){let e,t;return e=new Sn({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function qi(n){let e,t,l,s=n[7].t("References from")+"",r,i,o,a,f,u,c,m=n[7].t("and")+"",d,_,w=n[1].length-2+"",y,E,C,S=n[7].t("more")+"",L,R,v,N,B,O,T=Ve(n[1].slice(0,2)),H=[];for(let ie=0;ie<T.length;ie+=1)H[ie]=zl(Ll(n,T,ie));const A=[Wi,Ui],X=[];function oe(ie,re){return ie[6]?0:1}return N=oe(n),B=X[N]=A[N](n),{c(){e=I("div"),t=I("div"),l=I("span"),r=F(s),i=j(),o=I("div"),a=I("div");for(let ie=0;ie<H.length;ie+=1)H[ie].c();f=j(),u=I("div"),c=I("span"),d=F(m),_=j(),y=F(w),E=j(),C=I("span"),L=F(S),R=j(),v=I("div"),B.c(),this.h()},l(ie){e=M(ie,"DIV",{class:!0});var re=k(e);t=M(re,"DIV",{class:!0});var ce=k(t);l=M(ce,"SPAN",{class:!0});var me=k(l);r=J(me,s),me.forEach(g),i=z(ce),o=M(ce,"DIV",{class:!0});var Ie=k(o);a=M(Ie,"DIV",{class:!0});var W=k(a);for(let de=0;de<H.length;de+=1)H[de].l(W);W.forEach(g),Ie.forEach(g),f=z(ce),u=M(ce,"DIV",{class:!0});var G=k(u);c=M(G,"SPAN",{class:!0});var ge=k(c);d=J(ge,m),ge.forEach(g),_=z(G),y=J(G,w),E=z(G),C=M(G,"SPAN",{});var pe=k(C);L=J(pe,S),pe.forEach(g),G.forEach(g),ce.forEach(g),R=z(re),v=M(re,"DIV",{class:!0});var q=k(v);B.l(q),q.forEach(g),re.forEach(g),this.h()},h(){h(l,"class","whitespace-nowrap hidden sm:inline shrink-0"),h(a,"class","flex text-xs font-medium items-center"),h(o,"class","flex items-center overflow-auto scrollbar-none w-full max-w-full flex-1"),h(c,"class","hidden sm:inline"),h(u,"class","flex items-center gap-1 whitespace-nowrap shrink-0"),h(t,"class","flex-1 flex items-center gap-1 overflow-auto scrollbar-none w-full max-w-full"),h(v,"class","shrink-0"),h(e,"class","flex w-full overflow-auto items-center gap-2 text-gray-500 hover:text-gray-600 dark:hover:text-gray-400 transition cursor-pointer")},m(ie,re){V(ie,e,re),p(e,t),p(t,l),p(l,r),p(t,i),p(t,o),p(o,a);for(let ce=0;ce<H.length;ce+=1)H[ce]&&H[ce].m(a,null);p(t,f),p(t,u),p(u,c),p(c,d),p(u,_),p(u,y),p(u,E),p(u,C),p(C,L),p(e,R),p(e,v),X[N].m(v,null),O=!0},p(ie,re){if((!O||re&128)&&s!==(s=ie[7].t("References from")+"")&&K(r,s),re&562){T=Ve(ie[1].slice(0,2));let me;for(me=0;me<T.length;me+=1){const Ie=Ll(ie,T,me);H[me]?H[me].p(Ie,re):(H[me]=zl(Ie),H[me].c(),H[me].m(a,null))}for(;me<H.length;me+=1)H[me].d(1);H.length=T.length}(!O||re&128)&&m!==(m=ie[7].t("and")+"")&&K(d,m),(!O||re&2)&&w!==(w=ie[1].length-2+"")&&K(y,w),(!O||re&128)&&S!==(S=ie[7].t("more")+"")&&K(L,S);let ce=N;N=oe(ie),N!==ce&&(se(),D(X[ce],1,1,()=>{X[ce]=null}),ne(),B=X[N],B||(B=X[N]=A[N](ie),B.c()),b(B,1),B.m(v,null))},i(ie){O||(b(B),O=!0)},o(ie){D(B),O=!1},d(ie){ie&&g(e),Fe(H,ie),X[N].d()}}}function Ul(n){let e,t=n[21]+1+"",l;return{c(){e=I("div"),l=F(t),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=k(e);l=J(r,t),r.forEach(g),this.h()},h(){h(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){V(s,e,r),p(e,l)},d(s){s&&g(e)}}}function Wl(n){let e,t=n[1].every(n[12]),l,s,r=n[9](n[19].source.name)+"",i,o,a,f,u,c=t&&Ul(n);function m(){return n[16](n[19])}return{c(){e=I("button"),c&&c.c(),l=j(),s=I("div"),i=F(r),o=j(),this.h()},l(d){e=M(d,"BUTTON",{id:!0,class:!0});var _=k(e);c&&c.l(_),l=z(_),s=M(_,"DIV",{class:!0});var w=k(s);i=J(w,r),w.forEach(g),o=z(_),_.forEach(g),this.h()},h(){h(s,"class","flex-1 mx-1 truncate"),h(e,"id",a=`source-${n[0]}-${n[21]+1}`),h(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(d,_){V(d,e,_),c&&c.m(e,null),p(e,l),p(e,s),p(s,i),p(e,o),f||(u=ue(e,"click",m),f=!0)},p(d,_){n=d,_&2&&(t=n[1].every(n[12])),t?c||(c=Ul(n),c.c(),c.m(e,l)):c&&(c.d(1),c=null),_&2&&r!==(r=n[9](n[19].source.name)+"")&&K(i,r),_&1&&a!==(a=`source-${n[0]}-${n[21]+1}`)&&h(e,"id",a)},d(d){d&&g(e),c&&c.d(),f=!1,u()}}}function Fi(n){let e,t,l=Ve(n[1]),s=[];for(let r=0;r<l.length;r+=1)s[r]=Wl(Pl(n,l,r));return{c(){e=I("div"),t=I("div");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=M(r,"DIV",{slot:!0});var i=k(e);t=M(i,"DIV",{class:!0});var o=k(t);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(g),i.forEach(g),this.h()},h(){h(t,"class","flex text-xs font-medium flex-wrap"),h(e,"slot","content")},m(r,i){V(r,e,i),p(e,t);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(t,null)},p(r,i){if(i&563){l=Ve(r[1]);let o;for(o=0;o<l.length;o+=1){const a=Pl(r,l,o);s[o]?s[o].p(a,i):(s[o]=Wl(a),s[o].c(),s[o].m(t,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=l.length}},d(r){r&&g(e),Fe(s,r)}}}function ql(n){let e,t=n[21]+1+"",l;return{c(){e=I("div"),l=F(t),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=k(e);l=J(r,t),r.forEach(g),this.h()},h(){h(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){V(s,e,r),p(e,l)},d(s){s&&g(e)}}}function Fl(n){let e,t=n[1].every(n[11]),l,s,r=n[9](n[19].source.name)+"",i,o,a,f,u,c=t&&ql(n);function m(){return n[15](n[19])}return{c(){e=I("button"),c&&c.c(),l=j(),s=I("div"),i=F(r),o=j(),this.h()},l(d){e=M(d,"BUTTON",{id:!0,class:!0});var _=k(e);c&&c.l(_),l=z(_),s=M(_,"DIV",{class:!0});var w=k(s);i=J(w,r),w.forEach(g),o=z(_),_.forEach(g),this.h()},h(){h(s,"class","flex-1 mx-1 truncate text-black/60 hover:text-black dark:text-white/60 dark:hover:text-white transition"),h(e,"id",a=`source-${n[0]}-${n[21]+1}`),h(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-white dark:bg-gray-900 rounded-xl max-w-96")},m(d,_){V(d,e,_),c&&c.m(e,null),p(e,l),p(e,s),p(s,i),p(e,o),f||(u=ue(e,"click",m),f=!0)},p(d,_){n=d,_&2&&(t=n[1].every(n[11])),t?c||(c=ql(n),c.c(),c.m(e,l)):c&&(c.d(1),c=null),_&2&&r!==(r=n[9](n[19].source.name)+"")&&K(i,r),_&1&&a!==(a=`source-${n[0]}-${n[21]+1}`)&&h(e,"id",a)},d(d){d&&g(e),c&&c.d(),f=!1,u()}}}function Ji(n){let e,t,l,s,r;function i(f){n[14](f)}let o={citation:n[5],showPercentage:n[2],showRelevance:n[3]};n[4]!==void 0&&(o.show=n[4]),e=new Hi({props:o}),je.push(()=>Qe(e,"show",i));let a=n[1].length>0&&Hl(n);return{c(){x(e.$$.fragment),l=j(),a&&a.c(),s=he()},l(f){ee(e.$$.fragment,f),l=z(f),a&&a.l(f),s=he()},m(f,u){te(e,f,u),V(f,l,u),a&&a.m(f,u),V(f,s,u),r=!0},p(f,[u]){const c={};u&32&&(c.citation=f[5]),u&4&&(c.showPercentage=f[2]),u&8&&(c.showRelevance=f[3]),!t&&u&16&&(t=!0,c.show=f[4],Ke(()=>t=!1)),e.$set(c),f[1].length>0?a?(a.p(f,u),u&2&&b(a,1)):(a=Hl(f),a.c(),b(a,1),a.m(s.parentNode,s)):a&&(se(),D(a,1,1,()=>{a=null}),ne())},i(f){r||(b(e.$$.fragment,f),b(a),r=!0)},o(f){D(e.$$.fragment,f),D(a),r=!1},d(f){f&&(g(l),g(s)),le(e,f),a&&a.d(f)}}}function Gi(n){const e=n.flatMap(s=>s.distances??[]),t=e.filter(s=>s!==void 0&&s>=-1&&s<=1).length,l=e.filter(s=>s!==void 0&&(s<-1||s>1)).length;return!(e.length===0||t===e.length-1&&l===1||l===e.length-1&&t===1)}function Zi(n){return n.flatMap(t=>t.distances??[]).every(t=>t!==void 0&&t>=-1&&t<=1)}const Ki=n=>{n.stopPropagation()};function Qi(n,e,t){let l;const s=Je("i18n");Ee(n,s,v=>t(7,l=v));let{id:r=""}=e,{sources:i=[]}=e,o=[],a=!1,f=!0,u=!1,c=null,m=!1;const d=v=>{try{return decodeURIComponent(v)}catch{return v}},_=v=>v.distances!==void 0,w=v=>v.distances!==void 0,y=v=>v.distances!==void 0;function E(v){u=v,t(4,u)}const C=v=>{t(4,u=!0),t(5,c=v)},S=v=>{t(4,u=!0),t(5,c=v)},L=v=>{t(4,u=!0),t(5,c=v)};function R(v){m=v,t(6,m)}return n.$$set=v=>{"id"in v&&t(0,r=v.id),"sources"in v&&t(10,i=v.sources)},n.$$.update=()=>{n.$$.dirty&1026&&(console.log("sources",i),t(1,o=i.reduce((v,N)=>(Object.keys(N).length===0||N.document.forEach((B,O)=>{var ie,re,ce;const T=(ie=N.metadata)==null?void 0:ie[O],H=(re=N.distances)==null?void 0:re[O],A=(T==null?void 0:T.source)??((ce=N==null?void 0:N.source)==null?void 0:ce.id)??"N/A";let X=N==null?void 0:N.source;T!=null&&T.name&&(X={...X,name:T.name}),(A.startsWith("http://")||A.startsWith("https://"))&&(X={...X,name:A,url:A});const oe=v.find(me=>me.id===A);oe?(oe.document.push(B),oe.metadata.push(T),H!==void 0&&oe.distances.push(H)):v.push({id:A,source:X,document:[B],metadata:T?[T]:[],distances:H!==void 0?[H]:void 0})}),v),[])),t(3,f=Gi(o)),t(2,a=Zi(o)))},[r,o,a,f,u,c,m,l,s,d,i,_,w,y,E,C,S,L,R]}class Xi extends Re{constructor(e){super(),Le(this,e,Qi,Ji,Be,{id:0,sources:10})}}function Jl(n,e,t){const l=n.slice();return l[6]=e[t],l}function Gl(n){let e,t,l,s;const r=[xi,$i,Yi],i=[];function o(a,f){var u,c;return(u=a[1].result)!=null&&u.error?0:(c=a[1].result)!=null&&c.output?1:2}return t=o(n),l=i[t]=r[t](n),{c(){e=I("div"),l.c()},l(a){e=M(a,"DIV",{});var f=k(e);l.l(f),f.forEach(g)},m(a,f){V(a,e,f),i[t].m(e,null),s=!0},p(a,f){let u=t;t=o(a),t!==u&&(se(),D(i[u],1,1,()=>{i[u]=null}),ne(),l=i[t],l||(l=i[t]=r[t](a),l.c()),b(l,1),l.m(e,null))},i(a){s||(b(l),s=!0)},o(a){D(l),s=!1},d(a){a&&g(e),i[t].d()}}}function Yi(n){let e,t;return e=new Qt({props:{type:"warning",content:"incomplete"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function $i(n){let e,t;return e=new Qt({props:{type:"success",content:"success"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function xi(n){let e,t;return e=new Qt({props:{type:"error",content:"error"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Zl(n){let e,t,l;return t=new Ut({props:{className:"size-4"}}),{c(){e=I("div"),x(t.$$.fragment)},l(s){e=M(s,"DIV",{});var r=k(e);ee(t.$$.fragment,r),r.forEach(g)},m(s,r){V(s,e,r),te(t,e,null),l=!0},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&g(e),le(t)}}}function eo(n){let e=n[2].t("Code execution")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){V(l,t,s)},p(l,s){s&4&&e!==(e=l[2].t("Code execution")+"")&&K(t,e)},d(l){l&&g(t)}}}function to(n){var i;let e=n[2].t("Code execution")+"",t,l,s=((i=n[1])==null?void 0:i.name)+"",r;return{c(){t=F(e),l=F(": "),r=F(s)},l(o){t=J(o,e),l=J(o,": "),r=J(o,s)},m(o,a){V(o,t,a),V(o,l,a),V(o,r,a)},p(o,a){var f;a&4&&e!==(e=o[2].t("Code execution")+"")&&K(t,e),a&2&&s!==(s=((f=o[1])==null?void 0:f.name)+"")&&K(r,s)},d(o){o&&(g(t),g(l),g(r))}}}function Kl(n){var r,i,o,a;let e,t,l=((i=(r=n[1])==null?void 0:r.result)==null?void 0:i.error)&&Ql(n),s=((a=(o=n[1])==null?void 0:o.result)==null?void 0:a.output)&&Xl(n);return{c(){e=I("div"),l&&l.c(),t=j(),s&&s.c(),this.h()},l(f){e=M(f,"DIV",{class:!0});var u=k(e);l&&l.l(u),t=z(u),s&&s.l(u),u.forEach(g),this.h()},h(){h(e,"class","dark:bg-[#202123] dark:text-white px-4 py-4 rounded-b-lg flex flex-col gap-3")},m(f,u){V(f,e,u),l&&l.m(e,null),p(e,t),s&&s.m(e,null)},p(f,u){var c,m,d,_;(m=(c=f[1])==null?void 0:c.result)!=null&&m.error?l?l.p(f,u):(l=Ql(f),l.c(),l.m(e,t)):l&&(l.d(1),l=null),(_=(d=f[1])==null?void 0:d.result)!=null&&_.output?s?s.p(f,u):(s=Xl(f),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},d(f){f&&g(e),l&&l.d(),s&&s.d()}}}function Ql(n){var f,u;let e,t,l=n[2].t("ERROR")+"",s,r,i,o=((u=(f=n[1])==null?void 0:f.result)==null?void 0:u.error)+"",a;return{c(){e=I("div"),t=I("div"),s=F(l),r=j(),i=I("div"),a=F(o),this.h()},l(c){e=M(c,"DIV",{});var m=k(e);t=M(m,"DIV",{class:!0});var d=k(t);s=J(d,l),d.forEach(g),r=z(m),i=M(m,"DIV",{class:!0});var _=k(i);a=J(_,o),_.forEach(g),m.forEach(g),this.h()},h(){h(t,"class","text-gray-500 text-xs mb-1"),h(i,"class","text-sm")},m(c,m){V(c,e,m),p(e,t),p(t,s),p(e,r),p(e,i),p(i,a)},p(c,m){var d,_;m&4&&l!==(l=c[2].t("ERROR")+"")&&K(s,l),m&2&&o!==(o=((_=(d=c[1])==null?void 0:d.result)==null?void 0:_.error)+"")&&K(a,o)},d(c){c&&g(e)}}}function Xl(n){var f,u;let e,t,l=n[2].t("OUTPUT")+"",s,r,i,o=((u=(f=n[1])==null?void 0:f.result)==null?void 0:u.output)+"",a;return{c(){e=I("div"),t=I("div"),s=F(l),r=j(),i=I("div"),a=F(o),this.h()},l(c){e=M(c,"DIV",{});var m=k(e);t=M(m,"DIV",{class:!0});var d=k(t);s=J(d,l),d.forEach(g),r=z(m),i=M(m,"DIV",{class:!0});var _=k(i);a=J(_,o),_.forEach(g),m.forEach(g),this.h()},h(){h(t,"class","text-gray-500 text-xs mb-1"),h(i,"class","text-sm")},m(c,m){V(c,e,m),p(e,t),p(t,s),p(e,r),p(e,i),p(i,a)},p(c,m){var d,_;m&4&&l!==(l=c[2].t("OUTPUT")+"")&&K(s,l),m&2&&o!==(o=((_=(d=c[1])==null?void 0:d.result)==null?void 0:_.output)+"")&&K(a,o)},d(c){c&&g(e)}}}function Yl(n){var c,m;let e,t,l,s,r=n[2].t("Files")+"",i,o,a,f=Ve((m=(c=n[1])==null?void 0:c.result)==null?void 0:m.files),u=[];for(let d=0;d<f.length;d+=1)u[d]=$l(Jl(n,f,d));return{c(){e=I("div"),t=I("hr"),l=j(),s=I("div"),i=F(r),o=j(),a=I("ul");for(let d=0;d<u.length;d+=1)u[d].c();this.h()},l(d){e=M(d,"DIV",{class:!0});var _=k(e);t=M(_,"HR",{class:!0}),l=z(_),s=M(_,"DIV",{class:!0});var w=k(s);i=J(w,r),w.forEach(g),o=z(_),a=M(_,"UL",{class:!0});var y=k(a);for(let E=0;E<u.length;E+=1)u[E].l(y);y.forEach(g),_.forEach(g),this.h()},h(){h(t,"class","border-gray-100 dark:border-gray-850 my-2"),h(s,"class","text-sm font-medium dark:text-gray-300"),h(a,"class","mt-1 list-disc pl-4 text-xs"),h(e,"class","flex flex-col w-full")},m(d,_){V(d,e,_),p(e,t),p(e,l),p(e,s),p(s,i),p(e,o),p(e,a);for(let w=0;w<u.length;w+=1)u[w]&&u[w].m(a,null)},p(d,_){var w,y;if(_&4&&r!==(r=d[2].t("Files")+"")&&K(i,r),_&2){f=Ve((y=(w=d[1])==null?void 0:w.result)==null?void 0:y.files);let E;for(E=0;E<f.length;E+=1){const C=Jl(d,f,E);u[E]?u[E].p(C,_):(u[E]=$l(C),u[E].c(),u[E].m(a,null))}for(;E<u.length;E+=1)u[E].d(1);u.length=f.length}},d(d){d&&g(e),Fe(u,d)}}}function $l(n){let e,t,l=n[6].name+"",s,r,i;return{c(){e=I("li"),t=I("a"),s=F(l),i=j(),this.h()},l(o){e=M(o,"LI",{});var a=k(e);t=M(a,"A",{href:!0,target:!0});var f=k(t);s=J(f,l),f.forEach(g),i=z(a),a.forEach(g),this.h()},h(){h(t,"href",r=n[6].url),h(t,"target","_blank")},m(o,a){V(o,e,a),p(e,t),p(t,s),p(e,i)},p(o,a){a&2&&l!==(l=o[6].name+"")&&K(s,l),a&2&&r!==(r=o[6].url)&&h(t,"href",r)},d(o){o&&g(e)}}}function lo(n){var A,X,oe,ie,re,ce,me,Ie,W,G,ge,pe,q,de,fe,_e,be,P,Q;let e,t,l,s,r,i,o,a,f,u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',c,m,d,_,w,y,E,C,S,L,R=((A=n[1])==null?void 0:A.result)&&Gl(n),v=!((X=n[1])!=null&&X.result)&&Zl();function N($,Z){var ae;return(ae=$[1])!=null&&ae.name?to:eo}let B=N(n),O=B(n);w=new Sr({props:{id:"code-exec-"+((oe=n[1])==null?void 0:oe.id)+"-code",lang:((ie=n[1])==null?void 0:ie.language)??"",code:((re=n[1])==null?void 0:re.code)??"",className:"",editorClassName:(ce=n[1])!=null&&ce.result&&((Ie=(me=n[1])==null?void 0:me.result)!=null&&Ie.error||(G=(W=n[1])==null?void 0:W.result)!=null&&G.output)?"rounded-b-none":"",stickyButtonsClassName:"top-0",run:!1}});let T=((ge=n[1])==null?void 0:ge.result)&&(((q=(pe=n[1])==null?void 0:pe.result)==null?void 0:q.error)||((fe=(de=n[1])==null?void 0:de.result)==null?void 0:fe.output))&&Kl(n),H=((be=(_e=n[1])==null?void 0:_e.result)==null?void 0:be.files)&&((Q=(P=n[1])==null?void 0:P.result)==null?void 0:Q.files.length)>0&&Yl(n);return{c(){e=I("div"),t=I("div"),l=I("div"),R&&R.c(),s=j(),r=I("div"),v&&v.c(),i=j(),o=I("div"),O.c(),a=j(),f=I("button"),f.innerHTML=u,c=j(),m=I("div"),d=I("div"),_=I("div"),x(w.$$.fragment),y=j(),T&&T.c(),E=j(),H&&H.c(),this.h()},l($){e=M($,"DIV",{});var Z=k(e);t=M(Z,"DIV",{class:!0});var ae=k(t);l=M(ae,"DIV",{class:!0});var ke=k(l);R&&R.l(ke),s=z(ke),r=M(ke,"DIV",{class:!0});var Ce=k(r);v&&v.l(Ce),i=z(Ce),o=M(Ce,"DIV",{});var Y=k(o);O.l(Y),Y.forEach(g),Ce.forEach(g),ke.forEach(g),a=z(ae),f=M(ae,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(f)!=="svelte-vnrwun"&&(f.innerHTML=u),ae.forEach(g),c=z(Z),m=M(Z,"DIV",{class:!0});var Pe=k(m);d=M(Pe,"DIV",{class:!0});var He=k(d);_=M(He,"DIV",{class:!0});var ze=k(_);ee(w.$$.fragment,ze),ze.forEach(g),y=z(He),T&&T.l(He),E=z(He),H&&H.l(He),He.forEach(g),Pe.forEach(g),Z.forEach(g),this.h()},h(){h(r,"class","flex gap-2 items-center"),h(l,"class","text-lg font-medium self-center flex flex-col gap-0.5 capitalize"),h(f,"class","self-center"),h(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),h(_,"class","flex flex-col w-full"),h(d,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),h(m,"class","flex flex-col md:flex-row w-full px-4 pb-5")},m($,Z){V($,e,Z),p(e,t),p(t,l),R&&R.m(l,null),p(l,s),p(l,r),v&&v.m(r,null),p(r,i),p(r,o),O.m(o,null),p(t,a),p(t,f),p(e,c),p(e,m),p(m,d),p(d,_),te(w,_,null),p(d,y),T&&T.m(d,null),p(d,E),H&&H.m(d,null),C=!0,S||(L=ue(f,"click",n[4]),S=!0)},p($,Z){var ke,Ce,Y,Pe,He,ze,qe,Ye,st,at,lt,ft,ut,nt,Mt,Et,Nt,Dt,Vt;(ke=$[1])!=null&&ke.result?R?(R.p($,Z),Z&2&&b(R,1)):(R=Gl($),R.c(),b(R,1),R.m(l,s)):R&&(se(),D(R,1,1,()=>{R=null}),ne()),(Ce=$[1])!=null&&Ce.result?v&&(se(),D(v,1,1,()=>{v=null}),ne()):v?Z&2&&b(v,1):(v=Zl(),v.c(),b(v,1),v.m(r,i)),B===(B=N($))&&O?O.p($,Z):(O.d(1),O=B($),O&&(O.c(),O.m(o,null)));const ae={};Z&2&&(ae.id="code-exec-"+((Y=$[1])==null?void 0:Y.id)+"-code"),Z&2&&(ae.lang=((Pe=$[1])==null?void 0:Pe.language)??""),Z&2&&(ae.code=((He=$[1])==null?void 0:He.code)??""),Z&2&&(ae.editorClassName=(ze=$[1])!=null&&ze.result&&((Ye=(qe=$[1])==null?void 0:qe.result)!=null&&Ye.error||(at=(st=$[1])==null?void 0:st.result)!=null&&at.output)?"rounded-b-none":""),w.$set(ae),(lt=$[1])!=null&&lt.result&&((ut=(ft=$[1])==null?void 0:ft.result)!=null&&ut.error||(Mt=(nt=$[1])==null?void 0:nt.result)!=null&&Mt.output)?T?T.p($,Z):(T=Kl($),T.c(),T.m(d,E)):T&&(T.d(1),T=null),(Nt=(Et=$[1])==null?void 0:Et.result)!=null&&Nt.files&&((Vt=(Dt=$[1])==null?void 0:Dt.result)==null?void 0:Vt.files.length)>0?H?H.p($,Z):(H=Yl($),H.c(),H.m(d,null)):H&&(H.d(1),H=null)},i($){C||(b(R),b(v),b(w.$$.fragment,$),C=!0)},o($){D(R),D(v),D(w.$$.fragment,$),C=!1},d($){$&&g(e),R&&R.d(),v&&v.d(),O.d(),le(w),T&&T.d(),H&&H.d(),S=!1,L()}}}function so(n){let e,t,l;function s(i){n[5](i)}let r={size:"lg",$$slots:{default:[lo]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.show=n[0]),e=new Rn({props:r}),je.push(()=>Qe(e,"show",s)),{c(){x(e.$$.fragment)},l(i){ee(e.$$.fragment,i)},m(i,o){te(e,i,o),l=!0},p(i,[o]){const a={};o&519&&(a.$$scope={dirty:o,ctx:i}),!t&&o&1&&(t=!0,a.show=i[0],Ke(()=>t=!1)),e.$set(a)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){le(e,i)}}}function no(n,e,t){let l;const s=Je("i18n");Ee(n,s,f=>t(2,l=f));let{show:r=!1}=e,{codeExecution:i=null}=e;const o=()=>{t(0,r=!1),t(1,i=null)};function a(f){r=f,t(0,r)}return n.$$set=f=>{"show"in f&&t(0,r=f.show),"codeExecution"in f&&t(1,i=f.codeExecution)},[r,i,l,s,o,a]}class ro extends Re{constructor(e){super(),Le(this,e,no,so,Be,{show:0,codeExecution:1})}}function xl(n,e,t){const l=n.slice();return l[6]=e[t],l}function es(n){let e,t=[],l=new Map,s,r=Ve(n[0]);const i=o=>o[6].id;for(let o=0;o<r.length;o+=1){let a=xl(n,r,o),f=i(a);l.set(f,t[o]=ts(f,a))}return{c(){e=I("div");for(let o=0;o<t.length;o+=1)t[o].c();this.h()},l(o){e=M(o,"DIV",{class:!0});var a=k(e);for(let f=0;f<t.length;f+=1)t[f].l(a);a.forEach(g),this.h()},h(){h(e,"class","mt-1 mb-2 w-full flex gap-1 items-center flex-wrap")},m(o,a){V(o,e,a);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null);s=!0},p(o,a){a&7&&(r=Ve(o[0]),se(),t=Gt(t,a,i,1,o,r,l,e,In,ts,null,xl),ne())},i(o){if(!s){for(let a=0;a<r.length;a+=1)b(t[a]);s=!0}},o(o){for(let a=0;a<t.length;a+=1)D(t[a]);s=!1},d(o){o&&g(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function io(n){let e,t;return e=new Ut({props:{className:"size-4"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function oo(n){let e,t,l,s;const r=[uo,fo,ao],i=[];function o(a,f){var u,c;return(u=a[6].result)!=null&&u.error?0:(c=a[6].result)!=null&&c.output?1:2}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=he()},l(a){t.l(a),l=he()},m(a,f){i[e].m(a,f),V(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e!==u&&(se(),D(i[u],1,1,()=>{i[u]=null}),ne(),t=i[e],t||(t=i[e]=r[e](a),t.c()),b(t,1),t.m(l.parentNode,l))},i(a){s||(b(t),s=!0)},o(a){D(t),s=!1},d(a){a&&g(l),i[e].d(a)}}}function ao(n){let e,t;return e=new zr({}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function fo(n){let e,t;return e=new Hr({props:{strokeWidth:"3",className:"size-3"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function uo(n){let e,t;return e=new jr({}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function ts(n,e){let t,l,s,r,i,o,a,f=e[6].name+"",u,c,m,d,_,w;const y=[oo,io],E=[];function C(L,R){var v;return(v=L[6])!=null&&v.result?0:1}r=C(e),i=E[r]=y[r](e);function S(){return e[4](e[6])}return{key:n,first:null,c(){t=I("div"),l=I("button"),s=I("div"),i.c(),o=j(),a=I("div"),u=F(f),m=j(),this.h()},l(L){t=M(L,"DIV",{class:!0});var R=k(t);l=M(R,"BUTTON",{class:!0});var v=k(l);s=M(v,"DIV",{class:!0});var N=k(s);i.l(N),N.forEach(g),o=z(v),a=M(v,"DIV",{class:!0});var B=k(a);u=J(B,f),B.forEach(g),v.forEach(g),m=z(R),R.forEach(g),this.h()},h(){var L;h(s,"class","bg-white dark:bg-gray-700 rounded-full size-4 flex items-center justify-center"),h(a,"class",c="flex-1 mx-2 line-clamp-1 code-execution-name "+((L=e[6])!=null&&L.result?"":"pulse")+" svelte-1gvtig2"),h(l,"class","flex dark:text-gray-300 py-1 px-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-xl max-w-96"),h(t,"class","flex gap-1 text-xs font-semibold"),this.first=t},m(L,R){V(L,t,R),p(t,l),p(l,s),E[r].m(s,null),p(l,o),p(l,a),p(a,u),p(t,m),d=!0,_||(w=ue(l,"click",S),_=!0)},p(L,R){var N;e=L;let v=r;r=C(e),r===v?E[r].p(e,R):(se(),D(E[v],1,1,()=>{E[v]=null}),ne(),i=E[r],i?i.p(e,R):(i=E[r]=y[r](e),i.c()),b(i,1),i.m(s,null)),(!d||R&1)&&f!==(f=e[6].name+"")&&K(u,f),(!d||R&1&&c!==(c="flex-1 mx-2 line-clamp-1 code-execution-name "+((N=e[6])!=null&&N.result?"":"pulse")+" svelte-1gvtig2"))&&h(a,"class",c)},i(L){d||(b(i),d=!0)},o(L){D(i),d=!1},d(L){L&&g(t),E[r].d(),_=!1,w()}}}function co(n){let e,t,l,s,r;function i(f){n[3](f)}let o={codeExecution:n[1]};n[2]!==void 0&&(o.show=n[2]),e=new ro({props:o}),je.push(()=>Qe(e,"show",i));let a=n[0].length>0&&es(n);return{c(){x(e.$$.fragment),l=j(),a&&a.c(),s=he()},l(f){ee(e.$$.fragment,f),l=z(f),a&&a.l(f),s=he()},m(f,u){te(e,f,u),V(f,l,u),a&&a.m(f,u),V(f,s,u),r=!0},p(f,[u]){const c={};u&2&&(c.codeExecution=f[1]),!t&&u&4&&(t=!0,c.show=f[2],Ke(()=>t=!1)),e.$set(c),f[0].length>0?a?(a.p(f,u),u&1&&b(a,1)):(a=es(f),a.c(),b(a,1),a.m(s.parentNode,s)):a&&(se(),D(a,1,1,()=>{a=null}),ne())},i(f){r||(b(e.$$.fragment,f),b(a),r=!0)},o(f){D(e.$$.fragment,f),D(a),r=!1},d(f){f&&(g(l),g(s)),le(e,f),a&&a.d(f)}}}function ho(n,e,t){let{codeExecutions:l=[]}=e,s=null,r=!1;const i=()=>{s&&t(1,s=l.find(f=>f.id===s.id))};function o(f){r=f,t(2,r)}const a=f=>{t(1,s=f),t(2,r=!0)};return n.$$set=f=>{"codeExecutions"in f&&t(0,l=f.codeExecutions)},n.$$.update=()=>{n.$$.dirty&1&&l&&i()},[l,s,r,o,a]}class mo extends Re{constructor(e){super(),Le(this,e,ho,co,Be,{codeExecutions:0})}}function go(n){let e,t;return{c(){e=we("svg"),t=we("path"),this.h()},l(l){e=ye(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ye(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(g),s.forEach(g),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M8.625 12a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 0 1-2.555-.337A5.972 5.972 0 0 1 5.41 20.97a5.969 5.969 0 0 1-.474-.065 4.48 4.48 0 0 0 .978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width",n[1]),h(e,"stroke","currentColor"),h(e,"class",n[0])},m(l,s){V(l,e,s),p(e,t)},p(l,[s]){s&2&&h(e,"stroke-width",l[1]),s&1&&h(e,"class",l[0])},i:ve,o:ve,d(l){l&&g(e)}}}function _o(n,e,t){let{className:l="size-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class po extends Re{constructor(e){super(),Le(this,e,_o,go,Be,{className:0,strokeWidth:1})}}function vo(n){let e,t,l,s,r,i,o,a,f,u,c,m;s=new It({props:{id:`${n[0]}-float-prompt`,content:n[4]}});const d=[wo,ko],_=[];function w(E,C){return C&32&&(a=null),a==null&&(a=E[5].trim()===""),a?0:1}f=w(n,-1),u=_[f]=d[f](n);let y=n[6]&&ls(n);return{c(){e=I("div"),t=I("div"),l=I("div"),x(s.$$.fragment),r=j(),i=I("div"),o=I("div"),u.c(),c=j(),y&&y.c(),this.h()},l(E){e=M(E,"DIV",{class:!0});var C=k(e);t=M(C,"DIV",{class:!0});var S=k(t);l=M(S,"DIV",{class:!0});var L=k(l);ee(s.$$.fragment,L),L.forEach(g),S.forEach(g),r=z(C),i=M(C,"DIV",{class:!0});var R=k(i);o=M(R,"DIV",{class:!0,id:!0});var v=k(o);u.l(v),c=z(v),y&&y.l(v),v.forEach(g),R.forEach(g),C.forEach(g),this.h()},h(){h(l,"class","font-medium"),h(t,"class","bg-gray-50/50 dark:bg-gray-800 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),h(o,"class","max-h-80 overflow-y-auto w-full markdown-prose-xs"),h(o,"id","response-container"),h(i,"class","bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),h(e,"class","bg-white dark:bg-gray-850 dark:text-gray-100 rounded-xl shadow-xl w-80 max-w-full")},m(E,C){V(E,e,C),p(e,t),p(t,l),te(s,l,null),p(e,r),p(e,i),p(i,o),_[f].m(o,null),p(o,c),y&&y.m(o,null),m=!0},p(E,C){const S={};C&1&&(S.id=`${E[0]}-float-prompt`),C&16&&(S.content=E[4]),s.$set(S);let L=f;f=w(E,C),f===L?_[f].p(E,C):(se(),D(_[L],1,1,()=>{_[L]=null}),ne(),u=_[f],u?u.p(E,C):(u=_[f]=d[f](E),u.c()),b(u,1),u.m(o,c)),E[6]?y?y.p(E,C):(y=ls(E),y.c(),y.m(o,null)):y&&(y.d(1),y=null)},i(E){m||(b(s.$$.fragment,E),b(u),m=!0)},o(E){D(s.$$.fragment,E),D(u),m=!1},d(E){E&&g(e),le(s),_[f].d(),y&&y.d()}}}function bo(n){let e,t,l,s;const r=[Io,yo],i=[];function o(a,f){return a[1]?1:0}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=he()},l(a){t.l(a),l=he()},m(a,f){i[e].m(a,f),V(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(se(),D(i[u],1,1,()=>{i[u]=null}),ne(),t=i[e],t?t.p(a,f):(t=i[e]=r[e](a),t.c()),b(t,1),t.m(l.parentNode,l))},i(a){s||(b(t),s=!0)},o(a){D(t),s=!1},d(a){a&&g(l),i[e].d(a)}}}function ko(n){let e,t;return e=new It({props:{id:`${n[0]}-float-response`,content:n[5]}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s&1&&(r.id=`${l[0]}-float-response`),s&32&&(r.content=l[5]),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function wo(n){let e,t;return e=new Xt({props:{size:"sm"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function ls(n){let e,t,l=n[7].t("Add")+"",s,r,i;return{c(){e=I("div"),t=I("button"),s=F(l),this.h()},l(o){e=M(o,"DIV",{class:!0});var a=k(e);t=M(a,"BUTTON",{class:!0});var f=k(t);s=J(f,l),f.forEach(g),a.forEach(g),this.h()},h(){h(t,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),h(e,"class","flex justify-end pt-3 text-sm font-medium")},m(o,a){V(o,e,a),p(e,t),p(t,s),r||(i=ue(t,"click",n[11]),r=!0)},p(o,a){a&128&&l!==(l=o[7].t("Add")+"")&&K(s,l)},d(o){o&&g(e),r=!1,i()}}}function yo(n){let e,t,l,s,r,i,o,a,f,u,c;return{c(){e=I("div"),t=I("input"),s=j(),r=I("div"),i=I("button"),o=we("svg"),a=we("path"),this.h()},l(m){e=M(m,"DIV",{class:!0});var d=k(e);t=M(d,"INPUT",{type:!0,id:!0,class:!0,placeholder:!0}),s=z(d),r=M(d,"DIV",{class:!0});var _=k(r);i=M(_,"BUTTON",{class:!0});var w=k(i);o=ye(w,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var y=k(o);a=ye(y,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),k(a).forEach(g),y.forEach(g),w.forEach(g),_.forEach(g),d.forEach(g),this.h()},h(){h(t,"type","text"),h(t,"id","floating-message-input"),h(t,"class","ml-5 bg-transparent outline-hidden w-full flex-1 text-sm"),h(t,"placeholder",l=n[7].t("Ask a question")),h(a,"fill-rule","evenodd"),h(a,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),h(a,"clip-rule","evenodd"),h(o,"xmlns","http://www.w3.org/2000/svg"),h(o,"viewBox","0 0 16 16"),h(o,"fill","currentColor"),h(o,"class","size-4"),h(i,"class",f=(n[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center"),h(r,"class","ml-1 mr-2"),h(e,"class","py-1 flex dark:text-gray-100 bg-gray-50 dark:bg-gray-800 border border-gray-100 dark:border-gray-850 w-72 rounded-full shadow-xl")},m(m,d){V(m,e,d),p(e,t),it(t,n[3]),p(e,s),p(e,r),p(r,i),p(i,o),p(o,a),u||(c=[ue(t,"input",n[18]),ue(t,"keydown",n[19]),ue(i,"click",n[20])],u=!0)},p(m,d){d&128&&l!==(l=m[7].t("Ask a question"))&&h(t,"placeholder",l),d&8&&t.value!==m[3]&&it(t,m[3]),d&8&&f!==(f=(m[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center")&&h(i,"class",f)},i:ve,o:ve,d(m){m&&g(e),u=!1,Xe(c)}}}function Io(n){let e,t,l,s,r,i=n[7].t("Ask")+"",o,a,f,u,c,m,d=n[7].t("Explain")+"",_,w,y,E;return l=new po({props:{className:"size-3 shrink-0"}}),u=new Or({props:{className:"size-3 shrink-0"}}),{c(){e=I("div"),t=I("button"),x(l.$$.fragment),s=j(),r=I("div"),o=F(i),a=j(),f=I("button"),x(u.$$.fragment),c=j(),m=I("div"),_=F(d),this.h()},l(C){e=M(C,"DIV",{class:!0});var S=k(e);t=M(S,"BUTTON",{class:!0});var L=k(t);ee(l.$$.fragment,L),s=z(L),r=M(L,"DIV",{class:!0});var R=k(r);o=J(R,i),R.forEach(g),L.forEach(g),a=z(S),f=M(S,"BUTTON",{class:!0});var v=k(f);ee(u.$$.fragment,v),c=z(v),m=M(v,"DIV",{class:!0});var N=k(m);_=J(N,d),N.forEach(g),v.forEach(g),S.forEach(g),this.h()},h(){h(r,"class","shrink-0"),h(t,"class","px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-sm flex items-center gap-1 min-w-fit"),h(m,"class","shrink-0"),h(f,"class","px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-sm flex items-center gap-1 min-w-fit"),h(e,"class","flex flex-row gap-0.5 shrink-0 p-1 bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-lg shadow-xl")},m(C,S){V(C,e,S),p(e,t),te(l,t,null),p(t,s),p(t,r),p(r,o),p(e,a),p(e,f),te(u,f,null),p(f,c),p(f,m),p(m,_),w=!0,y||(E=[ue(t,"click",n[16]),ue(f,"click",n[17])],y=!0)},p(C,S){(!w||S&128)&&i!==(i=C[7].t("Ask")+"")&&K(o,i),(!w||S&128)&&d!==(d=C[7].t("Explain")+"")&&K(_,d)},i(C){w||(b(l.$$.fragment,C),b(u.$$.fragment,C),w=!0)},o(C){D(l.$$.fragment,C),D(u.$$.fragment,C),w=!1},d(C){C&&g(e),le(l),le(u),y=!1,Xe(E)}}}function Mo(n){let e,t,l,s,r;const i=[bo,vo],o=[];function a(f,u){return f[5]===null?0:1}return t=a(n),l=o[t]=i[t](n),{c(){e=I("div"),l.c(),this.h()},l(f){e=M(f,"DIV",{id:!0,class:!0,style:!0});var u=k(e);l.l(u),u.forEach(g),this.h()},h(){h(e,"id",s=`floating-buttons-${n[0]}`),h(e,"class","absolute rounded-lg mt-1 text-xs z-9999"),Rt(e,"display","none")},m(f,u){V(f,e,u),o[t].m(e,null),r=!0},p(f,[u]){let c=t;t=a(f),t===c?o[t].p(f,u):(se(),D(o[c],1,1,()=>{o[c]=null}),ne(),l=o[t],l?l.p(f,u):(l=o[t]=i[t](f),l.c()),b(l,1),l.m(e,null)),(!r||u&1&&s!==(s=`floating-buttons-${f[0]}`))&&h(e,"id",s)},i(f){r||(b(l),r=!0)},o(f){D(l),r=!1},d(f){f&&g(e),o[t].d()}}}function Eo(n,e,t){let l;const s=Je("i18n");Ee(n,s,O=>t(7,l=O));let{id:r=""}=e,{model:i=null}=e,{messages:o=[]}=e,{onAdd:a=()=>{}}=e,f=!1,u="",c="",m="",d=null,_=!1;const w=async()=>{const O=document.getElementById("response-container");O.scrollHeight-O.clientHeight<=O.scrollTop+50&&(O.scrollTop=O.scrollHeight)},y=async()=>{if(!i){Ae.error("Model not selected");return}t(4,m=`${c}
\`\`\`
${u}
\`\`\``),t(3,c=""),t(5,d="");const[O,T]=await _l(localStorage.token,{model:i,messages:[...o,{role:"user",content:m}].map(H=>({role:H.role,content:H.content})),stream:!0});if(O&&O.ok){const H=O.body.getReader(),A=new TextDecoder;await(async()=>{var oe,ie;for(;;){const{done:re,value:ce}=await H.read();if(re)break;const Ie=A.decode(ce,{stream:!0}).split(`
`).filter(W=>W.trim()!=="");for(const W of Ie)if(W.startsWith("data: "))if(W.startsWith("data: [DONE]")){t(6,_=!0),await De(),w();continue}else try{const G=JSON.parse(W.slice(6));G.choices&&((ie=(oe=G.choices[0])==null?void 0:oe.delta)!=null&&ie.content)&&(t(5,d+=G.choices[0].delta.content),w())}catch(G){console.error(G)}}})()}else Ae.error("An error occurred while fetching the explanation")},E=async()=>{if(!i){Ae.error("Model not selected");return}const O=l.t("Explain this section to me in more detail");t(4,m=`${O}

\`\`\`
${u}
\`\`\``),t(5,d="");const[T,H]=await _l(localStorage.token,{model:i,messages:[...o,{role:"user",content:m}].map(A=>({role:A.role,content:A.content})),stream:!0});if(T&&T.ok){const A=T.body.getReader(),X=new TextDecoder;await(async()=>{var ie,re;for(;;){const{done:ce,value:me}=await A.read();if(ce)break;const W=X.decode(me,{stream:!0}).split(`
`).filter(G=>G.trim()!=="");for(const G of W)if(G.startsWith("data: "))if(G.startsWith("data: [DONE]")){t(6,_=!0),await De(),w();continue}else try{const ge=JSON.parse(G.slice(6));ge.choices&&((re=(ie=ge.choices[0])==null?void 0:ie.delta)!=null&&re.content)&&(t(5,d+=ge.choices[0].delta.content),w())}catch(ge){console.error(ge)}}})()}else Ae.error("An error occurred while fetching the explanation")},C=async()=>{a({modelId:i,parentId:r,messages:[{role:"user",content:m},{role:"assistant",content:d}]})},S=()=>{t(5,d=null),t(6,_=!1),t(1,f=!1),t(3,c="")},L=async()=>{t(2,u=window.getSelection().toString()),t(1,f=!0),await De(),setTimeout(()=>{const O=document.getElementById("floating-message-input");O&&O.focus()},0)},R=()=>{t(2,u=window.getSelection().toString()),E()};function v(){c=this.value,t(3,c)}const N=O=>{O.key==="Enter"&&y()},B=()=>{y()};return n.$$set=O=>{"id"in O&&t(0,r=O.id),"model"in O&&t(12,i=O.model),"messages"in O&&t(13,o=O.messages),"onAdd"in O&&t(14,a=O.onAdd)},[r,f,u,c,m,d,_,l,s,y,E,C,i,o,a,S,L,R,v,N,B]}class No extends Re{constructor(e){super(),Le(this,e,Eo,Mo,Be,{id:0,model:12,messages:13,onAdd:14,closeHandler:15})}get closeHandler(){return this.$$.ctx[15]}}function ss(n){var s;let e,t,l={id:n[0],model:(s=n[3])==null?void 0:s.id,messages:Jt(n[2],n[0]),onAdd:n[21]};return e=new No({props:l}),n[22](e),{c(){x(e.$$.fragment)},l(r){ee(e.$$.fragment,r)},m(r,i){te(e,r,i),t=!0},p(r,i){var a;const o={};i&1&&(o.id=r[0]),i&8&&(o.model=(a=r[3])==null?void 0:a.id),i&5&&(o.messages=Jt(r[2],r[0])),i&512&&(o.onAdd=r[21]),e.$set(o)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){n[22](null),le(e,r)}}}function Do(n){let e,t,l,s,r;t=new It({props:{id:n[0],content:n[1],model:n[3],save:n[5],sourceIds:(n[4]??[]).reduce(n[17],[]),onSourceClick:n[7],onTaskClick:n[8]}}),t.$on("update",n[18]),t.$on("code",n[19]);let i=n[6]&&n[3]&&ss(n);return{c(){e=I("div"),x(t.$$.fragment),l=j(),i&&i.c(),s=he()},l(o){e=M(o,"DIV",{});var a=k(e);ee(t.$$.fragment,a),a.forEach(g),l=z(o),i&&i.l(o),s=he()},m(o,a){V(o,e,a),te(t,e,null),n[20](e),V(o,l,a),i&&i.m(o,a),V(o,s,a),r=!0},p(o,[a]){const f={};a&1&&(f.id=o[0]),a&2&&(f.content=o[1]),a&8&&(f.model=o[3]),a&32&&(f.save=o[5]),a&24&&(f.sourceIds=(o[4]??[]).reduce(o[17],[])),a&128&&(f.onSourceClick=o[7]),a&256&&(f.onTaskClick=o[8]),t.$set(f),o[6]&&o[3]?i?(i.p(o,a),a&72&&b(i,1)):(i=ss(o),i.c(),b(i,1),i.m(s.parentNode,s)):i&&(se(),D(i,1,1,()=>{i=null}),ne())},i(o){r||(b(t.$$.fragment,o),b(i),r=!0)},o(o){D(t.$$.fragment,o),D(i),r=!1},d(o){o&&(g(e),g(l),g(s)),le(t),n[20](null),i&&i.d(o)}}}function Vo(n,e,t){let l,s,r;Ee(n,Mn,A=>t(12,l=A)),Ee(n,yt,A=>t(13,s=A)),Ee(n,pr,A=>t(14,r=A)),Je("i18n");const i=gt();let{id:o}=e,{content:a}=e,{history:f}=e,{model:u=null}=e,{sources:c=null}=e,{save:m=!1}=e,{floatingButtons:d=!0}=e,{onSourceClick:_=()=>{}}=e,{onTaskClick:w=()=>{}}=e,{onAddMessages:y=()=>{}}=e,E,C;const S=A=>{const X=document.getElementById(`floating-buttons-${o}`);if(!(E!=null&&E.contains(A.target))&&!(X!=null&&X.contains(A.target))){L();return}setTimeout(async()=>{if(await De(),!(E!=null&&E.contains(A.target)))return;let oe=window.getSelection();if(oe.toString().trim().length>0){const re=oe.getRangeAt(0).getBoundingClientRect(),ce=E.getBoundingClientRect(),me=re.bottom-ce.top,Ie=re.left-ce.left;if(X){X.style.display="block";const W=ce.width-Ie;let G=l?window.innerWidth/2:window.innerWidth/3;if(W<G){const ge=ce.right-re.right;X.style.right=`${ge}px`,X.style.left="auto"}else X.style.left=`${Ie}px`,X.style.right="auto";X.style.top=`${me+5}px`}}else L()},0)},L=()=>{const A=document.getElementById(`floating-buttons-${o}`);A&&(A.style.display="none"),C&&typeof(C==null?void 0:C.closeHandler)=="function"&&(C==null||C.closeHandler())},R=A=>{A.key==="Escape"&&L()};bt(()=>{d&&(E==null||E.addEventListener("mouseup",S),document.addEventListener("mouseup",S),document.addEventListener("keydown",R))}),dr(()=>{d&&(E==null||E.removeEventListener("mouseup",S),document.removeEventListener("mouseup",S),document.removeEventListener("keydown",R))});const v=(A,X)=>{let oe=[];return X.document.forEach((ie,re)=>{var Ie,W,G,ge,pe;if(((G=(W=(Ie=u==null?void 0:u.info)==null?void 0:Ie.meta)==null?void 0:W.capabilities)==null?void 0:G.citations)==!1)return oe.push("N/A"),oe;const ce=(ge=X.metadata)==null?void 0:ge[re],me=(ce==null?void 0:ce.source)??"N/A";return ce!=null&&ce.name?(oe.push(ce.name),oe):(me.startsWith("http://")||me.startsWith("https://")?oe.push(me):oe.push(((pe=X==null?void 0:X.source)==null?void 0:pe.name)??me),oe)}),A=[...A,...oe],A.filter((ie,re)=>A.indexOf(ie)===re)},N=A=>{i("update",A.detail)},B=A=>{const{lang:X,code:oe}=A.detail;((s==null?void 0:s.detectArtifacts)??!0)&&(["html","svg"].includes(X)||X==="xml"&&oe.includes("svg"))&&!l&&r&&(vr.set(!0),br.set(!0))};function O(A){je[A?"unshift":"push"](()=>{E=A,t(10,E)})}const T=({modelId:A,parentId:X,messages:oe})=>{console.log(A,X,oe),y({modelId:A,parentId:X,messages:oe}),L()};function H(A){je[A?"unshift":"push"](()=>{C=A,t(11,C)})}return n.$$set=A=>{"id"in A&&t(0,o=A.id),"content"in A&&t(1,a=A.content),"history"in A&&t(2,f=A.history),"model"in A&&t(3,u=A.model),"sources"in A&&t(4,c=A.sources),"save"in A&&t(5,m=A.save),"floatingButtons"in A&&t(6,d=A.floatingButtons),"onSourceClick"in A&&t(7,_=A.onSourceClick),"onTaskClick"in A&&t(8,w=A.onTaskClick),"onAddMessages"in A&&t(9,y=A.onAddMessages)},[o,a,f,u,c,m,d,_,w,y,E,C,l,s,r,i,L,v,N,B,O,T,H]}class Co extends Re{constructor(e){super(),Le(this,e,Vo,Do,Be,{id:0,content:1,history:2,model:3,sources:4,save:5,floatingButtons:6,onSourceClick:7,onTaskClick:8,onAddMessages:9})}}function ns(n,e,t){const l=n.slice();return l[89]=e[t],l}function rs(n,e,t){const l=n.slice();return l[92]=e[t],l}function Wt(n){var l,s,r;const e=n.slice(),t=(((l=e[13])==null?void 0:l.statusHistory)??[...(s=e[13])!=null&&s.status?[(r=e[13])==null?void 0:r.status]:[]]).at(-1);return e[95]=t,e}function To(n){var s;let e,t=(((s=n[17])==null?void 0:s.name)??n[13].model)+"",l;return{c(){e=I("span"),l=F(t),this.h()},l(r){e=M(r,"SPAN",{class:!0});var i=k(e);l=J(i,t),i.forEach(g),this.h()},h(){h(e,"class","line-clamp-1 text-black dark:text-white")},m(r,i){V(r,e,i),p(e,l)},p(r,i){var o;i[0]&139264&&t!==(t=(((o=r[17])==null?void 0:o.name)??r[13].model)+"")&&K(l,t)},d(r){r&&g(e)}}}function is(n){let e,t,l;return t=new Se({props:{content:ot(n[13].timestamp*1e3).format("LLLL"),$$slots:{default:[Bo]},$$scope:{ctx:n}}}),{c(){e=I("div"),x(t.$$.fragment),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=k(e);ee(t.$$.fragment,r),r.forEach(g),this.h()},h(){h(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,r){V(s,e,r),te(t,e,null),l=!0},p(s,r){const i={};r[0]&8192&&(i.content=ot(s[13].timestamp*1e3).format("LLLL")),r[0]&8192|r[3]&8&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&g(e),le(t)}}}function Bo(n){let e,t=Ht(n[13].timestamp*1e3)+"",l;return{c(){e=I("span"),l=F(t),this.h()},l(s){e=M(s,"SPAN",{class:!0});var r=k(e);l=J(r,t),r.forEach(g),this.h()},h(){h(e,"class","line-clamp-1")},m(s,r){V(s,e,r),p(e,l)},p(s,r){r[0]&8192&&t!==(t=Ht(s[13].timestamp*1e3)+"")&&K(l,t)},d(s){s&&g(e)}}}function So(n){var i;let e,t,l,s;e=new Se({props:{content:((i=n[17])==null?void 0:i.name)??n[13].model,placement:"top-start",$$slots:{default:[To]},$$scope:{ctx:n}}});let r=n[13].timestamp&&is(n);return{c(){x(e.$$.fragment),t=j(),r&&r.c(),l=he()},l(o){ee(e.$$.fragment,o),t=z(o),r&&r.l(o),l=he()},m(o,a){te(e,o,a),V(o,t,a),r&&r.m(o,a),V(o,l,a),s=!0},p(o,a){var u;const f={};a[0]&139264&&(f.content=((u=o[17])==null?void 0:u.name)??o[13].model),a[0]&139264|a[3]&8&&(f.$$scope={dirty:a,ctx:o}),e.$set(f),o[13].timestamp?r?(r.p(o,a),a[0]&8192&&b(r,1)):(r=is(o),r.c(),b(r,1),r.m(l.parentNode,l)):r&&(se(),D(r,1,1,()=>{r=null}),ne())},i(o){s||(b(e.$$.fragment,o),b(r),s=!0)},o(o){D(e.$$.fragment,o),D(r),s=!1},d(o){o&&(g(t),g(l)),le(e,o),r&&r.d(o)}}}function os(n){var s;let e,t,l=!((s=n[95])!=null&&s.hidden)&&as(n);return{c(){l&&l.c(),e=he()},l(r){l&&l.l(r),e=he()},m(r,i){l&&l.m(r,i),V(r,e,i),t=!0},p(r,i){var o;(o=r[95])!=null&&o.hidden?l&&(se(),D(l,1,1,()=>{l=null}),ne()):l?(l.p(r,i),i[0]&8192&&b(l,1)):(l=as(r),l.c(),b(l,1),l.m(e.parentNode,e))},i(r){t||(b(l),t=!0)},o(r){D(l),t=!1},d(r){r&&g(e),l&&l.d(r)}}}function as(n){var u;let e,t,l,s,r,i=((u=n[95])==null?void 0:u.done)===!1&&fs();const o=[Lo,Ro,Oo],a=[];function f(c,m){var d,_,w;return((d=c[95])==null?void 0:d.action)==="web_search"&&((_=c[95])!=null&&_.urls)?0:((w=c[95])==null?void 0:w.action)==="knowledge_search"?1:2}return l=f(n),s=a[l]=o[l](n),{c(){e=I("div"),i&&i.c(),t=j(),s.c(),this.h()},l(c){e=M(c,"DIV",{class:!0});var m=k(e);i&&i.l(m),t=z(m),s.l(m),m.forEach(g),this.h()},h(){h(e,"class","status-description flex items-center gap-2 py-0.5")},m(c,m){V(c,e,m),i&&i.m(e,null),p(e,t),a[l].m(e,null),r=!0},p(c,m){var _;((_=c[95])==null?void 0:_.done)===!1?i?m[0]&8192&&b(i,1):(i=fs(),i.c(),b(i,1),i.m(e,t)):i&&(se(),D(i,1,1,()=>{i=null}),ne());let d=l;l=f(c),l===d?a[l].p(c,m):(se(),D(a[d],1,1,()=>{a[d]=null}),ne(),s=a[l],s?s.p(c,m):(s=a[l]=o[l](c),s.c()),b(s,1),s.m(e,null))},i(c){r||(b(i),b(s),r=!0)},o(c){D(i),D(s),r=!1},d(c){c&&g(e),i&&i.d(),a[l].d()}}}function fs(n){let e,t,l;return t=new Ut({props:{className:"size-4"}}),{c(){e=I("div"),x(t.$$.fragment),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=k(e);ee(t.$$.fragment,r),r.forEach(g),this.h()},h(){h(e,"class","")},m(s,r){V(s,e,r),te(t,e,null),l=!0},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&g(e),le(t)}}}function Oo(n){let e,t,l,s;function r(a,f){var u,c,m;return f[0]&8192&&(l=null),l==null&&(l=!!((u=a[95])!=null&&u.description.includes("{{searchQuery}}"))),l?jo:((c=a[95])==null?void 0:c.description)==="No search query generated"?Ho:((m=a[95])==null?void 0:m.description)==="Generating search query"?Ao:Po}let i=r(n,[-1,-1,-1,-1]),o=i(n);return{c(){e=I("div"),t=I("div"),o.c(),this.h()},l(a){e=M(a,"DIV",{class:!0});var f=k(e);t=M(f,"DIV",{class:!0});var u=k(t);o.l(u),u.forEach(g),f.forEach(g),this.h()},h(){var a;h(t,"class",s=(((a=n[95])==null?void 0:a.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),h(e,"class","flex flex-col justify-center -space-y-0.5")},m(a,f){V(a,e,f),p(e,t),o.m(t,null)},p(a,f){var u;i===(i=r(a,f))&&o?o.p(a,f):(o.d(1),o=i(a),o&&(o.c(),o.m(t,null))),f[0]&8192&&s!==(s=(((u=a[95])==null?void 0:u.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&h(t,"class",s)},i:ve,o:ve,d(a){a&&g(e),o.d()}}}function Ro(n){let e,t,l=n[28].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:n[95].query})+"",s,r;return{c(){e=I("div"),t=I("div"),s=F(l),this.h()},l(i){e=M(i,"DIV",{class:!0});var o=k(e);t=M(o,"DIV",{class:!0});var a=k(t);s=J(a,l),a.forEach(g),o.forEach(g),this.h()},h(){var i;h(t,"class",r=(((i=n[95])==null?void 0:i.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),h(e,"class","flex flex-col justify-center -space-y-0.5")},m(i,o){V(i,e,o),p(e,t),p(t,s)},p(i,o){var a;o[0]&268443648&&l!==(l=i[28].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:i[95].query})+"")&&K(s,l),o[0]&8192&&r!==(r=(((a=i[95])==null?void 0:a.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&h(t,"class",r)},i:ve,o:ve,d(i){i&&g(e)}}}function Lo(n){let e,t;return e=new pi({props:{status:n[95],$$slots:{default:[Fo]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&8192&&(r.status=l[95]),s[0]&268443648|s[3]&8&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Po(n){var l;let e=((l=n[95])==null?void 0:l.description)+"",t;return{c(){t=F(e)},l(s){t=J(s,e)},m(s,r){V(s,t,r)},p(s,r){var i;r[0]&8192&&e!==(e=((i=s[95])==null?void 0:i.description)+"")&&K(t,e)},d(s){s&&g(t)}}}function Ao(n){let e=n[28].t("Generating search query")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&268435456&&e!==(e=l[28].t("Generating search query")+"")&&K(t,e)},d(l){l&&g(t)}}}function Ho(n){let e=n[28].t("No search query generated")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&268435456&&e!==(e=l[28].t("No search query generated")+"")&&K(t,e)},d(l){l&&g(t)}}}function jo(n){var l,s;let e=n[28].t((l=n[95])==null?void 0:l.description,{searchQuery:(s=n[95])==null?void 0:s.query})+"",t;return{c(){t=F(e)},l(r){t=J(r,e)},m(r,i){V(r,t,i)},p(r,i){var o,a;i[0]&268443648&&e!==(e=r[28].t((o=r[95])==null?void 0:o.description,{searchQuery:(a=r[95])==null?void 0:a.query})+"")&&K(t,e)},d(r){r&&g(t)}}}function zo(n){var l;let e=((l=n[95])==null?void 0:l.description)+"",t;return{c(){t=F(e)},l(s){t=J(s,e)},m(s,r){V(s,t,r)},p(s,r){var i;r[0]&8192&&e!==(e=((i=s[95])==null?void 0:i.description)+"")&&K(t,e)},d(s){s&&g(t)}}}function Uo(n){let e=n[28].t("Generating search query")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&268435456&&e!==(e=l[28].t("Generating search query")+"")&&K(t,e)},d(l){l&&g(t)}}}function Wo(n){let e=n[28].t("No search query generated")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&268435456&&e!==(e=l[28].t("No search query generated")+"")&&K(t,e)},d(l){l&&g(t)}}}function qo(n){var l,s;let e=n[28].t((l=n[95])==null?void 0:l.description,{count:(s=n[95])==null?void 0:s.urls.length})+"",t;return{c(){t=F(e)},l(r){t=J(r,e)},m(r,i){V(r,t,i)},p(r,i){var o,a;i[0]&268443648&&e!==(e=r[28].t((o=r[95])==null?void 0:o.description,{count:(a=r[95])==null?void 0:a.urls.length})+"")&&K(t,e)},d(r){r&&g(t)}}}function Fo(n){let e,t,l,s;function r(a,f){var u,c,m;return f[0]&8192&&(l=null),l==null&&(l=!!((u=a[95])!=null&&u.description.includes("{{count}}"))),l?qo:((c=a[95])==null?void 0:c.description)==="No search query generated"?Wo:((m=a[95])==null?void 0:m.description)==="Generating search query"?Uo:zo}let i=r(n,[-1,-1,-1,-1]),o=i(n);return{c(){e=I("div"),t=I("div"),o.c(),this.h()},l(a){e=M(a,"DIV",{class:!0});var f=k(e);t=M(f,"DIV",{class:!0});var u=k(t);o.l(u),u.forEach(g),f.forEach(g),this.h()},h(){var a;h(t,"class",s=(((a=n[95])==null?void 0:a.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap"),h(e,"class","flex flex-col justify-center -space-y-0.5")},m(a,f){V(a,e,f),p(e,t),o.m(t,null)},p(a,f){var u;i===(i=r(a,f))&&o?o.p(a,f):(o.d(1),o=i(a),o&&(o.c(),o.m(t,null))),f[0]&8192&&s!==(s=(((u=a[95])==null?void 0:u.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap")&&h(t,"class",s)},d(a){a&&g(e),o.d()}}}function us(n){let e,t,l=Ve(n[13].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=cs(rs(n,l,i));const r=i=>D(s[i],1,1,()=>{s[i]=null});return{c(){e=I("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=M(i,"DIV",{class:!0});var o=k(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(g),this.h()},h(){h(e,"class","my-1 w-full flex overflow-x-auto gap-2 flex-wrap")},m(i,o){V(i,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(i,o){if(o[0]&8192){l=Ve(i[13].files);let a;for(a=0;a<l.length;a+=1){const f=rs(i,l,a);s[a]?(s[a].p(f,o),b(s[a],1)):(s[a]=cs(f),s[a].c(),b(s[a],1),s[a].m(e,null))}for(se(),a=l.length;a<s.length;a+=1)r(a);ne()}},i(i){if(!t){for(let o=0;o<l.length;o+=1)b(s[o]);t=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)D(s[o]);t=!1},d(i){i&&g(e),Fe(s,i)}}}function Jo(n){var l;let e,t;return e=new Ln({props:{item:n[92],url:n[92].url,name:n[92].name,type:n[92].type,size:(l=n[92])==null?void 0:l.size,colorClassName:"bg-white dark:bg-gray-850 "}}),{c(){x(e.$$.fragment)},l(s){ee(e.$$.fragment,s)},m(s,r){te(e,s,r),t=!0},p(s,r){var o;const i={};r[0]&8192&&(i.item=s[92]),r[0]&8192&&(i.url=s[92].url),r[0]&8192&&(i.name=s[92].name),r[0]&8192&&(i.type=s[92].type),r[0]&8192&&(i.size=(o=s[92])==null?void 0:o.size),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){le(e,s)}}}function Go(n){let e,t;return e=new Tn({props:{src:n[92].url,alt:n[13].content}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&8192&&(r.src=l[92].url),s[0]&8192&&(r.alt=l[13].content),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function cs(n){let e,t,l,s,r;const i=[Go,Jo],o=[];function a(f,u){return f[92].type==="image"?0:1}return t=a(n),l=o[t]=i[t](n),{c(){e=I("div"),l.c(),s=j()},l(f){e=M(f,"DIV",{});var u=k(e);l.l(u),s=z(u),u.forEach(g)},m(f,u){V(f,e,u),o[t].m(e,null),p(e,s),r=!0},p(f,u){let c=t;t=a(f),t===c?o[t].p(f,u):(se(),D(o[c],1,1,()=>{o[c]=null}),ne(),l=o[t],l?l.p(f,u):(l=o[t]=i[t](f),l.c()),b(l,1),l.m(e,s))},i(f){r||(b(l),r=!0)},o(f){D(l),r=!1},d(f){f&&g(e),o[t].d()}}}function Zo(n){var _,w,y,E,C,S,L;let e,t,l,s,r,i,o;const a=[Xo,Qo],f=[];function u(R,v){return R[13].content===""&&!R[13].error?0:R[13].content&&R[13].error!==!0?1:-1}~(t=u(n))&&(l=f[t]=a[t](n));let c=((_=n[13])==null?void 0:_.error)&&ds(n),m=(((w=n[13])==null?void 0:w.sources)||((y=n[13])==null?void 0:y.citations))&&(((L=(S=(C=(E=n[17])==null?void 0:E.info)==null?void 0:C.meta)==null?void 0:S.capabilities)==null?void 0:L.citations)??!0)&&hs(n),d=n[13].code_executions&&ms(n);return{c(){e=I("div"),l&&l.c(),s=j(),c&&c.c(),r=j(),m&&m.c(),i=j(),d&&d.c(),this.h()},l(R){e=M(R,"DIV",{class:!0,id:!0});var v=k(e);l&&l.l(v),s=z(v),c&&c.l(v),r=z(v),m&&m.l(v),i=z(v),d&&d.l(v),v.forEach(g),this.h()},h(){h(e,"class","w-full flex flex-col relative"),h(e,"id","response-content-container")},m(R,v){V(R,e,v),~t&&f[t].m(e,null),p(e,s),c&&c.m(e,null),p(e,r),m&&m.m(e,null),p(e,i),d&&d.m(e,null),o=!0},p(R,v){var B,O,T,H,A,X,oe;let N=t;t=u(R),t===N?~t&&f[t].p(R,v):(l&&(se(),D(f[N],1,1,()=>{f[N]=null}),ne()),~t?(l=f[t],l?l.p(R,v):(l=f[t]=a[t](R),l.c()),b(l,1),l.m(e,s)):l=null),(B=R[13])!=null&&B.error?c?(c.p(R,v),v[0]&8192&&b(c,1)):(c=ds(R),c.c(),b(c,1),c.m(e,r)):c&&(se(),D(c,1,1,()=>{c=null}),ne()),((O=R[13])!=null&&O.sources||(T=R[13])!=null&&T.citations)&&(((oe=(X=(A=(H=R[17])==null?void 0:H.info)==null?void 0:A.meta)==null?void 0:X.capabilities)==null?void 0:oe.citations)??!0)?m?(m.p(R,v),v[0]&139264&&b(m,1)):(m=hs(R),m.c(),b(m,1),m.m(e,i)):m&&(se(),D(m,1,1,()=>{m=null}),ne()),R[13].code_executions?d?(d.p(R,v),v[0]&8192&&b(d,1)):(d=ms(R),d.c(),b(d,1),d.m(e,null)):d&&(se(),D(d,1,1,()=>{d=null}),ne())},i(R){o||(b(l),b(c),b(m),b(d),o=!0)},o(R){D(l),D(c),D(m),D(d),o=!1},d(R){R&&g(e),~t&&f[t].d(),c&&c.d(),m&&m.d(),d&&d.d()}}}function Ko(n){let e,t,l,s,r,i,o,a=n[28].t("Save As Copy")+"",f,u,c,m,d=n[28].t("Cancel")+"",_,w,y,E=n[28].t("Save")+"",C,S,L;return{c(){e=I("div"),t=I("textarea"),s=j(),r=I("div"),i=I("div"),o=I("button"),f=F(a),u=j(),c=I("div"),m=I("button"),_=F(d),w=j(),y=I("button"),C=F(E),this.h()},l(R){e=M(R,"DIV",{class:!0});var v=k(e);t=M(v,"TEXTAREA",{id:!0,class:!0}),k(t).forEach(g),s=z(v),r=M(v,"DIV",{class:!0});var N=k(r);i=M(N,"DIV",{});var B=k(i);o=M(B,"BUTTON",{id:!0,class:!0});var O=k(o);f=J(O,a),O.forEach(g),B.forEach(g),u=z(N),c=M(N,"DIV",{class:!0});var T=k(c);m=M(T,"BUTTON",{id:!0,class:!0});var H=k(m);_=J(H,d),H.forEach(g),w=z(T),y=M(T,"BUTTON",{id:!0,class:!0});var A=k(y);C=J(A,E),A.forEach(g),T.forEach(g),N.forEach(g),v.forEach(g),this.h()},h(){h(t,"id",l="message-edit-"+n[13].id),h(t,"class","bg-transparent outline-hidden w-full resize-none"),h(o,"id","save-new-message-button"),h(o,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border border-gray-100 dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),h(m,"id","close-edit-message-button"),h(m,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),h(y,"id","confirm-edit-message-button"),h(y,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),h(c,"class","flex space-x-1.5"),h(r,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),h(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 my-2")},m(R,v){V(R,e,v),p(e,t),n[51](t),it(t,n[18]),p(e,s),p(e,r),p(r,i),p(i,o),p(o,f),p(r,u),p(r,c),p(c,m),p(m,_),p(c,w),p(c,y),p(y,C),S||(L=[ue(t,"input",n[52]),ue(t,"input",va),ue(t,"keydown",n[53]),ue(o,"click",n[54]),ue(m,"click",n[55]),ue(y,"click",n[56])],S=!0)},p(R,v){v[0]&8192&&l!==(l="message-edit-"+R[13].id)&&h(t,"id",l),v[0]&262144&&it(t,R[18]),v[0]&268435456&&a!==(a=R[28].t("Save As Copy")+"")&&K(f,a),v[0]&268435456&&d!==(d=R[28].t("Cancel")+"")&&K(_,d),v[0]&268435456&&E!==(E=R[28].t("Save")+"")&&K(C,E)},i:ve,o:ve,d(R){R&&g(e),n[51](null),S=!1,Xe(L)}}}function Qo(n){var l;let e,t;return e=new Co({props:{id:n[13].id,history:n[0],content:n[13].content,sources:n[13].sources,floatingButtons:((l=n[13])==null?void 0:l.done)&&!n[12],save:!n[12],model:n[17],onTaskClick:n[57],onSourceClick:n[58],onAddMessages:n[59]}}),e.$on("update",n[60]),e.$on("select",n[61]),{c(){x(e.$$.fragment)},l(s){ee(e.$$.fragment,s)},m(s,r){te(e,s,r),t=!0},p(s,r){var o;const i={};r[0]&8192&&(i.id=s[13].id),r[0]&1&&(i.history=s[0]),r[0]&8192&&(i.content=s[13].content),r[0]&8192&&(i.sources=s[13].sources),r[0]&12288&&(i.floatingButtons=((o=s[13])==null?void 0:o.done)&&!s[12]),r[0]&4096&&(i.save=!s[12]),r[0]&131072&&(i.model=s[17]),r[0]&8192&&(i.onSourceClick=s[58]),r[0]&1024&&(i.onAddMessages=s[59]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){le(e,s)}}}function Xo(n){let e,t;return e=new Xt({}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function ds(n){var l,s;let e,t;return e=new Ii({props:{content:((s=(l=n[13])==null?void 0:l.error)==null?void 0:s.content)??n[13].content}}),{c(){x(e.$$.fragment)},l(r){ee(e.$$.fragment,r)},m(r,i){te(e,r,i),t=!0},p(r,i){var a,f;const o={};i[0]&8192&&(o.content=((f=(a=r[13])==null?void 0:a.error)==null?void 0:f.content)??r[13].content),e.$set(o)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){le(e,r)}}}function hs(n){var l,s,r;let e,t;return e=new Xi({props:{id:(l=n[13])==null?void 0:l.id,sources:((s=n[13])==null?void 0:s.sources)??((r=n[13])==null?void 0:r.citations)}}),{c(){x(e.$$.fragment)},l(i){ee(e.$$.fragment,i)},m(i,o){te(e,i,o),t=!0},p(i,o){var f,u,c;const a={};o[0]&8192&&(a.id=(f=i[13])==null?void 0:f.id),o[0]&8192&&(a.sources=((u=i[13])==null?void 0:u.sources)??((c=i[13])==null?void 0:c.citations)),e.$set(a)},i(i){t||(b(e.$$.fragment,i),t=!0)},o(i){D(e.$$.fragment,i),t=!1},d(i){le(e,i)}}}function ms(n){let e,t;return e=new mo({props:{codeExecutions:n[13].code_executions}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&8192&&(r.codeExecutions=l[13].code_executions),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function gs(n){let e,t,l,s,r=(n[13].done||n[1].length>1)&&_s(n),i=n[13].done&&n[24]&&Ts(n);return{c(){e=I("div"),r&&r.c(),t=j(),i&&i.c(),l=he(),this.h()},l(o){e=M(o,"DIV",{class:!0});var a=k(e);r&&r.l(a),a.forEach(g),t=z(o),i&&i.l(o),l=he(),this.h()},h(){h(e,"class","flex justify-start overflow-x-auto buttons text-gray-600 dark:text-gray-500 mt-0.5 svelte-1u5gq5j")},m(o,a){V(o,e,a),r&&r.m(e,null),n[78](e),V(o,t,a),i&&i.m(o,a),V(o,l,a),s=!0},p(o,a){o[13].done||o[1].length>1?r?(r.p(o,a),a[0]&8194&&b(r,1)):(r=_s(o),r.c(),b(r,1),r.m(e,null)):r&&(se(),D(r,1,1,()=>{r=null}),ne()),o[13].done&&o[24]?i?(i.p(o,a),a[0]&16785408&&b(i,1)):(i=Ts(o),i.c(),b(i,1),i.m(l.parentNode,l)):i&&(se(),D(i,1,1,()=>{i=null}),ne())},i(o){s||(b(r),b(i),s=!0)},o(o){D(r),D(i),s=!1},d(o){o&&(g(e),g(t),g(l)),r&&r.d(),n[78](null),i&&i.d(o)}}}function _s(n){let e,t,l,s=n[1].length>1&&ps(n),r=n[13].done&&vs(n);return{c(){s&&s.c(),e=j(),r&&r.c(),t=he()},l(i){s&&s.l(i),e=z(i),r&&r.l(i),t=he()},m(i,o){s&&s.m(i,o),V(i,e,o),r&&r.m(i,o),V(i,t,o),l=!0},p(i,o){i[1].length>1?s?s.p(i,o):(s=ps(i),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),i[13].done?r?(r.p(i,o),o[0]&8192&&b(r,1)):(r=vs(i),r.c(),b(r,1),r.m(t.parentNode,t)):r&&(se(),D(r,1,1,()=>{r=null}),ne())},i(i){l||(b(r),l=!0)},o(i){D(r),l=!1},d(i){i&&(g(e),g(t)),s&&s.d(i),r&&r.d(i)}}}function ps(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i,o='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',a,f;function u(d,_){return d[20]?$o:Yo}let c=u(n),m=c(n);return{c(){e=I("div"),t=I("button"),t.innerHTML=l,s=j(),m.c(),r=j(),i=I("button"),i.innerHTML=o,this.h()},l(d){e=M(d,"DIV",{class:!0,dir:!0});var _=k(e);t=M(_,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(t)!=="svelte-1e0chv1"&&(t.innerHTML=l),s=z(_),m.l(_),r=z(_),i=M(_,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(i)!=="svelte-107ksnk"&&(i.innerHTML=o),_.forEach(g),this.h()},h(){h(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(i,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(e,"class","flex self-center min-w-fit"),h(e,"dir","ltr")},m(d,_){V(d,e,_),p(e,t),p(e,s),m.m(e,null),p(e,r),p(e,i),a||(f=[ue(t,"click",n[62]),ue(i,"click",n[66])],a=!0)},p(d,_){c===(c=u(d))&&m?m.p(d,_):(m.d(1),m=c(d),m&&(m.c(),m.m(e,r)))},d(d){d&&g(e),m.d(),a=!1,Xe(f)}}}function Yo(n){let e,t=n[1].indexOf(n[13].id)+1+"",l,s,r=n[1].length+"",i,o,a;return{c(){e=I("div"),l=F(t),s=F("/"),i=F(r),this.h()},l(f){e=M(f,"DIV",{class:!0});var u=k(e);l=J(u,t),s=J(u,"/"),i=J(u,r),u.forEach(g),this.h()},h(){h(e,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit")},m(f,u){V(f,e,u),p(e,l),p(e,s),p(e,i),o||(a=ue(e,"dblclick",n[65]),o=!0)},p(f,u){u[0]&8194&&t!==(t=f[1].indexOf(f[13].id)+1+"")&&K(l,t),u[0]&2&&r!==(r=f[1].length+"")&&K(i,r)},d(f){f&&g(e),o=!1,a()}}}function $o(n){let e,t,l,s,r,i,o=n[1].length+"",a,f,u;return{c(){e=I("div"),t=I("input"),i=F("/"),a=F(o),this.h()},l(c){e=M(c,"DIV",{class:!0});var m=k(e);t=M(m,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),i=J(m,"/"),a=J(m,o),m.forEach(g),this.h()},h(){h(t,"id",l="message-index-input-"+n[13].id),h(t,"type","number"),t.value=s=n[1].indexOf(n[13].id)+1,h(t,"min","1"),h(t,"max",r=n[1].length),h(t,"class","bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"),h(e,"class","text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit")},m(c,m){V(c,e,m),p(e,t),p(e,i),p(e,a),f||(u=[ue(t,"focus",ba),ue(t,"blur",n[63]),ue(t,"keydown",n[64])],f=!0)},p(c,m){m[0]&8192&&l!==(l="message-index-input-"+c[13].id)&&h(t,"id",l),m[0]&8194&&s!==(s=c[1].indexOf(c[13].id)+1)&&t.value!==s&&(t.value=s),m[0]&2&&r!==(r=c[1].length)&&h(t,"max",r),m[0]&2&&o!==(o=c[1].length+"")&&K(a,o)},d(c){c&&g(e),f=!1,Xe(u)}}}function vs(n){var _,w,y,E,C,S,L,R,v;let e,t,l,s,r,i,o,a,f=!n[12]&&bs(n);t=new Se({props:{content:n[28].t("Copy"),placement:"bottom",$$slots:{default:[ea]},$$scope:{ctx:n}}});let u=(((_=n[29])==null?void 0:_.role)==="admin"||(((E=(y=(w=n[29])==null?void 0:w.permissions)==null?void 0:y.chat)==null?void 0:E.tts)??!0))&&ws(n),c=((C=n[27])==null?void 0:C.features.enable_image_generation)&&(((S=n[29])==null?void 0:S.role)==="admin"||((v=(R=(L=n[29])==null?void 0:L.permissions)==null?void 0:R.features)==null?void 0:v.image_generation))&&!n[12]&&ys(n),m=n[13].usage&&Is(n),d=!n[12]&&Ms(n);return{c(){f&&f.c(),e=j(),x(t.$$.fragment),l=j(),u&&u.c(),s=j(),c&&c.c(),r=j(),m&&m.c(),i=j(),d&&d.c(),o=he()},l(N){f&&f.l(N),e=z(N),ee(t.$$.fragment,N),l=z(N),u&&u.l(N),s=z(N),c&&c.l(N),r=z(N),m&&m.l(N),i=z(N),d&&d.l(N),o=he()},m(N,B){f&&f.m(N,B),V(N,e,B),te(t,N,B),V(N,l,B),u&&u.m(N,B),V(N,s,B),c&&c.m(N,B),V(N,r,B),m&&m.m(N,B),V(N,i,B),d&&d.m(N,B),V(N,o,B),a=!0},p(N,B){var T,H,A,X,oe,ie,re,ce,me;N[12]?f&&(se(),D(f,1,1,()=>{f=null}),ne()):f?(f.p(N,B),B[0]&4096&&b(f,1)):(f=bs(N),f.c(),b(f,1),f.m(e.parentNode,e));const O={};B[0]&268435456&&(O.content=N[28].t("Copy")),B[0]&10240|B[3]&8&&(O.$$scope={dirty:B,ctx:N}),t.$set(O),((T=N[29])==null?void 0:T.role)==="admin"||(((X=(A=(H=N[29])==null?void 0:H.permissions)==null?void 0:A.chat)==null?void 0:X.tts)??!0)?u?(u.p(N,B),B[0]&536870912&&b(u,1)):(u=ws(N),u.c(),b(u,1),u.m(s.parentNode,s)):u&&(se(),D(u,1,1,()=>{u=null}),ne()),(oe=N[27])!=null&&oe.features.enable_image_generation&&(((ie=N[29])==null?void 0:ie.role)==="admin"||(me=(ce=(re=N[29])==null?void 0:re.permissions)==null?void 0:ce.features)!=null&&me.image_generation)&&!N[12]?c?(c.p(N,B),B[0]&671092736&&b(c,1)):(c=ys(N),c.c(),b(c,1),c.m(r.parentNode,r)):c&&(se(),D(c,1,1,()=>{c=null}),ne()),N[13].usage?m?(m.p(N,B),B[0]&8192&&b(m,1)):(m=Is(N),m.c(),b(m,1),m.m(i.parentNode,i)):m&&(se(),D(m,1,1,()=>{m=null}),ne()),N[12]?d&&(se(),D(d,1,1,()=>{d=null}),ne()):d?(d.p(N,B),B[0]&4096&&b(d,1)):(d=Ms(N),d.c(),b(d,1),d.m(o.parentNode,o))},i(N){a||(b(f),b(t.$$.fragment,N),b(u),b(c),b(m),b(d),a=!0)},o(N){D(f),D(t.$$.fragment,N),D(u),D(c),D(m),D(d),a=!1},d(N){N&&(g(e),g(l),g(s),g(r),g(i),g(o)),f&&f.d(N),le(t,N),u&&u.d(N),c&&c.d(N),m&&m.d(N),d&&d.d(N)}}}function bs(n){var s,r,i,o;let e,t,l=(((s=n[29])==null?void 0:s.role)==="user"?((o=(i=(r=n[29])==null?void 0:r.permissions)==null?void 0:i.chat)==null?void 0:o.edit)??!0:!0)&&ks(n);return{c(){l&&l.c(),e=he()},l(a){l&&l.l(a),e=he()},m(a,f){l&&l.m(a,f),V(a,e,f),t=!0},p(a,f){var u,c,m,d;((u=a[29])==null?void 0:u.role)!=="user"||(((d=(m=(c=a[29])==null?void 0:c.permissions)==null?void 0:m.chat)==null?void 0:d.edit)??!0)?l?(l.p(a,f),f[0]&536870912&&b(l,1)):(l=ks(a),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(se(),D(l,1,1,()=>{l=null}),ne())},i(a){t||(b(l),t=!0)},o(a){D(l),t=!1},d(a){a&&g(e),l&&l.d(a)}}}function ks(n){let e,t;return e=new Se({props:{content:n[28].t("Edit"),placement:"bottom",$$slots:{default:[xo]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&268435456&&(r.content=l[28].t("Edit")),s[0]&2048|s[3]&8&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function xo(n){let e,t,l,s,r,i;return{c(){e=I("button"),t=we("svg"),l=we("path"),this.h()},l(o){e=M(o,"BUTTON",{class:!0});var a=k(e);t=ye(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=k(t);l=ye(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(g),f.forEach(g),a.forEach(g),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(o,a){V(o,e,a),p(e,t),p(t,l),r||(i=ue(e,"click",n[67]),r=!0)},p(o,a){a[0]&2048&&s!==(s=(o[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&h(e,"class",s)},d(o){o&&g(e),r=!1,i()}}}function ea(n){let e,t,l,s,r,i;return{c(){e=I("button"),t=we("svg"),l=we("path"),this.h()},l(o){e=M(o,"BUTTON",{class:!0});var a=k(e);t=ye(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=k(t);l=ye(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(g),f.forEach(g),a.forEach(g),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")},m(o,a){V(o,e,a),p(e,t),p(t,l),r||(i=ue(e,"click",n[68]),r=!0)},p(o,a){a[0]&2048&&s!==(s=(o[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")&&h(e,"class",s)},d(o){o&&g(e),r=!1,i()}}}function ws(n){let e,t;return e=new Se({props:{content:n[28].t("Read Aloud"),placement:"bottom",$$slots:{default:[na]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&268435456&&(r.content=l[28].t("Read Aloud")),s[0]&6301696|s[3]&8&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function ta(n){let e,t;return{c(){e=we("svg"),t=we("path"),this.h()},l(l){e=ye(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ye(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(g),s.forEach(g),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width","2.3"),h(e,"stroke","currentColor"),h(e,"class","w-4 h-4")},m(l,s){V(l,e,s),p(e,t)},d(l){l&&g(e)}}}function la(n){let e,t;return{c(){e=we("svg"),t=we("path"),this.h()},l(l){e=ye(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ye(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(g),s.forEach(g),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width","2.3"),h(e,"stroke","currentColor"),h(e,"class","w-4 h-4")},m(l,s){V(l,e,s),p(e,t)},d(l){l&&g(e)}}}function sa(n){let e,t,l,s,r,i;return{c(){e=we("svg"),t=we("style"),l=F(`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),s=we("circle"),r=we("circle"),i=we("circle"),this.h()},l(o){e=ye(o,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var a=k(e);t=ye(a,"style",{});var f=k(t);l=J(f,`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),f.forEach(g),s=ye(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(s).forEach(g),r=ye(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(r).forEach(g),i=ye(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(i).forEach(g),a.forEach(g),this.h()},h(){h(s,"class","spinner_S1WN"),h(s,"cx","4"),h(s,"cy","12"),h(s,"r","3"),h(r,"class","spinner_S1WN spinner_Km9P"),h(r,"cx","12"),h(r,"cy","12"),h(r,"r","3"),h(i,"class","spinner_S1WN spinner_JApP"),h(i,"cx","20"),h(i,"cy","12"),h(i,"r","3"),h(e,"class","w-4 h-4"),h(e,"fill","currentColor"),h(e,"viewBox","0 0 24 24"),h(e,"xmlns","http://www.w3.org/2000/svg")},m(o,a){V(o,e,a),p(e,t),p(t,l),p(e,s),p(e,r),p(e,i)},d(o){o&&g(e)}}}function na(n){let e,t,l,s,r;function i(f,u){return f[22]?sa:f[21]?la:ta}let o=i(n),a=o(n);return{c(){e=I("button"),a.c(),this.h()},l(f){e=M(f,"BUTTON",{id:!0,class:!0});var u=k(e);a.l(u),u.forEach(g),this.h()},h(){h(e,"id",t="speak-button-"+n[13].id),h(e,"class",l=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(f,u){V(f,e,u),a.m(e,null),s||(r=ue(e,"click",n[69]),s=!0)},p(f,u){o!==(o=i(f))&&(a.d(1),a=o(f),a&&(a.c(),a.m(e,null))),u[0]&8192&&t!==(t="speak-button-"+f[13].id)&&h(e,"id",t),u[0]&2048&&l!==(l=(f[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&h(e,"class",l)},d(f){f&&g(e),a.d(),s=!1,r()}}}function ys(n){let e,t;return e=new Se({props:{content:n[28].t("Generate Image"),placement:"bottom",$$slots:{default:[oa]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&268435456&&(r.content=l[28].t("Generate Image")),s[0]&8398848|s[3]&8&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function ra(n){let e,t;return{c(){e=we("svg"),t=we("path"),this.h()},l(l){e=ye(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ye(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(g),s.forEach(g),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width","2.3"),h(e,"stroke","currentColor"),h(e,"class","w-4 h-4")},m(l,s){V(l,e,s),p(e,t)},d(l){l&&g(e)}}}function ia(n){let e,t,l,s,r,i;return{c(){e=we("svg"),t=we("style"),l=F(`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),s=we("circle"),r=we("circle"),i=we("circle"),this.h()},l(o){e=ye(o,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var a=k(e);t=ye(a,"style",{});var f=k(t);l=J(f,`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),f.forEach(g),s=ye(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(s).forEach(g),r=ye(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(r).forEach(g),i=ye(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(i).forEach(g),a.forEach(g),this.h()},h(){h(s,"class","spinner_S1WN"),h(s,"cx","4"),h(s,"cy","12"),h(s,"r","3"),h(r,"class","spinner_S1WN spinner_Km9P"),h(r,"cx","12"),h(r,"cy","12"),h(r,"r","3"),h(i,"class","spinner_S1WN spinner_JApP"),h(i,"cx","20"),h(i,"cy","12"),h(i,"r","3"),h(e,"class","w-4 h-4"),h(e,"fill","currentColor"),h(e,"viewBox","0 0 24 24"),h(e,"xmlns","http://www.w3.org/2000/svg")},m(o,a){V(o,e,a),p(e,t),p(t,l),p(e,s),p(e,r),p(e,i)},d(o){o&&g(e)}}}function oa(n){let e,t,l,s;function r(a,f){return a[23]?ia:ra}let i=r(n),o=i(n);return{c(){e=I("button"),o.c(),this.h()},l(a){e=M(a,"BUTTON",{class:!0});var f=k(e);o.l(f),f.forEach(g),this.h()},h(){h(e,"class",t=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(a,f){V(a,e,f),o.m(e,null),l||(s=ue(e,"click",n[70]),l=!0)},p(a,f){i!==(i=r(a))&&(o.d(1),o=i(a),o&&(o.c(),o.m(e,null))),f[0]&2048&&t!==(t=(a[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&h(e,"class",t)},d(a){a&&g(e),o.d(),l=!1,s()}}}function Is(n){let e,t;return e=new Se({props:{content:n[13].usage?`<pre>${vt(JSON.stringify(n[13].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(Os).map(Rs).join(`
`))}</pre>`:"",placement:"bottom",$$slots:{default:[aa]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&8192&&(r.content=l[13].usage?`<pre>${vt(JSON.stringify(l[13].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(Os).map(Rs).join(`
`))}</pre>`:""),s[0]&10240|s[3]&8&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function aa(n){let e,t,l,s,r,i,o;return{c(){e=I("button"),t=we("svg"),l=we("path"),this.h()},l(a){e=M(a,"BUTTON",{class:!0,id:!0});var f=k(e);t=ye(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=k(t);l=ye(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(g),u.forEach(g),f.forEach(g),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap"),h(e,"id",r="info-"+n[13].id)},m(a,f){V(a,e,f),p(e,t),p(t,l),i||(o=ue(e,"click",n[71]),i=!0)},p(a,f){f[0]&2048&&s!==(s=(a[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap")&&h(e,"class",s),f[0]&8192&&r!==(r="info-"+a[13].id)&&h(e,"id",r)},d(a){a&&g(e),i=!1,o()}}}function Ms(n){var m;let e,t,l,s,r,i,o,a=!n[30]&&(((m=n[27])==null?void 0:m.features.enable_message_rating)??!0)&&Es(n),f=n[11]&&Ns(n);l=new Se({props:{content:n[28].t("Regenerate"),placement:"bottom",$$slots:{default:[da]},$$scope:{ctx:n}}});let u=n[1].length>1&&Ds(n),c=n[11]&&Vs(n);return{c(){a&&a.c(),e=j(),f&&f.c(),t=j(),x(l.$$.fragment),s=j(),u&&u.c(),r=j(),c&&c.c(),i=he()},l(d){a&&a.l(d),e=z(d),f&&f.l(d),t=z(d),ee(l.$$.fragment,d),s=z(d),u&&u.l(d),r=z(d),c&&c.l(d),i=he()},m(d,_){a&&a.m(d,_),V(d,e,_),f&&f.m(d,_),V(d,t,_),te(l,d,_),V(d,s,_),u&&u.m(d,_),V(d,r,_),c&&c.m(d,_),V(d,i,_),o=!0},p(d,_){var y;!d[30]&&(((y=d[27])==null?void 0:y.features.enable_message_rating)??!0)?a?(a.p(d,_),_[0]&1207959552&&b(a,1)):(a=Es(d),a.c(),b(a,1),a.m(e.parentNode,e)):a&&(se(),D(a,1,1,()=>{a=null}),ne()),d[11]?f?(f.p(d,_),_[0]&2048&&b(f,1)):(f=Ns(d),f.c(),b(f,1),f.m(t.parentNode,t)):f&&(se(),D(f,1,1,()=>{f=null}),ne());const w={};_[0]&268435456&&(w.content=d[28].t("Regenerate")),_[0]&16919040|_[3]&8&&(w.$$scope={dirty:_,ctx:d}),l.$set(w),d[1].length>1?u?(u.p(d,_),_[0]&2&&b(u,1)):(u=Ds(d),u.c(),b(u,1),u.m(r.parentNode,r)):u&&(se(),D(u,1,1,()=>{u=null}),ne()),d[11]?c?(c.p(d,_),_[0]&2048&&b(c,1)):(c=Vs(d),c.c(),b(c,1),c.m(i.parentNode,i)):c&&(se(),D(c,1,1,()=>{c=null}),ne())},i(d){o||(b(a),b(f),b(l.$$.fragment,d),b(u),b(c),o=!0)},o(d){D(a),D(f),D(l.$$.fragment,d),D(u),D(c),o=!1},d(d){d&&(g(e),g(t),g(s),g(r),g(i)),a&&a.d(d),f&&f.d(d),le(l,d),u&&u.d(d),c&&c.d(d)}}}function Es(n){let e,t,l,s;return e=new Se({props:{content:n[28].t("Good Response"),placement:"bottom",$$slots:{default:[fa]},$$scope:{ctx:n}}}),l=new Se({props:{content:n[28].t("Bad Response"),placement:"bottom",$$slots:{default:[ua]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment),t=j(),x(l.$$.fragment)},l(r){ee(e.$$.fragment,r),t=z(r),ee(l.$$.fragment,r)},m(r,i){te(e,r,i),V(r,t,i),te(l,r,i),s=!0},p(r,i){const o={};i[0]&268435456&&(o.content=r[28].t("Good Response")),i[0]&33564672|i[3]&8&&(o.$$scope={dirty:i,ctx:r}),e.$set(o);const a={};i[0]&268435456&&(a.content=r[28].t("Bad Response")),i[0]&33564672|i[3]&8&&(a.$$scope={dirty:i,ctx:r}),l.$set(a)},i(r){s||(b(e.$$.fragment,r),b(l.$$.fragment,r),s=!0)},o(r){D(e.$$.fragment,r),D(l.$$.fragment,r),s=!1},d(r){r&&g(t),le(e,r),le(l,r)}}}function fa(n){let e,t,l,s,r,i;return{c(){e=I("button"),t=we("svg"),l=we("path"),this.h()},l(o){e=M(o,"BUTTON",{class:!0});var a=k(e);t=ye(a,"svg",{stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var f=k(t);l=ye(f,"path",{d:!0}),k(l).forEach(g),f.forEach(g),a.forEach(g),this.h()},h(){var o,a;h(l,"d","M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"),h(t,"stroke","currentColor"),h(t,"fill","none"),h(t,"stroke-width","2.3"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"class","w-4 h-4"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((a=(o=n[13])==null?void 0:o.annotation)==null?void 0:a.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=n[25]},m(o,a){V(o,e,a),p(e,t),p(t,l),r||(i=ue(e,"click",n[72]),r=!0)},p(o,a){var f,u;a[0]&10240&&s!==(s=(o[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((u=(f=o[13])==null?void 0:f.annotation)==null?void 0:u.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&h(e,"class",s),a[0]&33554432&&(e.disabled=o[25])},d(o){o&&g(e),r=!1,i()}}}function ua(n){let e,t,l,s,r,i;return{c(){e=I("button"),t=we("svg"),l=we("path"),this.h()},l(o){e=M(o,"BUTTON",{class:!0});var a=k(e);t=ye(a,"svg",{stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var f=k(t);l=ye(f,"path",{d:!0}),k(l).forEach(g),f.forEach(g),a.forEach(g),this.h()},h(){var o,a;h(l,"d","M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"),h(t,"stroke","currentColor"),h(t,"fill","none"),h(t,"stroke-width","2.3"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"class","w-4 h-4"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((a=(o=n[13])==null?void 0:o.annotation)==null?void 0:a.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=n[25]},m(o,a){V(o,e,a),p(e,t),p(t,l),r||(i=ue(e,"click",n[73]),r=!0)},p(o,a){var f,u;a[0]&10240&&s!==(s=(o[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((u=(f=o[13])==null?void 0:f.annotation)==null?void 0:u.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&h(e,"class",s),a[0]&33554432&&(e.disabled=o[25])},d(o){o&&g(e),r=!1,i()}}}function Ns(n){let e,t;return e=new Se({props:{content:n[28].t("Continue Response"),placement:"bottom",$$slots:{default:[ca]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&268435456&&(r.content=l[28].t("Continue Response")),s[0]&2304|s[3]&8&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function ca(n){let e,t,l,s,r,i,o;return{c(){e=I("button"),t=we("svg"),l=we("path"),s=we("path"),this.h()},l(a){e=M(a,"BUTTON",{type:!0,id:!0,class:!0});var f=k(e);t=ye(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=k(t);l=ye(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(g),s=ye(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(s).forEach(g),u.forEach(g),f.forEach(g),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),h(s,"stroke-linecap","round"),h(s,"stroke-linejoin","round"),h(s,"d","M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113a.375.375 0 0 1-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112Z"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"type","button"),h(e,"id","continue-response-button"),h(e,"class",r=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(a,f){V(a,e,f),p(e,t),p(t,l),p(t,s),i||(o=ue(e,"click",n[74]),i=!0)},p(a,f){f[0]&2048&&r!==(r=(a[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&h(e,"class",r)},d(a){a&&g(e),i=!1,o()}}}function da(n){let e,t,l,s,r,i;return{c(){e=I("button"),t=we("svg"),l=we("path"),this.h()},l(o){e=M(o,"BUTTON",{type:!0,class:!0});var a=k(e);t=ye(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=k(t);l=ye(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(g),f.forEach(g),a.forEach(g),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"type","button"),h(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(o,a){V(o,e,a),p(e,t),p(t,l),r||(i=ue(e,"click",n[75]),r=!0)},p(o,a){a[0]&2048&&s!==(s=(o[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&h(e,"class",s)},d(o){o&&g(e),r=!1,i()}}}function Ds(n){let e,t;return e=new Se({props:{content:n[28].t("Delete"),placement:"bottom",$$slots:{default:[ha]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&268435456&&(r.content=l[28].t("Delete")),s[0]&67584|s[3]&8&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function ha(n){let e,t,l,s,r,i;return{c(){e=I("button"),t=we("svg"),l=we("path"),this.h()},l(o){e=M(o,"BUTTON",{type:!0,id:!0,class:!0});var a=k(e);t=ye(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=k(t);l=ye(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(g),f.forEach(g),a.forEach(g),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"type","button"),h(e,"id","delete-response-button"),h(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(o,a){V(o,e,a),p(e,t),p(t,l),r||(i=ue(e,"click",n[76]),r=!0)},p(o,a){a[0]&2048&&s!==(s=(o[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&h(e,"class",s)},d(o){o&&g(e),r=!1,i()}}}function Vs(n){var i;let e,t,l=Ve(((i=n[17])==null?void 0:i.actions)??[]),s=[];for(let o=0;o<l.length;o+=1)s[o]=Cs(ns(n,l,o));const r=o=>D(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=he()},l(o){for(let a=0;a<s.length;a+=1)s[a].l(o);e=he()},m(o,a){for(let f=0;f<s.length;f+=1)s[f]&&s[f].m(o,a);V(o,e,a),t=!0},p(o,a){var f;if(a[0]&141376){l=Ve(((f=o[17])==null?void 0:f.actions)??[]);let u;for(u=0;u<l.length;u+=1){const c=ns(o,l,u);s[u]?(s[u].p(c,a),b(s[u],1)):(s[u]=Cs(c),s[u].c(),b(s[u],1),s[u].m(e.parentNode,e))}for(se(),u=l.length;u<s.length;u+=1)r(u);ne()}},i(o){if(!t){for(let a=0;a<l.length;a+=1)b(s[a]);t=!0}},o(o){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)D(s[a]);t=!1},d(o){o&&g(e),Fe(s,o)}}}function ma(n){let e,t;return e=new ki({props:{strokeWidth:"2.1",className:"size-4"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function ga(n){let e,t,l,s,r;return{c(){e=I("div"),t=I("img"),this.h()},l(i){e=M(i,"DIV",{class:!0});var o=k(e);t=M(o,"IMG",{src:!0,class:!0,style:!0,alt:!0}),o.forEach(g),this.h()},h(){Lt(t.src,l=n[89].icon_url)||h(t,"src",l),h(t,"class",s="w-4 h-4 "+(n[89].icon_url.includes("svg")?"dark:invert-[80%]":"")),Rt(t,"fill","currentColor"),h(t,"alt",r=n[89].name),h(e,"class","size-4")},m(i,o){V(i,e,o),p(e,t)},p(i,o){o[0]&131072&&!Lt(t.src,l=i[89].icon_url)&&h(t,"src",l),o[0]&131072&&s!==(s="w-4 h-4 "+(i[89].icon_url.includes("svg")?"dark:invert-[80%]":""))&&h(t,"class",s),o[0]&131072&&r!==(r=i[89].name)&&h(t,"alt",r)},i:ve,o:ve,d(i){i&&g(e)}}}function _a(n){let e,t,l,s,r,i,o,a;const f=[ga,ma],u=[];function c(d,_){return d[89].icon_url?0:1}t=c(n),l=u[t]=f[t](n);function m(){return n[77](n[89])}return{c(){e=I("button"),l.c(),r=j(),this.h()},l(d){e=M(d,"BUTTON",{type:!0,class:!0});var _=k(e);l.l(_),_.forEach(g),r=z(d),this.h()},h(){h(e,"type","button"),h(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(d,_){V(d,e,_),u[t].m(e,null),V(d,r,_),i=!0,o||(a=ue(e,"click",m),o=!0)},p(d,_){n=d;let w=t;t=c(n),t===w?u[t].p(n,_):(se(),D(u[w],1,1,()=>{u[w]=null}),ne(),l=u[t],l?l.p(n,_):(l=u[t]=f[t](n),l.c()),b(l,1),l.m(e,null)),(!i||_[0]&2048&&s!==(s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition"))&&h(e,"class",s)},i(d){i||(b(l),i=!0)},o(d){D(l),i=!1},d(d){d&&(g(e),g(r)),u[t].d(),o=!1,a()}}}function Cs(n){let e,t;return e=new Se({props:{content:n[89].name,placement:"bottom",$$slots:{default:[_a]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&131072&&(r.content=l[89].name),s[0]&141376|s[3]&8&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Ts(n){let e,t,l,s;function r(a){n[79](a)}function i(a){n[80](a)}let o={};return n[13]!==void 0&&(o.message=n[13]),n[24]!==void 0&&(o.show=n[24]),e=new ui({props:o}),je.push(()=>Qe(e,"message",r)),je.push(()=>Qe(e,"show",i)),e.$on("save",n[81]),{c(){x(e.$$.fragment)},l(a){ee(e.$$.fragment,a)},m(a,f){te(e,a,f),s=!0},p(a,f){const u={};!t&&f[0]&8192&&(t=!0,u.message=a[13],Ke(()=>t=!1)),!l&&f[0]&16777216&&(l=!0,u.show=a[24],Ke(()=>l=!1)),e.$set(u)},i(a){s||(b(e.$$.fragment,a),s=!0)},o(a){D(e.$$.fragment,a),s=!1},d(a){le(e,a)}}}function Bs(n){var A,X,oe,ie,re,ce,me,Ie;let e,t,l,s,r,i,o,a,f,u,c,m=((A=n[13])==null?void 0:A.files)&&((X=n[13].files)==null?void 0:X.filter(Ss).length)>0,d,_,w,y,E,C,S,L,R;l=new Vn({props:{src:((re=(ie=(oe=n[17])==null?void 0:oe.info)==null?void 0:ie.meta)==null?void 0:re.profile_image_url)??(n[28].language==="dg-DG"?"/doge.png":`${Pt}/static/favicon.png`),className:"size-8"}}),i=new Kt({props:{$$slots:{default:[So]},$$scope:{ctx:n}}});let v=(((ce=n[13])==null?void 0:ce.statusHistory)??[...(me=n[13])!=null&&me.status?[(Ie=n[13])==null?void 0:Ie.status]:[]]).length>0&&os(Wt(n)),N=m&&us(n);const B=[Ko,Zo],O=[];function T(W,G){return W[14]===!0?0:1}_=T(n),w=O[_]=B[_](n);let H=!n[14]&&gs(n);return{c(){e=I("div"),t=I("div"),x(l.$$.fragment),s=j(),r=I("div"),x(i.$$.fragment),o=j(),a=I("div"),f=I("div"),u=I("div"),v&&v.c(),c=j(),N&&N.c(),d=j(),w.c(),E=j(),H&&H.c(),this.h()},l(W){e=M(W,"DIV",{class:!0,id:!0,dir:!0});var G=k(e);t=M(G,"DIV",{class:!0});var ge=k(t);ee(l.$$.fragment,ge),ge.forEach(g),s=z(G),r=M(G,"DIV",{class:!0});var pe=k(r);ee(i.$$.fragment,pe),o=z(pe),a=M(pe,"DIV",{});var q=k(a);f=M(q,"DIV",{class:!0});var de=k(f);u=M(de,"DIV",{});var fe=k(u);v&&v.l(fe),c=z(fe),N&&N.l(fe),d=z(fe),w.l(fe),fe.forEach(g),de.forEach(g),E=z(q),H&&H.l(q),q.forEach(g),pe.forEach(g),G.forEach(g),this.h()},h(){h(t,"class",hr("shrink-0 ltr:mr-3 rtl:ml-3")+" svelte-1u5gq5j"),h(f,"class",y="chat-"+n[13].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"),h(r,"class","flex-auto w-0 pl-1"),h(e,"class",C="flex w-full message-"+n[13].id+" svelte-1u5gq5j"),h(e,"id",S="message-"+n[13].id),h(e,"dir",L=n[26].chatDirection)},m(W,G){V(W,e,G),p(e,t),te(l,t,null),p(e,s),p(e,r),te(i,r,null),p(r,o),p(r,a),p(a,f),p(f,u),v&&v.m(u,null),p(u,c),N&&N.m(u,null),p(u,d),O[_].m(u,null),p(a,E),H&&H.m(a,null),R=!0},p(W,G){var de,fe,_e,be,P,Q,$,Z;const ge={};G[0]&268566528&&(ge.src=((_e=(fe=(de=W[17])==null?void 0:de.info)==null?void 0:fe.meta)==null?void 0:_e.profile_image_url)??(W[28].language==="dg-DG"?"/doge.png":`${Pt}/static/favicon.png`)),l.$set(ge);const pe={};G[0]&139264|G[3]&8&&(pe.$$scope={dirty:G,ctx:W}),i.$set(pe),(((be=W[13])==null?void 0:be.statusHistory)??[...(P=W[13])!=null&&P.status?[(Q=W[13])==null?void 0:Q.status]:[]]).length>0?v?(v.p(Wt(W),G),G[0]&8192&&b(v,1)):(v=os(Wt(W)),v.c(),b(v,1),v.m(u,c)):v&&(se(),D(v,1,1,()=>{v=null}),ne()),G[0]&8192&&(m=(($=W[13])==null?void 0:$.files)&&((Z=W[13].files)==null?void 0:Z.filter(Ss).length)>0),m?N?(N.p(W,G),G[0]&8192&&b(N,1)):(N=us(W),N.c(),b(N,1),N.m(u,d)):N&&(se(),D(N,1,1,()=>{N=null}),ne());let q=_;_=T(W),_===q?O[_].p(W,G):(se(),D(O[q],1,1,()=>{O[q]=null}),ne(),w=O[_],w?w.p(W,G):(w=O[_]=B[_](W),w.c()),b(w,1),w.m(u,null)),(!R||G[0]&8192&&y!==(y="chat-"+W[13].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"))&&h(f,"class",y),W[14]?H&&(se(),D(H,1,1,()=>{H=null}),ne()):H?(H.p(W,G),G[0]&16384&&b(H,1)):(H=gs(W),H.c(),b(H,1),H.m(a,null)),(!R||G[0]&8192&&C!==(C="flex w-full message-"+W[13].id+" svelte-1u5gq5j"))&&h(e,"class",C),(!R||G[0]&8192&&S!==(S="message-"+W[13].id))&&h(e,"id",S),(!R||G[0]&67108864&&L!==(L=W[26].chatDirection))&&h(e,"dir",L)},i(W){R||(b(l.$$.fragment,W),b(i.$$.fragment,W),b(v),b(N),b(w),b(H),R=!0)},o(W){D(l.$$.fragment,W),D(i.$$.fragment,W),D(v),D(N),D(w),D(H),R=!1},d(W){W&&g(e),le(l),le(i),v&&v.d(),N&&N.d(),O[_].d(),H&&H.d()}}}function pa(n){let e,t,l,s=n[13].id,r,i;function o(u){n[49](u)}let a={title:n[28].t("Delete message?")};n[16]!==void 0&&(a.show=n[16]),e=new On({props:a}),je.push(()=>Qe(e,"show",o)),e.$on("confirm",n[50]);let f=Bs(n);return{c(){x(e.$$.fragment),l=j(),f.c(),r=he()},l(u){ee(e.$$.fragment,u),l=z(u),f.l(u),r=he()},m(u,c){te(e,u,c),V(u,l,c),f.m(u,c),V(u,r,c),i=!0},p(u,c){const m={};c[0]&268435456&&(m.title=u[28].t("Delete message?")),!t&&c[0]&65536&&(t=!0,m.show=u[16],Ke(()=>t=!1)),e.$set(m),c[0]&8192&&Be(s,s=u[13].id)?(se(),D(f,1,1,ve),ne(),f=Bs(u),f.c(),b(f,1),f.m(r.parentNode,r)):f.p(u,c)},i(u){i||(b(e.$$.fragment,u),b(f),i=!0)},o(u){D(e.$$.fragment,u),D(f),i=!1},d(u){u&&(g(l),g(r)),le(e,u),f.d(u)}}}const Ss=n=>n.type==="image",va=n=>{n.target.style.height="",n.target.style.height=`${n.target.scrollHeight}px`},ba=n=>{n.target.select()},Os=n=>n.slice(2),Rs=n=>n.endsWith(",")?n.slice(0,-1):n;function ka(n,e,t){let l,s,r,i,o,a,f;Ee(n,jt,U=>t(48,l=U)),Ee(n,yt,U=>t(26,s=U)),Ee(n,En,U=>t(27,r=U)),Ee(n,cl,U=>t(85,i=U)),Ee(n,zt,U=>t(29,a=U)),Ee(n,Zt,U=>t(30,f=U));const u=Je("i18n");Ee(n,u,U=>t(28,o=U));const c=gt();let{chatId:m=""}=e,{history:d}=e,{messageId:_}=e,w=JSON.parse(JSON.stringify(d.messages[_])),{siblings:y}=e,{gotoMessage:E=()=>{}}=e,{showPreviousMessage:C}=e,{showNextMessage:S}=e,{updateChat:L}=e,{editMessage:R}=e,{saveMessage:v}=e,{rateMessage:N}=e,{actionMessage:B}=e,{deleteMessage:O}=e,{submitMessage:T}=e,{continueResponse:H}=e,{regenerateResponse:A}=e,{addMessages:X}=e,{isLastMessage:oe=!0}=e,{readOnly:ie=!1}=e,re,ce=!1,me=null,Ie=!1,W="",G,ge=!1,pe={},q=!1,de,fe=!1,_e=!1,be=!1;const P=async U=>{U=Er(U),await Nn(U,(s==null?void 0:s.copyFormatted)??!1)&&Ae.success(o.t("Copying to clipboard was successful!"))},Q=U=>new Promise(Ne=>{de=U;const Me=pe[U];if(!Me)return Ne();Me.play(),Me.onended=async()=>{await new Promise(Te=>setTimeout(Te,300)),Object.keys(pe).length-1===U&&t(21,q=!1),Ne()}}),$=async()=>{var U,Ne,Me,Te,Ge,et,Ct,ct,kt,Oe,Ze,rt,wt,Tt,Yt,$t,xt,el,tl,ll,sl,nl,rl;if(q){try{speechSynthesis.cancel(),de!==void 0&&pe[de]&&(pe[de].pause(),pe[de].currentTime=0)}catch{}t(21,q=!1),de=void 0;return}if(!((w==null?void 0:w.content)??"").trim().length){Ae.info(o.t("No content to speak"));return}if(t(21,q=!0),r.audio.tts.engine===""){let $e=[];const _t=setInterval(()=>{var xe,dt,tt;if($e=speechSynthesis.getVoices(),$e.length>0){clearInterval(_t);const We=((xe=$e==null?void 0:$e.filter(mt=>{var il,ol,al,fl;return mt.voiceURI===(((ol=(il=s==null?void 0:s.audio)==null?void 0:il.tts)==null?void 0:ol.voice)??((fl=(al=r==null?void 0:r.audio)==null?void 0:al.tts)==null?void 0:fl.voice))}))==null?void 0:xe.at(0))??void 0;console.log(We);const ht=new SpeechSynthesisUtterance(w.content);ht.rate=((tt=(dt=s.audio)==null?void 0:dt.tts)==null?void 0:tt.playbackRate)??1,console.log(ht),ht.onend=()=>{var mt;t(21,q=!1),s.conversationMode&&((mt=document.getElementById("voice-input-button"))==null||mt.click())},We&&(ht.voice=We),speechSynthesis.speak(ht)}},100)}else{t(22,fe=!0);const $e=Nr(w.content,((Ne=(U=r==null?void 0:r.audio)==null?void 0:U.tts)==null?void 0:Ne.split_on)??"punctuation");if(!$e.length){console.log("No content to speak"),Ae.info(o.t("No content to speak")),t(21,q=!1),t(22,fe=!1);return}console.debug("Prepared message content for TTS",$e),pe=$e.reduce((xe,dt,tt)=>(xe[tt]=null,xe),{});let _t=Promise.resolve();if(((Te=(Me=s.audio)==null?void 0:Me.tts)==null?void 0:Te.engine)==="browser-kokoro"){i||(await cl.set(new Fr({dtype:((Ct=(et=(Ge=s.audio)==null?void 0:Ge.tts)==null?void 0:et.engineConfig)==null?void 0:Ct.dtype)??"fp32"})),await i.init());for(const[xe,dt]of $e.entries()){const tt=await i.generate({text:dt,voice:((kt=(ct=s==null?void 0:s.audio)==null?void 0:ct.tts)==null?void 0:kt.voice)??((Ze=(Oe=r==null?void 0:r.audio)==null?void 0:Oe.tts)==null?void 0:Ze.voice)}).catch(We=>{console.error(We),Ae.error(`${We}`),t(21,q=!1),t(22,fe=!1)});if(tt){const We=new Audio(tt);We.playbackRate=((wt=(rt=s.audio)==null?void 0:rt.tts)==null?void 0:wt.playbackRate)??1,pe[xe]=We,t(22,fe=!1),_t=_t.then(()=>Q(xe))}}}else for(const[xe,dt]of $e.entries()){const tt=await Cr(localStorage.token,((Yt=(Tt=s==null?void 0:s.audio)==null?void 0:Tt.tts)==null?void 0:Yt.defaultVoice)===r.audio.tts.voice?((xt=($t=s==null?void 0:s.audio)==null?void 0:$t.tts)==null?void 0:xt.voice)??((tl=(el=r==null?void 0:r.audio)==null?void 0:el.tts)==null?void 0:tl.voice):(sl=(ll=r==null?void 0:r.audio)==null?void 0:ll.tts)==null?void 0:sl.voice,dt).catch(We=>{console.error(We),Ae.error(`${We}`),t(21,q=!1),t(22,fe=!1)});if(tt){const We=await tt.blob(),ht=URL.createObjectURL(We),mt=new Audio(ht);mt.playbackRate=((rl=(nl=s.audio)==null?void 0:nl.tts)==null?void 0:rl.playbackRate)??1,pe[xe]=mt,t(22,fe=!1),_t=_t.then(()=>Q(xe))}}}};let Z=[];function ae(U){const Ne=[];let Me=0;return U=U.replace(/<details[\s\S]*?<\/details>/gi,Te=>(Ne.push(Te),`<details id="__DETAIL_${Me++}__"/>`)),Z=Ne,U}function ke(U){return U.replace(/<details id="__DETAIL_(\d+)__"\/>/g,(Me,Te)=>Z[parseInt(Te)]||"")}const Ce=async()=>{t(14,Ie=!0),t(18,W=ae(w.content)),await De(),t(19,G.style.height="",G),t(19,G.style.height=`${G.scrollHeight}px`,G)},Y=async()=>{const U=ke(W||"");R(w.id,U,!1),t(14,Ie=!1),t(18,W=""),await De()},Pe=async()=>{const U=ke(W||"");R(w.id,U),t(14,Ie=!1),t(18,W=""),await De()},He=async()=>{t(14,Ie=!1),t(18,W=""),await De()},ze=async U=>{t(23,_e=!0);const Ne=await Tr(localStorage.token,U.content).catch(Me=>{Ae.error(`${Me}`)});if(console.log(Ne),Ne){const Me=Ne.map(Te=>({type:"image",url:`${Te.url}`}));v(U.id,{...U,files:Me})}t(23,_e=!1)};let qe=!1;const Ye=async(U=null,Ne=null)=>{var kt;t(25,qe=!0),console.log("Feedback",U,Ne);const Me={...w,annotation:{...(w==null?void 0:w.annotation)??{},...U!==null?{rating:U}:{},...Ne||{}}},Te=await yr(localStorage.token,m).catch(Oe=>{Ae.error(`${Oe}`)});if(!Te)return;const Ge=Jt(d,w.id);let et={type:"rating",data:{...Me!=null&&Me.annotation?Me.annotation:{},model_id:(w==null?void 0:w.selectedModelId)??w.model,...d.messages[w.parentId].childrenIds.length>1?{sibling_model_ids:d.messages[w.parentId].childrenIds.filter(Oe=>Oe!==w.id).map(Oe=>{var Ze;return((Ze=d.messages[Oe])==null?void 0:Ze.selectedModelId)??d.messages[Oe].model})}:{}},meta:{arena:w?w.arena:!1,model_id:w.model,message_id:w.id,message_index:Ge.length,chat_id:m},snapshot:{chat:Te}};const Ct=[et.data.model_id,...et.data.sibling_model_ids??[]].reduce((Oe,Ze)=>{var wt;const rt=l.find(Tt=>Tt.id===Ze);return rt?Oe[rt.id]=((wt=rt==null?void 0:rt.info)==null?void 0:wt.base_model_id)??null:console.warn(`Model with ID ${Ze} not found`),Oe},{});et.meta.base_models=Ct;let ct=null;if(w!=null&&w.feedbackId?ct=await gl(localStorage.token,w.feedbackId,et).catch(Oe=>{Ae.error(`${Oe}`)}):(ct=await Dr(localStorage.token,et).catch(Oe=>{Ae.error(`${Oe}`)}),ct&&(Me.feedbackId=ct.id)),console.log(Me),v(w.id,Me),await De(),!Ne&&(t(24,be=!0),!((kt=Me.annotation)!=null&&kt.tags))){const Oe=await Vr(localStorage.token,w.model,Ge,m).catch(Ze=>(console.error(Ze),[]));console.log(Oe),Oe&&(Me.annotation.tags=Oe,et.data.tags=Oe,v(w.id,Me),await gl(localStorage.token,Me.feedbackId,et).catch(Ze=>{Ae.error(`${Ze}`)}))}t(25,qe=!1)},st=async()=>{O(w.id)};bt(async()=>{await De(),re&&(console.log(re),re.addEventListener("wheel",function(U){U.preventDefault(),U.deltaY!==0&&t(15,re.scrollLeft+=U.deltaY,re)}))});function at(U){ce=U,t(16,ce)}const lt=()=>{st()};function ft(U){je[U?"unshift":"push"](()=>{G=U,t(19,G)})}function ut(){W=this.value,t(18,W)}const nt=U=>{var Te,Ge;U.key==="Escape"&&((Te=document.getElementById("close-edit-message-button"))==null||Te.click());const Ne=U.metaKey||U.ctrlKey,Me=U.key==="Enter";Ne&&Me&&((Ge=document.getElementById("confirm-edit-message-button"))==null||Ge.click())},Mt=()=>{Pe()},Et=()=>{He()},Nt=()=>{Y()},Dt=async U=>{console.log(U)},Vt=async(U,Ne)=>{console.log(U,Ne);let Me=document.getElementById(`source-${w.id}-${Ne}`);const Te=document.getElementById(`collapsible-${w.id}`);Me?Me.click():Te&&(Te.querySelector("div:first-child").dispatchEvent(new PointerEvent("pointerup",{})),await new Promise(Ge=>{requestAnimationFrame(()=>{requestAnimationFrame(Ge)})}),Me=document.getElementById(`source-${w.id}-${Ne}`),Me&&Me.click())},An=({modelId:U,parentId:Ne,messages:Me})=>{X({modelId:U,parentId:Ne,messages:Me})},Hn=U=>{const{raw:Ne,oldContent:Me,newContent:Te}=U.detail;t(0,d.messages[w.id].content=d.messages[w.id].content.replace(Ne,Ne.replace(Me,Te)),d),L()},jn=U=>{var Te;const{type:Ne,content:Me}=U.detail;if(Ne==="explain")T(w.id,`Explain this section to me in more detail

\`\`\`
${Me}
\`\`\``);else if(Ne==="ask"){const Ge=((Te=U.detail)==null?void 0:Te.input)??"";T(w.id,`\`\`\`
${Me}
\`\`\`
${Ge}`)}},zn=()=>{C(w)},Un=U=>{E(w,U.target.value-1),t(20,ge=!1)},Wn=U=>{U.key==="Enter"&&(E(w,U.target.value-1),t(20,ge=!1))},qn=async()=>{t(20,ge=!0),await De();const U=document.getElementById(`message-index-input-${w.id}`);U&&(U.focus(),U.select())},Fn=()=>{S(w)},Jn=()=>{Ce()},Gn=()=>{P(w.content)},Zn=()=>{fe||$()},Kn=()=>{_e||ze(w)},Qn=()=>{console.log(w)},Xn=async()=>{await Ye(1),window.setTimeout(()=>{var U;(U=document.getElementById(`message-feedback-${w.id}`))==null||U.scrollIntoView()},0)},Yn=async()=>{await Ye(-1),window.setTimeout(()=>{var U;(U=document.getElementById(`message-feedback-${w.id}`))==null||U.scrollIntoView()},0)},$n=()=>{H()},xn=()=>{t(24,be=!1),A(w),((me==null?void 0:me.actions)??[]).forEach(U=>{c("action",{id:U.id,event:{id:"regenerate-response",data:{messageId:w.id}}})})},er=()=>{t(16,ce=!0)},tr=U=>{B(U.id,w)};function lr(U){je[U?"unshift":"push"](()=>{re=U,t(15,re)})}function sr(U){w=U,t(13,w),t(0,d),t(43,_)}function nr(U){be=U,t(24,be)}const rr=async U=>{await Ye(null,{...U.detail})};return n.$$set=U=>{"chatId"in U&&t(42,m=U.chatId),"history"in U&&t(0,d=U.history),"messageId"in U&&t(43,_=U.messageId),"siblings"in U&&t(1,y=U.siblings),"gotoMessage"in U&&t(2,E=U.gotoMessage),"showPreviousMessage"in U&&t(3,C=U.showPreviousMessage),"showNextMessage"in U&&t(4,S=U.showNextMessage),"updateChat"in U&&t(5,L=U.updateChat),"editMessage"in U&&t(44,R=U.editMessage),"saveMessage"in U&&t(45,v=U.saveMessage),"rateMessage"in U&&t(46,N=U.rateMessage),"actionMessage"in U&&t(6,B=U.actionMessage),"deleteMessage"in U&&t(47,O=U.deleteMessage),"submitMessage"in U&&t(7,T=U.submitMessage),"continueResponse"in U&&t(8,H=U.continueResponse),"regenerateResponse"in U&&t(9,A=U.regenerateResponse),"addMessages"in U&&t(10,X=U.addMessages),"isLastMessage"in U&&t(11,oe=U.isLastMessage),"readOnly"in U&&t(12,ie=U.readOnly)},n.$$.update=()=>{n.$$.dirty[0]&8193|n.$$.dirty[1]&4096&&d.messages&&JSON.stringify(w)!==JSON.stringify(d.messages[_])&&t(13,w=JSON.parse(JSON.stringify(d.messages[_]))),n.$$.dirty[0]&8192|n.$$.dirty[1]&131072&&t(17,me=l.find(U=>U.id===w.model)),n.$$.dirty[0]&16384&&(Ie||(async()=>await De())())},[d,y,E,C,S,L,B,T,H,A,X,oe,ie,w,Ie,re,ce,me,W,G,ge,q,fe,_e,be,qe,s,r,o,a,f,u,c,P,$,Ce,Y,Pe,He,ze,Ye,st,m,_,R,v,N,O,l,at,lt,ft,ut,nt,Mt,Et,Nt,Dt,Vt,An,Hn,jn,zn,Un,Wn,qn,Fn,Jn,Gn,Zn,Kn,Qn,Xn,Yn,$n,xn,er,tr,lr,sr,nr,rr]}class Pn extends Re{constructor(e){super(),Le(this,e,ka,pa,Be,{chatId:42,history:0,messageId:43,siblings:1,gotoMessage:2,showPreviousMessage:3,showNextMessage:4,updateChat:5,editMessage:44,saveMessage:45,rateMessage:46,actionMessage:6,deleteMessage:47,submitMessage:7,continueResponse:8,regenerateResponse:9,addMessages:10,isLastMessage:11,readOnly:12},null,[-1,-1,-1,-1])}}function wa(n){let e,t;return{c(){e=we("svg"),t=we("path"),this.h()},l(l){e=ye(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ye(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(g),s.forEach(g),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M8 8v8m0-8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 8a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm6-2a2 2 0 1 1 4 0 2 2 0 0 1-4 0Zm0 0h-1a5 5 0 0 1-5-5v-.5"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width",n[1]),h(e,"stroke","currentColor"),h(e,"class",n[0])},m(l,s){V(l,e,s),p(e,t)},p(l,[s]){s&2&&h(e,"stroke-width",l[1]),s&1&&h(e,"class",l[0])},i:ve,o:ve,d(l){l&&g(e)}}}function ya(n,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class Ia extends Re{constructor(e){super(),Le(this,e,ya,wa,Be,{className:0,strokeWidth:1})}}function qt(n){var l;const e=n.slice(),t=(l=e[0].messages[e[2]])==null?void 0:l.merged;return e[16]=t,e}function Ls(n,e,t){const l=n.slice();return l[38]=e[t],l}function Ft(n){const e=n.slice(),t=e[19][e[38]].messageIds[e[20][e[38]]];return e[41]=t,e}function Ps(n){let e,t,l,s,r,i=Ve(Object.keys(n[19])),o=[];for(let u=0;u<i.length;u+=1)o[u]=zs(Ls(n,i,u));const a=u=>D(o[u],1,1,()=>{o[u]=null});let f=!n[4]&&Us(n);return{c(){e=I("div"),t=I("div");for(let u=0;u<o.length;u+=1)o[u].c();s=j(),f&&f.c(),this.h()},l(u){e=M(u,"DIV",{});var c=k(e);t=M(c,"DIV",{class:!0,id:!0});var m=k(t);for(let d=0;d<o.length;d+=1)o[d].l(m);m.forEach(g),s=z(c),f&&f.l(c),c.forEach(g),this.h()},h(){h(t,"class","flex snap-x snap-mandatory overflow-x-auto scrollbar-hidden"),h(t,"id",l="responses-container-"+n[1]+"-"+n[18].id)},m(u,c){V(u,e,c),p(e,t);for(let m=0;m<o.length;m+=1)o[m]&&o[m].m(t,null);p(e,s),f&&f.m(e,null),r=!0},p(u,c){if(c[0]&121241591){i=Ve(Object.keys(u[19]));let m;for(m=0;m<i.length;m+=1){const d=Ls(u,i,m);o[m]?(o[m].p(d,c),b(o[m],1)):(o[m]=zs(d),o[m].c(),b(o[m],1),o[m].m(t,null))}for(se(),m=i.length;m<o.length;m+=1)a(m);ne()}(!r||c[0]&262146&&l!==(l="responses-container-"+u[1]+"-"+u[18].id))&&h(t,"id",l),u[4]?f&&(se(),D(f,1,1,()=>{f=null}),ne()):f?(f.p(u,c),c[0]&16&&b(f,1)):(f=Us(u),f.c(),b(f,1),f.m(e,null))},i(u){if(!r){for(let c=0;c<i.length;c+=1)b(o[c]);b(f),r=!0}},o(u){o=o.filter(Boolean);for(let c=0;c<o.length;c+=1)D(o[c]);D(f),r=!1},d(u){u&&g(e),Fe(o,u),f&&f.d()}}}function As(n){let e,t=n[0].currentId,l,s,r,i,o,a=js(n);function f(){return n[34](n[41])}return{c(){e=I("div"),a.c(),l=j(),this.h()},l(u){e=M(u,"DIV",{class:!0});var c=k(e);a.l(c),l=z(c),c.forEach(g),this.h()},h(){var u;h(e,"class",s="snap-center w-full max-w-full m-1 border "+(((u=n[0].messages[n[2]])==null?void 0:u.modelIdx)==n[38]?`border-gray-100 dark:border-gray-850 border-[1.5px] ${n[21]?"min-w-full":"min-w-80"}`:`border-gray-100 dark:border-gray-850 border-dashed ${n[21]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl")},m(u,c){V(u,e,c),a.m(e,null),p(e,l),r=!0,i||(o=ue(e,"click",f),i=!0)},p(u,c){var m;n=u,c[0]&1&&Be(t,t=n[0].currentId)?(se(),D(a,1,1,ve),ne(),a=js(n),a.c(),b(a,1),a.m(e,l)):a.p(n,c),(!r||c[0]&2621445&&s!==(s="snap-center w-full max-w-full m-1 border "+(((m=n[0].messages[n[2]])==null?void 0:m.modelIdx)==n[38]?`border-gray-100 dark:border-gray-850 border-[1.5px] ${n[21]?"min-w-full":"min-w-80"}`:`border-gray-100 dark:border-gray-850 border-dashed ${n[21]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl"))&&h(e,"class",s)},i(u){r||(b(a),r=!0)},o(u){D(a),r=!1},d(u){u&&g(e),a.d(u),i=!1,o()}}}function Hs(n){let e,t;function l(...o){return n[30](n[38],...o)}function s(){return n[31](n[38])}function r(){return n[32](n[38])}function i(...o){return n[33](n[38],...o)}return e=new Pn({props:{chatId:n[1],history:n[0],messageId:n[41],isLastMessage:!0,siblings:n[19][n[38]].messageIds,gotoMessage:l,showPreviousMessage:s,showNextMessage:r,updateChat:n[5],editMessage:n[6],saveMessage:n[7],rateMessage:n[8],deleteMessage:n[11],actionMessage:n[9],submitMessage:n[10],continueResponse:n[12],regenerateResponse:i,addMessages:n[14],readOnly:n[4]}}),{c(){x(e.$$.fragment)},l(o){ee(e.$$.fragment,o)},m(o,a){te(e,o,a),t=!0},p(o,a){n=o;const f={};a[0]&2&&(f.chatId=n[1]),a[0]&1&&(f.history=n[0]),a[0]&1572864&&(f.messageId=n[41]),a[0]&524288&&(f.siblings=n[19][n[38]].messageIds),a[0]&524288&&(f.gotoMessage=l),a[0]&524288&&(f.showPreviousMessage=s),a[0]&524288&&(f.showNextMessage=r),a[0]&32&&(f.updateChat=n[5]),a[0]&64&&(f.editMessage=n[6]),a[0]&128&&(f.saveMessage=n[7]),a[0]&256&&(f.rateMessage=n[8]),a[0]&2048&&(f.deleteMessage=n[11]),a[0]&512&&(f.actionMessage=n[9]),a[0]&1024&&(f.submitMessage=n[10]),a[0]&4096&&(f.continueResponse=n[12]),a[0]&1581056&&(f.regenerateResponse=i),a[0]&16384&&(f.addMessages=n[14]),a[0]&16&&(f.readOnly=n[4]),e.$set(f)},i(o){t||(b(e.$$.fragment,o),t=!0)},o(o){D(e.$$.fragment,o),t=!1},d(o){le(e,o)}}}function js(n){let e,t,l=n[16]&&Hs(n);return{c(){l&&l.c(),e=he()},l(s){l&&l.l(s),e=he()},m(s,r){l&&l.m(s,r),V(s,e,r),t=!0},p(s,r){s[16]?l?(l.p(s,r),r[0]&65536&&b(l,1)):(l=Hs(s),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(se(),D(l,1,1,()=>{l=null}),ne())},i(s){t||(b(l),t=!0)},o(s){D(l),t=!1},d(s){s&&g(e),l&&l.d(s)}}}function zs(n){let e,t,l=n[20][n[38]]!==void 0&&n[19][n[38]].messageIds.length>0&&As(Ft(n));return{c(){l&&l.c(),e=he()},l(s){l&&l.l(s),e=he()},m(s,r){l&&l.m(s,r),V(s,e,r),t=!0},p(s,r){s[20][s[38]]!==void 0&&s[19][s[38]].messageIds.length>0?l?(l.p(Ft(s),r),r[0]&1572864&&b(l,1)):(l=As(Ft(s)),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(se(),D(l,1,1,()=>{l=null}),ne())},i(s){t||(b(l),t=!0)},o(s){D(l),t=!1},d(s){s&&g(e),l&&l.d(s)}}}function Us(n){let e=!Object.keys(n[19]).find(n[29]),t,l,s=e&&Ws(n);return{c(){s&&s.c(),t=he()},l(r){s&&s.l(r),t=he()},m(r,i){s&&s.m(r,i),V(r,t,i),l=!0},p(r,i){i[0]&1572865&&(e=!Object.keys(r[19]).find(r[29])),e?s?(s.p(r,i),i[0]&1572865&&b(s,1)):(s=Ws(r),s.c(),b(s,1),s.m(t.parentNode,t)):s&&(se(),D(s,1,1,()=>{s=null}),ne())},i(r){l||(b(s),l=!0)},o(r){D(s),l=!1},d(r){r&&g(t),s&&s.d(r)}}}function Ws(n){var o,a;let e,t,l,s,r=((a=(o=n[0].messages[n[2]])==null?void 0:o.merged)==null?void 0:a.status)&&qs(qt(n)),i=n[3]&&Js(n);return{c(){e=I("div"),t=I("div"),r&&r.c(),l=j(),i&&i.c(),this.h()},l(f){e=M(f,"DIV",{class:!0});var u=k(e);t=M(u,"DIV",{class:!0});var c=k(t);r&&r.l(c),c.forEach(g),l=z(u),i&&i.l(u),u.forEach(g),this.h()},h(){h(t,"class","w-full"),h(e,"class","flex justify-end")},m(f,u){V(f,e,u),p(e,t),r&&r.m(t,null),p(e,l),i&&i.m(e,null),s=!0},p(f,u){var c,m;(m=(c=f[0].messages[f[2]])==null?void 0:c.merged)!=null&&m.status?r?(r.p(qt(f),u),u[0]&5&&b(r,1)):(r=qs(qt(f)),r.c(),b(r,1),r.m(t,null)):r&&(se(),D(r,1,1,()=>{r=null}),ne()),f[3]?i?(i.p(f,u),u[0]&8&&b(i,1)):(i=Js(f),i.c(),b(i,1),i.m(e,null)):i&&(se(),D(i,1,1,()=>{i=null}),ne())},i(f){s||(b(r),b(i),s=!0)},o(f){D(r),D(i),s=!1},d(f){f&&g(e),r&&r.d(),i&&i.d()}}}function qs(n){let e,t,l,s,r,i,o;t=new Kt({props:{$$slots:{default:[Ma]},$$scope:{ctx:n}}});const a=[Na,Ea],f=[];function u(c,m){var d;return(((d=c[16])==null?void 0:d.content)??"")===""?0:1}return r=u(n),i=f[r]=a[r](n),{c(){e=I("div"),x(t.$$.fragment),l=j(),s=I("div"),i.c(),this.h()},l(c){e=M(c,"DIV",{class:!0});var m=k(e);ee(t.$$.fragment,m),l=z(m),s=M(m,"DIV",{class:!0});var d=k(s);i.l(d),d.forEach(g),m.forEach(g),this.h()},h(){h(s,"class","mt-1 markdown-prose w-full min-w-full"),h(e,"class","w-full rounded-xl pl-5 pr-2 py-2")},m(c,m){V(c,e,m),te(t,e,null),p(e,l),p(e,s),f[r].m(s,null),o=!0},p(c,m){const d={};m[0]&5|m[1]&2048&&(d.$$scope={dirty:m,ctx:c}),t.$set(d);let _=r;r=u(c),r===_?f[r].p(c,m):(se(),D(f[_],1,1,()=>{f[_]=null}),ne(),i=f[r],i?i.p(c,m):(i=f[r]=a[r](c),i.c()),b(i,1),i.m(s,null))},i(c){o||(b(t.$$.fragment,c),b(i),o=!0)},o(c){D(t.$$.fragment,c),D(i),o=!1},d(c){c&&g(e),le(t),f[r].d()}}}function Fs(n){let e,t=ot(n[16].timestamp*1e3).format("LT")+"",l;return{c(){e=I("span"),l=F(t),this.h()},l(s){e=M(s,"SPAN",{class:!0});var r=k(e);l=J(r,t),r.forEach(g),this.h()},h(){h(e,"class","self-center invisible group-hover:visible text-gray-400 text-xs font-medium uppercase ml-0.5 -mt-0.5")},m(s,r){V(s,e,r),p(e,l)},p(s,r){r[0]&5&&t!==(t=ot(s[16].timestamp*1e3).format("LT")+"")&&K(l,t)},d(s){s&&g(e)}}}function Ma(n){let e,t,l=n[16].timestamp&&Fs(n);return{c(){e=F(`Merged Response

									`),l&&l.c(),t=he()},l(s){e=J(s,`Merged Response

									`),l&&l.l(s),t=he()},m(s,r){V(s,e,r),l&&l.m(s,r),V(s,t,r)},p(s,r){s[16].timestamp?l?l.p(s,r):(l=Fs(s),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null)},d(s){s&&(g(e),g(t)),l&&l.d(s)}}}function Ea(n){let e,t;return e=new It({props:{id:"merged",content:n[16].content??""}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&5&&(r.content=l[16].content??""),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Na(n){let e,t;return e=new Xt({}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Js(n){let e,t,l;return t=new Se({props:{content:n[22].t("Merge Responses"),placement:"bottom",$$slots:{default:[Da]},$$scope:{ctx:n}}}),{c(){e=I("div"),x(t.$$.fragment),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=k(e);ee(t.$$.fragment,r),r.forEach(g),this.h()},h(){h(e,"class","shrink-0 text-gray-600 dark:text-gray-500 mt-1")},m(s,r){V(s,e,r),te(t,e,null),l=!0},p(s,r){const i={};r[0]&4194304&&(i.content=s[22].t("Merge Responses")),r[1]&2048&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&g(e),le(t)}}}function Da(n){let e,t,l,s,r;return t=new Ia({props:{className:" size-5 "}}),{c(){e=I("button"),x(t.$$.fragment),this.h()},l(i){e=M(i,"BUTTON",{type:!0,id:!0,class:!0});var o=k(e);ee(t.$$.fragment,o),o.forEach(g),this.h()},h(){h(e,"type","button"),h(e,"id","merge-response-button"),h(e,"class","visible p-1 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(i,o){V(i,e,o),te(t,e,null),l=!0,s||(r=ue(e,"click",n[35]),s=!0)},p:ve,i(i){l||(b(t.$$.fragment,i),l=!0)},o(i){D(t.$$.fragment,i),l=!1},d(i){i&&g(e),le(t),s=!1,r()}}}function Va(n){let e,t,l=n[18]&&Ps(n);return{c(){l&&l.c(),e=he()},l(s){l&&l.l(s),e=he()},m(s,r){l&&l.m(s,r),V(s,e,r),t=!0},p(s,r){s[18]?l?(l.p(s,r),r[0]&262144&&b(l,1)):(l=Ps(s),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(se(),D(l,1,1,()=>{l=null}),ne())},i(s){t||(b(l),t=!0)},o(s){D(l),t=!1},d(s){s&&g(e),l&&l.d(s)}}}function Ca(n,e,t){let l,s;Ee(n,Mn,q=>t(21,l=q));const r=Je("i18n");Ee(n,r,q=>t(22,s=q)),ot.extend(Dn);let{chatId:i}=e,{history:o}=e,{messageId:a}=e,{isLastMessage:f}=e,{readOnly:u=!1}=e,{updateChat:c}=e,{editMessage:m}=e,{saveMessage:d}=e,{rateMessage:_}=e,{actionMessage:w}=e,{submitMessage:y}=e,{deleteMessage:E}=e,{continueResponse:C}=e,{regenerateResponse:S}=e,{mergeResponses:L}=e,{addMessages:R}=e,{triggerScroll:v}=e;gt();let N,B,O={},T={},H=JSON.parse(JSON.stringify(o.messages[a]));const A=async(q,de)=>{t(20,T[q]=Math.max(0,Math.min(de,O[q].messageIds.length-1)),T);let fe=O[q].messageIds[T[q]];console.log(fe);let _e=o.messages[fe].childrenIds;for(;_e.length!==0;)fe=_e.at(-1),_e=o.messages[fe].childrenIds;t(0,o.currentId=fe,o),await De(),await c(),v()},X=async q=>{t(20,T[q]=Math.max(0,T[q]-1),T);let de=O[q].messageIds[T[q]];console.log(de);let fe=o.messages[de].childrenIds;for(;fe.length!==0;)de=fe.at(-1),fe=o.messages[de].childrenIds;t(0,o.currentId=de,o),await De(),await c(),v()},oe=async q=>{t(20,T[q]=Math.min(O[q].messageIds.length-1,T[q]+1),T);let de=O[q].messageIds[T[q]];console.log(de);let fe=o.messages[de].childrenIds;for(;fe.length!==0;)de=fe.at(-1),fe=o.messages[de].childrenIds;t(0,o.currentId=de,o),await De(),await c(),v()},ie=async()=>{console.log("multiresponse:initHandler"),await De(),t(17,N=a),t(18,B=o.messages[a].parentId?o.messages[o.messages[a].parentId]:null),t(19,O=B==null?void 0:B.models.reduce((q,de,fe)=>{let _e=B==null?void 0:B.childrenIds.map(be=>o.messages[be]).filter(be=>(be==null?void 0:be.modelIdx)===fe).map(be=>be.id);if(_e.length===0){let be=B==null?void 0:B.childrenIds.map(P=>o.messages[P]).filter(P=>(P==null?void 0:P.model)===de);be.forEach(P=>{P.modelIdx=fe}),_e=be.map(P=>P.id)}return{...q,[fe]:{messageIds:_e}}},{})),t(20,T=B==null?void 0:B.models.reduce((q,de,fe)=>{const _e=O[fe].messageIds.findIndex(be=>be===a);return _e!==-1?{...q,[fe]:_e}:{...q,[fe]:O[fe].messageIds.length-1}},{})),console.log(O,T),await De()},re=async()=>{const q=Object.keys(O).map(de=>{const{messageIds:fe}=O[de],_e=fe[T[de]];return o.messages[_e].content});L(a,q,i)};bt(async()=>{await ie(),await De();const q=document.getElementById(`message-${a}`);q&&q.scrollIntoView({block:"start"})});const ce=q=>{var _e;const{messageIds:de}=O[q],fe=de[T[q]];return!((_e=o.messages[fe])!=null&&_e.done)},me=(q,de,fe)=>A(q,fe),Ie=q=>X(q),W=q=>oe(q),G=async(q,de)=>{S(de),await De(),t(20,T[q]=O[q].messageIds.length-1,T)},ge=async q=>{if(a!=q){let de=q,fe=o.messages[de].childrenIds;for(;fe.length!==0;)de=fe.at(-1),fe=o.messages[de].childrenIds;t(0,o.currentId=de,o),await De(),await c(),v()}},pe=()=>{re()};return n.$$set=q=>{"chatId"in q&&t(1,i=q.chatId),"history"in q&&t(0,o=q.history),"messageId"in q&&t(2,a=q.messageId),"isLastMessage"in q&&t(3,f=q.isLastMessage),"readOnly"in q&&t(4,u=q.readOnly),"updateChat"in q&&t(5,c=q.updateChat),"editMessage"in q&&t(6,m=q.editMessage),"saveMessage"in q&&t(7,d=q.saveMessage),"rateMessage"in q&&t(8,_=q.rateMessage),"actionMessage"in q&&t(9,w=q.actionMessage),"submitMessage"in q&&t(10,y=q.submitMessage),"deleteMessage"in q&&t(11,E=q.deleteMessage),"continueResponse"in q&&t(12,C=q.continueResponse),"regenerateResponse"in q&&t(13,S=q.regenerateResponse),"mergeResponses"in q&&t(28,L=q.mergeResponses),"addMessages"in q&&t(14,R=q.addMessages),"triggerScroll"in q&&t(15,v=q.triggerScroll)},n.$$.update=()=>{n.$$.dirty[0]&65541&&o.messages&&JSON.stringify(H)!==JSON.stringify(o.messages[a])&&t(16,H=JSON.parse(JSON.stringify(o.messages[a])))},[o,i,a,f,u,c,m,d,_,w,y,E,C,S,R,v,H,N,B,O,T,l,s,r,A,X,oe,re,L,ce,me,Ie,W,G,ge,pe]}class Ta extends Re{constructor(e){super(),Le(this,e,Ca,Va,Be,{chatId:1,history:0,messageId:2,isLastMessage:3,readOnly:4,updateChat:5,editMessage:6,saveMessage:7,rateMessage:8,actionMessage:9,submitMessage:10,deleteMessage:11,continueResponse:12,regenerateResponse:13,mergeResponses:28,addMessages:14,triggerScroll:15},null,[-1,-1])}}function Gs(n,e,t){const l=n.slice();return l[49]=e[t],l}function Zs(n){var s,r,i,o;let e,t,l;return t=new Vn({props:{src:n[7].user?((i=(r=(s=n[15].find(n[29]))==null?void 0:s.info)==null?void 0:r.meta)==null?void 0:i.profile_image_url)??"/user.png":((o=n[0])==null?void 0:o.profile_image_url)??"/user.png",className:"size-8"}}),{c(){e=I("div"),x(t.$$.fragment),this.h()},l(a){e=M(a,"DIV",{class:!0});var f=k(e);ee(t.$$.fragment,f),f.forEach(g),this.h()},h(){h(e,"class","shrink-0 ltr:mr-3 rtl:ml-3")},m(a,f){V(a,e,f),te(t,e,null),l=!0},p(a,f){var c,m,d,_;const u={};f[0]&32897&&(u.src=a[7].user?((d=(m=(c=a[15].find(a[29]))==null?void 0:c.info)==null?void 0:m.meta)==null?void 0:d.profile_image_url)??"/user.png":((_=a[0])==null?void 0:_.profile_image_url)??"/user.png"),t.$set(u)},i(a){l||(b(t.$$.fragment,a),l=!0)},o(a){D(t.$$.fragment,a),l=!1},d(a){a&&g(e),le(t)}}}function Ks(n){let e,t,l;return t=new Kt({props:{$$slots:{default:[La]},$$scope:{ctx:n}}}),{c(){e=I("div"),x(t.$$.fragment)},l(s){e=M(s,"DIV",{});var r=k(e);ee(t.$$.fragment,r),r.forEach(g)},m(s,r){V(s,e,r),te(t,e,null),l=!0},p(s,r){const i={};r[0]&90241|r[1]&2097152&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&g(e),le(t)}}}function Ba(n){let e=n[13].t("You")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&8192&&e!==(e=l[13].t("You")+"")&&K(t,e)},d(l){l&&g(t)}}}function Sa(n){let e=n[0].name+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&1&&e!==(e=l[0].name+"")&&K(t,e)},d(l){l&&g(t)}}}function Oa(n){var o;let e=n[13].t("You")+"",t,l,s,r=(((o=n[7])==null?void 0:o.user)??"")+"",i;return{c(){t=F(e),l=j(),s=I("span"),i=F(r),this.h()},l(a){t=J(a,e),l=z(a),s=M(a,"SPAN",{class:!0});var f=k(s);i=J(f,r),f.forEach(g),this.h()},h(){h(s,"class","text-gray-500 text-sm font-medium")},m(a,f){V(a,t,f),V(a,l,f),V(a,s,f),p(s,i)},p(a,f){var u;f[0]&8192&&e!==(e=a[13].t("You")+"")&&K(t,e),f[0]&128&&r!==(r=(((u=a[7])==null?void 0:u.user)??"")+"")&&K(i,r)},d(a){a&&(g(t),g(l),g(s))}}}function Qs(n){let e,t,l;return t=new Se({props:{content:ot(n[7].timestamp*1e3).format("LLLL"),$$slots:{default:[Ra]},$$scope:{ctx:n}}}),{c(){e=I("div"),x(t.$$.fragment),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=k(e);ee(t.$$.fragment,r),r.forEach(g),this.h()},h(){h(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,r){V(s,e,r),te(t,e,null),l=!0},p(s,r){const i={};r[0]&128&&(i.content=ot(s[7].timestamp*1e3).format("LLLL")),r[0]&128|r[1]&2097152&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&g(e),le(t)}}}function Ra(n){let e,t=Ht(n[7].timestamp*1e3)+"",l;return{c(){e=I("span"),l=F(t),this.h()},l(s){e=M(s,"SPAN",{class:!0});var r=k(e);l=J(r,t),r.forEach(g),this.h()},h(){h(e,"class","line-clamp-1")},m(s,r){V(s,e,r),p(e,l)},p(s,r){r[0]&128&&t!==(t=Ht(s[7].timestamp*1e3)+"")&&K(l,t)},d(s){s&&g(e)}}}function La(n){let e,t,l;function s(a,f){return a[7].user?Oa:a[14].showUsername||a[16].name!==a[0].name?Sa:Ba}let r=s(n),i=r(n),o=n[7].timestamp&&Qs(n);return{c(){i.c(),e=j(),o&&o.c(),t=he()},l(a){i.l(a),e=z(a),o&&o.l(a),t=he()},m(a,f){i.m(a,f),V(a,e,f),o&&o.m(a,f),V(a,t,f),l=!0},p(a,f){r===(r=s(a))&&i?i.p(a,f):(i.d(1),i=r(a),i&&(i.c(),i.m(e.parentNode,e))),a[7].timestamp?o?(o.p(a,f),f[0]&128&&b(o,1)):(o=Qs(a),o.c(),b(o,1),o.m(t.parentNode,t)):o&&(se(),D(o,1,1,()=>{o=null}),ne())},i(a){l||(b(o),l=!0)},o(a){D(o),l=!1},d(a){a&&(g(e),g(t)),i.d(a),o&&o.d(a)}}}function Xs(n){let e,t,l=Ve(n[7].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=Ys(Gs(n,l,i));const r=i=>D(s[i],1,1,()=>{s[i]=null});return{c(){e=I("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=M(i,"DIV",{class:!0});var o=k(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(g),this.h()},h(){h(e,"class","mt-2.5 mb-1 w-full flex flex-col justify-end overflow-x-auto gap-1 flex-wrap")},m(i,o){V(i,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(i,o){if(o[0]&16512){l=Ve(i[7].files);let a;for(a=0;a<l.length;a+=1){const f=Gs(i,l,a);s[a]?(s[a].p(f,o),b(s[a],1)):(s[a]=Ys(f),s[a].c(),b(s[a],1),s[a].m(e,null))}for(se(),a=l.length;a<s.length;a+=1)r(a);ne()}},i(i){if(!t){for(let o=0;o<l.length;o+=1)b(s[o]);t=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)D(s[o]);t=!1},d(i){i&&g(e),Fe(s,i)}}}function Pa(n){var l;let e,t;return e=new Ln({props:{item:n[49],url:n[49].url,name:n[49].name,type:n[49].type,size:(l=n[49])==null?void 0:l.size,colorClassName:"bg-white dark:bg-gray-850 "}}),{c(){x(e.$$.fragment)},l(s){ee(e.$$.fragment,s)},m(s,r){te(e,s,r),t=!0},p(s,r){var o;const i={};r[0]&128&&(i.item=s[49]),r[0]&128&&(i.url=s[49].url),r[0]&128&&(i.name=s[49].name),r[0]&128&&(i.type=s[49].type),r[0]&128&&(i.size=(o=s[49])==null?void 0:o.size),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){le(e,s)}}}function Aa(n){let e,t;return e=new Tn({props:{src:n[49].url,imageClassName:" max-h-96 rounded-lg"}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&128&&(r.src=l[49].url),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Ys(n){let e,t,l,s,r,i;const o=[Aa,Pa],a=[];function f(u,c){return u[49].type==="image"?0:1}return t=f(n),l=a[t]=o[t](n),{c(){e=I("div"),l.c(),s=j(),this.h()},l(u){e=M(u,"DIV",{class:!0});var c=k(e);l.l(c),s=z(c),c.forEach(g),this.h()},h(){var u;h(e,"class",r=((u=n[14])==null?void 0:u.chatBubble)??!0?"self-end":"")},m(u,c){V(u,e,c),a[t].m(e,null),p(e,s),i=!0},p(u,c){var d;let m=t;t=f(u),t===m?a[t].p(u,c):(se(),D(a[m],1,1,()=>{a[m]=null}),ne(),l=a[t],l?l.p(u,c):(l=a[t]=o[t](u),l.c()),b(l,1),l.m(e,s)),(!i||c[0]&16384&&r!==(r=((d=u[14])==null?void 0:d.chatBubble)??!0?"self-end":""))&&h(e,"class",r)},i(u){i||(b(l),i=!0)},o(u){D(l),i=!1},d(u){u&&g(e),a[t].d()}}}function $s(n){let e,t,l,s;const r=[ja,Ha],i=[];function o(a,f){return a[10]===!0?0:1}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=he()},l(a){t.l(a),l=he()},m(a,f){i[e].m(a,f),V(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(se(),D(i[u],1,1,()=>{i[u]=null}),ne(),t=i[e],t?t.p(a,f):(t=i[e]=r[e](a),t.c()),b(t,1),t.m(l.parentNode,l))},i(a){s||(b(t),s=!0)},o(a){D(t),s=!1},d(a){a&&g(l),i[e].d(a)}}}function Ha(n){var L,R;let e,t,l,s,r,i,o,a,f,u,c,m,d,_,w=n[7].content&&xs(n),y=!(((L=n[14])==null?void 0:L.chatBubble)??!0)&&en(n),E=!n[6]&&ln(n);u=new Se({props:{content:n[13].t("Copy"),placement:"bottom",$$slots:{default:[qa]},$$scope:{ctx:n}}});let C=!n[6]&&(!n[5]||n[1].length>1)&&sn(n),S=(((R=n[14])==null?void 0:R.chatBubble)??!0)&&nn(n);return{c(){e=I("div"),t=I("div"),l=I("div"),w&&w.c(),i=j(),o=I("div"),y&&y.c(),a=j(),E&&E.c(),f=j(),x(u.$$.fragment),c=j(),C&&C.c(),m=j(),S&&S.c(),this.h()},l(v){e=M(v,"DIV",{class:!0});var N=k(e);t=M(N,"DIV",{class:!0});var B=k(t);l=M(B,"DIV",{class:!0});var O=k(l);w&&w.l(O),O.forEach(g),B.forEach(g),i=z(N),o=M(N,"DIV",{class:!0});var T=k(o);y&&y.l(T),a=z(T),E&&E.l(T),f=z(T),ee(u.$$.fragment,T),c=z(T),C&&C.l(T),m=z(T),S&&S.l(T),T.forEach(g),N.forEach(g),this.h()},h(){var v,N,B;h(l,"class",s="rounded-3xl "+(((v=n[14])==null?void 0:v.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${n[7].files?"rounded-tr-lg":""}`:" w-full")),h(t,"class",r="flex "+(((N=n[14])==null?void 0:N.chatBubble)??!0?"justify-end pb-1":"w-full")),h(o,"class",d="flex "+(((B=n[14])==null?void 0:B.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"),h(e,"class","w-full")},m(v,N){V(v,e,N),p(e,t),p(t,l),w&&w.m(l,null),p(e,i),p(e,o),y&&y.m(o,null),p(o,a),E&&E.m(o,null),p(o,f),te(u,o,null),p(o,c),C&&C.m(o,null),p(o,m),S&&S.m(o,null),_=!0},p(v,N){var O,T,H,A,X;v[7].content?w?(w.p(v,N),N[0]&128&&b(w,1)):(w=xs(v),w.c(),b(w,1),w.m(l,null)):w&&(se(),D(w,1,1,()=>{w=null}),ne()),(!_||N[0]&16512&&s!==(s="rounded-3xl "+(((O=v[14])==null?void 0:O.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${v[7].files?"rounded-tr-lg":""}`:" w-full")))&&h(l,"class",s),(!_||N[0]&16384&&r!==(r="flex "+(((T=v[14])==null?void 0:T.chatBubble)??!0?"justify-end pb-1":"w-full")))&&h(t,"class",r),((H=v[14])==null?void 0:H.chatBubble)??!0?y&&(y.d(1),y=null):y?y.p(v,N):(y=en(v),y.c(),y.m(o,a)),v[6]?E&&(se(),D(E,1,1,()=>{E=null}),ne()):E?(E.p(v,N),N[0]&64&&b(E,1)):(E=ln(v),E.c(),b(E,1),E.m(o,f));const B={};N[0]&8192&&(B.content=v[13].t("Copy")),N[0]&128|N[1]&2097152&&(B.$$scope={dirty:N,ctx:v}),u.$set(B),!v[6]&&(!v[5]||v[1].length>1)?C?(C.p(v,N),N[0]&98&&b(C,1)):(C=sn(v),C.c(),b(C,1),C.m(o,m)):C&&(se(),D(C,1,1,()=>{C=null}),ne()),((A=v[14])==null?void 0:A.chatBubble)??!0?S?S.p(v,N):(S=nn(v),S.c(),S.m(o,null)):S&&(S.d(1),S=null),(!_||N[0]&16384&&d!==(d="flex "+(((X=v[14])==null?void 0:X.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"))&&h(o,"class",d)},i(v){_||(b(w),b(E),b(u.$$.fragment,v),b(C),_=!0)},o(v){D(w),D(E),D(u.$$.fragment,v),D(C),_=!1},d(v){v&&g(e),w&&w.d(),y&&y.d(),E&&E.d(),le(u),C&&C.d(),S&&S.d()}}}function ja(n){let e,t,l,s,r,i,o,a,f=n[13].t("Save")+"",u,c,m,d,_=n[13].t("Cancel")+"",w,y,E,C=n[13].t("Send")+"",S,L,R;return{c(){e=I("div"),t=I("div"),l=I("textarea"),r=j(),i=I("div"),o=I("div"),a=I("button"),u=F(f),c=j(),m=I("div"),d=I("button"),w=F(_),y=j(),E=I("button"),S=F(C),this.h()},l(v){e=M(v,"DIV",{class:!0});var N=k(e);t=M(N,"DIV",{class:!0});var B=k(t);l=M(B,"TEXTAREA",{id:!0,class:!0}),k(l).forEach(g),B.forEach(g),r=z(N),i=M(N,"DIV",{class:!0});var O=k(i);o=M(O,"DIV",{});var T=k(o);a=M(T,"BUTTON",{id:!0,class:!0});var H=k(a);u=J(H,f),H.forEach(g),T.forEach(g),c=z(O),m=M(O,"DIV",{class:!0});var A=k(m);d=M(A,"BUTTON",{id:!0,class:!0});var X=k(d);w=J(X,_),X.forEach(g),y=z(A),E=M(A,"BUTTON",{id:!0,class:!0});var oe=k(E);S=J(oe,C),oe.forEach(g),A.forEach(g),O.forEach(g),N.forEach(g),this.h()},h(){h(l,"id",s="message-edit-"+n[7].id),h(l,"class","bg-transparent outline-hidden w-full resize-none"),h(t,"class","max-h-96 overflow-auto"),h(a,"id","save-edit-message-button"),h(a,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border border-gray-100 dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),h(d,"id","close-edit-message-button"),h(d,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),h(E,"id","confirm-edit-message-button"),h(E,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),h(m,"class","flex space-x-1.5"),h(i,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),h(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 mb-2")},m(v,N){V(v,e,N),p(e,t),p(t,l),n[30](l),it(l,n[11]),p(e,r),p(e,i),p(i,o),p(o,a),p(a,u),p(i,c),p(i,m),p(m,d),p(d,w),p(m,y),p(m,E),p(E,S),L||(R=[ue(l,"input",n[31]),ue(l,"input",Ka),ue(l,"keydown",n[32]),ue(a,"click",n[33]),ue(d,"click",n[34]),ue(E,"click",n[35])],L=!0)},p(v,N){N[0]&128&&s!==(s="message-edit-"+v[7].id)&&h(l,"id",s),N[0]&2048&&it(l,v[11]),N[0]&8192&&f!==(f=v[13].t("Save")+"")&&K(u,f),N[0]&8192&&_!==(_=v[13].t("Cancel")+"")&&K(w,_),N[0]&8192&&C!==(C=v[13].t("Send")+"")&&K(S,C)},i:ve,o:ve,d(v){v&&g(e),n[30](null),L=!1,Xe(R)}}}function xs(n){let e,t;return e=new It({props:{id:n[7].id,content:n[7].content}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&128&&(r.id=l[7].id),s[0]&128&&(r.content=l[7].content),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function en(n){let e,t=n[1].length>1&&tn(n);return{c(){t&&t.c(),e=he()},l(l){t&&t.l(l),e=he()},m(l,s){t&&t.m(l,s),V(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=tn(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&g(e),t&&t.d(l)}}}function tn(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i,o='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',a,f;function u(d,_){return d[9]?Ua:za}let c=u(n),m=c(n);return{c(){e=I("div"),t=I("button"),t.innerHTML=l,s=j(),m.c(),r=j(),i=I("button"),i.innerHTML=o,this.h()},l(d){e=M(d,"DIV",{class:!0,dir:!0});var _=k(e);t=M(_,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(t)!=="svelte-buado9"&&(t.innerHTML=l),s=z(_),m.l(_),r=z(_),i=M(_,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(i)!=="svelte-4phel2"&&(i.innerHTML=o),_.forEach(g),this.h()},h(){h(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(i,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(e,"class","flex self-center"),h(e,"dir","ltr")},m(d,_){V(d,e,_),p(e,t),p(e,s),m.m(e,null),p(e,r),p(e,i),a||(f=[ue(t,"click",n[36]),ue(i,"click",n[40])],a=!0)},p(d,_){c===(c=u(d))&&m?m.p(d,_):(m.d(1),m=c(d),m&&(m.c(),m.m(e,r)))},d(d){d&&g(e),m.d(),a=!1,Xe(f)}}}function za(n){let e,t=n[1].indexOf(n[7].id)+1+"",l,s,r=n[1].length+"",i,o,a;return{c(){e=I("div"),l=F(t),s=F("/"),i=F(r),this.h()},l(f){e=M(f,"DIV",{class:!0});var u=k(e);l=J(u,t),s=J(u,"/"),i=J(u,r),u.forEach(g),this.h()},h(){h(e,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit")},m(f,u){V(f,e,u),p(e,l),p(e,s),p(e,i),o||(a=ue(e,"dblclick",n[39]),o=!0)},p(f,u){u[0]&130&&t!==(t=f[1].indexOf(f[7].id)+1+"")&&K(l,t),u[0]&2&&r!==(r=f[1].length+"")&&K(i,r)},d(f){f&&g(e),o=!1,a()}}}function Ua(n){let e,t,l,s,r,i,o=n[1].length+"",a,f,u;return{c(){e=I("div"),t=I("input"),i=F("/"),a=F(o),this.h()},l(c){e=M(c,"DIV",{class:!0});var m=k(e);t=M(m,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),i=J(m,"/"),a=J(m,o),m.forEach(g),this.h()},h(){h(t,"id",l="message-index-input-"+n[7].id),h(t,"type","number"),t.value=s=n[1].indexOf(n[7].id)+1,h(t,"min","1"),h(t,"max",r=n[1].length),h(t,"class","bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"),h(e,"class","text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit")},m(c,m){V(c,e,m),p(e,t),p(e,i),p(e,a),f||(u=[ue(t,"focus",Qa),ue(t,"blur",n[37]),ue(t,"keydown",n[38])],f=!0)},p(c,m){m[0]&128&&l!==(l="message-index-input-"+c[7].id)&&h(t,"id",l),m[0]&130&&s!==(s=c[1].indexOf(c[7].id)+1)&&t.value!==s&&(t.value=s),m[0]&2&&r!==(r=c[1].length)&&h(t,"max",r),m[0]&2&&o!==(o=c[1].length+"")&&K(a,o)},d(c){c&&g(e),f=!1,Xe(u)}}}function ln(n){let e,t;return e=new Se({props:{content:n[13].t("Edit"),placement:"bottom",$$slots:{default:[Wa]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&8192&&(r.content=l[13].t("Edit")),s[1]&2097152&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Wa(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"></path></svg>',l,s;return{c(){e=I("button"),e.innerHTML=t,this.h()},l(r){e=M(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(e)!=="svelte-tlrz1q"&&(e.innerHTML=t),this.h()},h(){h(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition edit-user-message-button")},m(r,i){V(r,e,i),l||(s=ue(e,"click",n[41]),l=!0)},p:ve,d(r){r&&g(e),l=!1,s()}}}function qa(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"></path></svg>',l,s;return{c(){e=I("button"),e.innerHTML=t,this.h()},l(r){e=M(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(e)!=="svelte-1ivgdx2"&&(e.innerHTML=t),this.h()},h(){h(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(r,i){V(r,e,i),l||(s=ue(e,"click",n[42]),l=!0)},p:ve,d(r){r&&g(e),l=!1,s()}}}function sn(n){let e,t;return e=new Se({props:{content:n[13].t("Delete"),placement:"bottom",$$slots:{default:[Fa]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&8192&&(r.content=l[13].t("Delete")),s[0]&256|s[1]&2097152&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Fa(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"></path></svg>',l,s;return{c(){e=I("button"),e.innerHTML=t,this.h()},l(r){e=M(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(e)!=="svelte-146x2zz"&&(e.innerHTML=t),this.h()},h(){h(e,"class","invisible group-hover:visible p-1 rounded-sm dark:hover:text-white hover:text-black transition")},m(r,i){V(r,e,i),l||(s=ue(e,"click",n[43]),l=!0)},p:ve,d(r){r&&g(e),l=!1,s()}}}function nn(n){let e,t=n[1].length>1&&rn(n);return{c(){t&&t.c(),e=he()},l(l){t&&t.l(l),e=he()},m(l,s){t&&t.m(l,s),V(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=rn(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&g(e),t&&t.d(l)}}}function rn(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i,o='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',a,f;function u(d,_){return d[9]?Ga:Ja}let c=u(n),m=c(n);return{c(){e=I("div"),t=I("button"),t.innerHTML=l,s=j(),m.c(),r=j(),i=I("button"),i.innerHTML=o,this.h()},l(d){e=M(d,"DIV",{class:!0,dir:!0});var _=k(e);t=M(_,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(t)!=="svelte-buado9"&&(t.innerHTML=l),s=z(_),m.l(_),r=z(_),i=M(_,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(i)!=="svelte-4phel2"&&(i.innerHTML=o),_.forEach(g),this.h()},h(){h(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(i,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(e,"class","flex self-center"),h(e,"dir","ltr")},m(d,_){V(d,e,_),p(e,t),p(e,s),m.m(e,null),p(e,r),p(e,i),a||(f=[ue(t,"click",n[44]),ue(i,"click",n[48])],a=!0)},p(d,_){c===(c=u(d))&&m?m.p(d,_):(m.d(1),m=c(d),m&&(m.c(),m.m(e,r)))},d(d){d&&g(e),m.d(),a=!1,Xe(f)}}}function Ja(n){let e,t=n[1].indexOf(n[7].id)+1+"",l,s,r=n[1].length+"",i,o,a;return{c(){e=I("div"),l=F(t),s=F("/"),i=F(r),this.h()},l(f){e=M(f,"DIV",{class:!0});var u=k(e);l=J(u,t),s=J(u,"/"),i=J(u,r),u.forEach(g),this.h()},h(){h(e,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit")},m(f,u){V(f,e,u),p(e,l),p(e,s),p(e,i),o||(a=ue(e,"dblclick",n[47]),o=!0)},p(f,u){u[0]&130&&t!==(t=f[1].indexOf(f[7].id)+1+"")&&K(l,t),u[0]&2&&r!==(r=f[1].length+"")&&K(i,r)},d(f){f&&g(e),o=!1,a()}}}function Ga(n){let e,t,l,s,r,i,o=n[1].length+"",a,f,u;return{c(){e=I("div"),t=I("input"),i=F("/"),a=F(o),this.h()},l(c){e=M(c,"DIV",{class:!0});var m=k(e);t=M(m,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),i=J(m,"/"),a=J(m,o),m.forEach(g),this.h()},h(){h(t,"id",l="message-index-input-"+n[7].id),h(t,"type","number"),t.value=s=n[1].indexOf(n[7].id)+1,h(t,"min","1"),h(t,"max",r=n[1].length),h(t,"class","bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"),h(e,"class","text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit")},m(c,m){V(c,e,m),p(e,t),p(e,i),p(e,a),f||(u=[ue(t,"focus",Xa),ue(t,"blur",n[45]),ue(t,"keydown",n[46])],f=!0)},p(c,m){m[0]&128&&l!==(l="message-index-input-"+c[7].id)&&h(t,"id",l),m[0]&130&&s!==(s=c[1].indexOf(c[7].id)+1)&&t.value!==s&&(t.value=s),m[0]&2&&r!==(r=c[1].length)&&h(t,"max",r),m[0]&2&&o!==(o=c[1].length+"")&&K(a,o)},d(c){c&&g(e),f=!1,Xe(u)}}}function Za(n){var L,R;let e,t,l,s,r,i,o,a,f,u,c,m,d;function _(v){n[27](v)}let w={title:n[13].t("Delete message?")};n[8]!==void 0&&(w.show=n[8]),e=new On({props:w}),je.push(()=>Qe(e,"show",_)),e.$on("confirm",n[28]);let y=!(((L=n[14])==null?void 0:L.chatBubble)??!0)&&Zs(n),E=!(((R=n[14])==null?void 0:R.chatBubble)??!0)&&Ks(n),C=n[7].files&&Xs(n),S=n[7].content!==""&&$s(n);return{c(){x(e.$$.fragment),l=j(),s=I("div"),y&&y.c(),r=j(),i=I("div"),E&&E.c(),o=j(),a=I("div"),C&&C.c(),f=j(),S&&S.c(),this.h()},l(v){ee(e.$$.fragment,v),l=z(v),s=M(v,"DIV",{class:!0,dir:!0,id:!0});var N=k(s);y&&y.l(N),r=z(N),i=M(N,"DIV",{class:!0});var B=k(i);E&&E.l(B),o=z(B),a=M(B,"DIV",{class:!0});var O=k(a);C&&C.l(O),f=z(O),S&&S.l(O),O.forEach(g),B.forEach(g),N.forEach(g),this.h()},h(){h(a,"class",u="chat-"+n[7].role+" w-full min-w-full markdown-prose"),h(i,"class","flex-auto w-0 max-w-full pl-1"),h(s,"class","flex w-full user-message"),h(s,"dir",c=n[14].chatDirection),h(s,"id",m="message-"+n[7].id)},m(v,N){te(e,v,N),V(v,l,N),V(v,s,N),y&&y.m(s,null),p(s,r),p(s,i),E&&E.m(i,null),p(i,o),p(i,a),C&&C.m(a,null),p(a,f),S&&S.m(a,null),d=!0},p(v,N){var O,T;const B={};N[0]&8192&&(B.title=v[13].t("Delete message?")),!t&&N[0]&256&&(t=!0,B.show=v[8],Ke(()=>t=!1)),e.$set(B),((O=v[14])==null?void 0:O.chatBubble)??!0?y&&(se(),D(y,1,1,()=>{y=null}),ne()):y?(y.p(v,N),N[0]&16384&&b(y,1)):(y=Zs(v),y.c(),b(y,1),y.m(s,r)),((T=v[14])==null?void 0:T.chatBubble)??!0?E&&(se(),D(E,1,1,()=>{E=null}),ne()):E?(E.p(v,N),N[0]&16384&&b(E,1)):(E=Ks(v),E.c(),b(E,1),E.m(i,o)),v[7].files?C?(C.p(v,N),N[0]&128&&b(C,1)):(C=Xs(v),C.c(),b(C,1),C.m(a,f)):C&&(se(),D(C,1,1,()=>{C=null}),ne()),v[7].content!==""?S?(S.p(v,N),N[0]&128&&b(S,1)):(S=$s(v),S.c(),b(S,1),S.m(a,null)):S&&(se(),D(S,1,1,()=>{S=null}),ne()),(!d||N[0]&128&&u!==(u="chat-"+v[7].role+" w-full min-w-full markdown-prose"))&&h(a,"class",u),(!d||N[0]&16384&&c!==(c=v[14].chatDirection))&&h(s,"dir",c),(!d||N[0]&128&&m!==(m="message-"+v[7].id))&&h(s,"id",m)},i(v){d||(b(e.$$.fragment,v),b(y),b(E),b(C),b(S),d=!0)},o(v){D(e.$$.fragment,v),D(y),D(E),D(C),D(S),d=!1},d(v){v&&(g(l),g(s)),le(e,v),y&&y.d(),E&&E.d(),C&&C.d(),S&&S.d()}}}const Ka=n=>{n.target.style.height="",n.target.style.height=`${n.target.scrollHeight}px`},Qa=n=>{n.target.select()},Xa=n=>{n.target.select()};function Ya(n,e,t){let l,s,r,i;Ee(n,yt,Y=>t(14,s=Y)),Ee(n,jt,Y=>t(15,r=Y)),Ee(n,zt,Y=>t(16,i=Y));const o=Je("i18n");Ee(n,o,Y=>t(13,l=Y)),ot.extend(Dn);let{user:a}=e,{history:f}=e,{messageId:u}=e,{siblings:c}=e,{gotoMessage:m}=e,{showPreviousMessage:d}=e,{showNextMessage:_}=e,{editMessage:w}=e,{deleteMessage:y}=e,{isFirstMessage:E}=e,{readOnly:C}=e,S=!1,L=!1,R=!1,v="",N,B=JSON.parse(JSON.stringify(f.messages[u]));const O=async Y=>{await Nn(Y)&&Ae.success(l.t("Copying to clipboard was successful!"))},T=async()=>{t(10,R=!0),t(11,v=B.content),await De(),t(12,N.style.height="",N),t(12,N.style.height=`${N.scrollHeight}px`,N),N==null||N.focus()},H=async(Y=!0)=>{w(B.id,v,Y),t(10,R=!1),t(11,v="")},A=()=>{t(10,R=!1),t(11,v="")},X=async()=>{y(B.id)};bt(()=>{});function oe(Y){S=Y,t(8,S)}const ie=()=>{X()},re=Y=>Y.id===B.user;function ce(Y){je[Y?"unshift":"push"](()=>{N=Y,t(12,N)})}function me(){v=this.value,t(11,v)}const Ie=Y=>{var ze,qe;Y.key==="Escape"&&((ze=document.getElementById("close-edit-message-button"))==null||ze.click());const Pe=Y.metaKey||Y.ctrlKey,He=Y.key==="Enter";Pe&&He&&((qe=document.getElementById("confirm-edit-message-button"))==null||qe.click())},W=()=>{H(!1)},G=()=>{A()},ge=()=>{H()},pe=()=>{d(B)},q=Y=>{m(B,Y.target.value-1),t(9,L=!1)},de=Y=>{Y.key==="Enter"&&(m(B,Y.target.value-1),t(9,L=!1))},fe=async()=>{t(9,L=!0),await De();const Y=document.getElementById(`message-index-input-${B.id}`);Y&&(Y.focus(),Y.select())},_e=()=>{_(B)},be=()=>{T()},P=()=>{O(B.content)},Q=()=>{t(8,S=!0)},$=()=>{d(B)},Z=Y=>{m(B,Y.target.value-1),t(9,L=!1)},ae=Y=>{Y.key==="Enter"&&(m(B,Y.target.value-1),t(9,L=!1))},ke=async()=>{t(9,L=!0),await De();const Y=document.getElementById(`message-index-input-${B.id}`);Y&&(Y.focus(),Y.select())},Ce=()=>{_(B)};return n.$$set=Y=>{"user"in Y&&t(0,a=Y.user),"history"in Y&&t(23,f=Y.history),"messageId"in Y&&t(24,u=Y.messageId),"siblings"in Y&&t(1,c=Y.siblings),"gotoMessage"in Y&&t(2,m=Y.gotoMessage),"showPreviousMessage"in Y&&t(3,d=Y.showPreviousMessage),"showNextMessage"in Y&&t(4,_=Y.showNextMessage),"editMessage"in Y&&t(25,w=Y.editMessage),"deleteMessage"in Y&&t(26,y=Y.deleteMessage),"isFirstMessage"in Y&&t(5,E=Y.isFirstMessage),"readOnly"in Y&&t(6,C=Y.readOnly)},n.$$.update=()=>{n.$$.dirty[0]&25165952&&f.messages&&JSON.stringify(B)!==JSON.stringify(f.messages[u])&&t(7,B=JSON.parse(JSON.stringify(f.messages[u])))},[a,c,m,d,_,E,C,B,S,L,R,v,N,l,s,r,i,o,O,T,H,A,X,f,u,w,y,oe,ie,re,ce,me,Ie,W,G,ge,pe,q,de,fe,_e,be,P,Q,$,Z,ae,ke,Ce]}class $a extends Re{constructor(e){super(),Le(this,e,Ya,Za,Be,{user:0,history:23,messageId:24,siblings:1,gotoMessage:2,showPreviousMessage:3,showNextMessage:4,editMessage:25,deleteMessage:26,isFirstMessage:5,readOnly:6},null,[-1,-1])}}function on(n){let e,t,l,s;const r=[tf,ef,xa],i=[];function o(a,f){var u,c;return a[0].messages[a[3]].role==="user"?0:(((c=(u=a[0].messages[a[0].messages[a[3]].parentId])==null?void 0:u.models)==null?void 0:c.length)??1)===1?1:2}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=he()},l(a){t.l(a),l=he()},m(a,f){i[e].m(a,f),V(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(se(),D(i[u],1,1,()=>{i[u]=null}),ne(),t=i[e],t?t.p(a,f):(t=i[e]=r[e](a),t.c()),b(t,1),t.m(l.parentNode,l))},i(a){s||(b(t),s=!0)},o(a){D(t),s=!1},d(a){a&&g(l),i[e].d(a)}}}function xa(n){var i;let e,t,l;function s(o){n[22](o)}let r={chatId:n[1],messageId:n[3],isLastMessage:n[3]===((i=n[0])==null?void 0:i.currentId),updateChat:n[8],editMessage:n[9],saveMessage:n[10],rateMessage:n[12],actionMessage:n[13],submitMessage:n[14],deleteMessage:n[11],continueResponse:n[16],regenerateResponse:n[15],mergeResponses:n[17],triggerScroll:n[19],addMessages:n[18],readOnly:n[20]};return n[0]!==void 0&&(r.history=n[0]),e=new Ta({props:r}),je.push(()=>Qe(e,"history",s)),{c(){x(e.$$.fragment)},l(o){ee(e.$$.fragment,o)},m(o,a){te(e,o,a),l=!0},p(o,a){var u;const f={};a&2&&(f.chatId=o[1]),a&8&&(f.messageId=o[3]),a&9&&(f.isLastMessage=o[3]===((u=o[0])==null?void 0:u.currentId)),a&256&&(f.updateChat=o[8]),a&512&&(f.editMessage=o[9]),a&1024&&(f.saveMessage=o[10]),a&4096&&(f.rateMessage=o[12]),a&8192&&(f.actionMessage=o[13]),a&16384&&(f.submitMessage=o[14]),a&2048&&(f.deleteMessage=o[11]),a&65536&&(f.continueResponse=o[16]),a&32768&&(f.regenerateResponse=o[15]),a&131072&&(f.mergeResponses=o[17]),a&524288&&(f.triggerScroll=o[19]),a&262144&&(f.addMessages=o[18]),a&1048576&&(f.readOnly=o[20]),!t&&a&1&&(t=!0,f.history=o[0],Ke(()=>t=!1)),e.$set(f)},i(o){l||(b(e.$$.fragment,o),l=!0)},o(o){D(e.$$.fragment,o),l=!1},d(o){le(e,o)}}}function ef(n){var l;let e,t;return e=new Pn({props:{chatId:n[1],history:n[0],messageId:n[3],isLastMessage:n[3]===n[0].currentId,siblings:((l=n[0].messages[n[0].messages[n[3]].parentId])==null?void 0:l.childrenIds)??[],gotoMessage:n[5],showPreviousMessage:n[6],showNextMessage:n[7],updateChat:n[8],editMessage:n[9],saveMessage:n[10],rateMessage:n[12],actionMessage:n[13],submitMessage:n[14],deleteMessage:n[11],continueResponse:n[16],regenerateResponse:n[15],addMessages:n[18],readOnly:n[20]}}),{c(){x(e.$$.fragment)},l(s){ee(e.$$.fragment,s)},m(s,r){te(e,s,r),t=!0},p(s,r){var o;const i={};r&2&&(i.chatId=s[1]),r&1&&(i.history=s[0]),r&8&&(i.messageId=s[3]),r&9&&(i.isLastMessage=s[3]===s[0].currentId),r&9&&(i.siblings=((o=s[0].messages[s[0].messages[s[3]].parentId])==null?void 0:o.childrenIds)??[]),r&32&&(i.gotoMessage=s[5]),r&64&&(i.showPreviousMessage=s[6]),r&128&&(i.showNextMessage=s[7]),r&256&&(i.updateChat=s[8]),r&512&&(i.editMessage=s[9]),r&1024&&(i.saveMessage=s[10]),r&4096&&(i.rateMessage=s[12]),r&8192&&(i.actionMessage=s[13]),r&16384&&(i.submitMessage=s[14]),r&2048&&(i.deleteMessage=s[11]),r&65536&&(i.continueResponse=s[16]),r&32768&&(i.regenerateResponse=s[15]),r&262144&&(i.addMessages=s[18]),r&1048576&&(i.readOnly=s[20]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){le(e,s)}}}function tf(n){var l;let e,t;return e=new $a({props:{user:n[4],history:n[0],messageId:n[3],isFirstMessage:n[2]===0,siblings:n[0].messages[n[3]].parentId!==null?((l=n[0].messages[n[0].messages[n[3]].parentId])==null?void 0:l.childrenIds)??[]:Object.values(n[0].messages).filter(an).map(fn)??[],gotoMessage:n[5],showPreviousMessage:n[6],showNextMessage:n[7],editMessage:n[9],deleteMessage:n[11],readOnly:n[20]}}),{c(){x(e.$$.fragment)},l(s){ee(e.$$.fragment,s)},m(s,r){te(e,s,r),t=!0},p(s,r){var o;const i={};r&16&&(i.user=s[4]),r&1&&(i.history=s[0]),r&8&&(i.messageId=s[3]),r&4&&(i.isFirstMessage=s[2]===0),r&9&&(i.siblings=s[0].messages[s[3]].parentId!==null?((o=s[0].messages[s[0].messages[s[3]].parentId])==null?void 0:o.childrenIds)??[]:Object.values(s[0].messages).filter(an).map(fn)??[]),r&32&&(i.gotoMessage=s[5]),r&64&&(i.showPreviousMessage=s[6]),r&128&&(i.showNextMessage=s[7]),r&512&&(i.editMessage=s[9]),r&2048&&(i.deleteMessage=s[11]),r&1048576&&(i.readOnly=s[20]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){le(e,s)}}}function lf(n){let e,t,l,s=n[0].messages[n[3]]&&on(n);return{c(){e=I("div"),s&&s.c(),this.h()},l(r){e=M(r,"DIV",{class:!0});var i=k(e);s&&s.l(i),i.forEach(g),this.h()},h(){var r;h(e,"class",t="flex flex-col justify-between px-5 mb-3 w-full "+(((r=n[21])==null?void 0:r.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group")},m(r,i){V(r,e,i),s&&s.m(e,null),l=!0},p(r,[i]){var o;r[0].messages[r[3]]?s?(s.p(r,i),i&9&&b(s,1)):(s=on(r),s.c(),b(s,1),s.m(e,null)):s&&(se(),D(s,1,1,()=>{s=null}),ne()),(!l||i&2097152&&t!==(t="flex flex-col justify-between px-5 mb-3 w-full "+(((o=r[21])==null?void 0:o.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group"))&&h(e,"class",t)},i(r){l||(b(s),l=!0)},o(r){D(s),l=!1},d(r){r&&g(e),s&&s.d()}}}const an=n=>n.parentId===null,fn=n=>n.id;function sf(n,e,t){let l;Ee(n,yt,T=>t(21,l=T)),gt(),Je("i18n");let{chatId:s}=e,{idx:r=0}=e,{history:i}=e,{messageId:o}=e,{user:a}=e,{gotoMessage:f}=e,{showPreviousMessage:u}=e,{showNextMessage:c}=e,{updateChat:m}=e,{editMessage:d}=e,{saveMessage:_}=e,{deleteMessage:w}=e,{rateMessage:y}=e,{actionMessage:E}=e,{submitMessage:C}=e,{regenerateResponse:S}=e,{continueResponse:L}=e,{mergeResponses:R}=e,{addMessages:v}=e,{triggerScroll:N}=e,{readOnly:B=!1}=e;function O(T){i=T,t(0,i)}return n.$$set=T=>{"chatId"in T&&t(1,s=T.chatId),"idx"in T&&t(2,r=T.idx),"history"in T&&t(0,i=T.history),"messageId"in T&&t(3,o=T.messageId),"user"in T&&t(4,a=T.user),"gotoMessage"in T&&t(5,f=T.gotoMessage),"showPreviousMessage"in T&&t(6,u=T.showPreviousMessage),"showNextMessage"in T&&t(7,c=T.showNextMessage),"updateChat"in T&&t(8,m=T.updateChat),"editMessage"in T&&t(9,d=T.editMessage),"saveMessage"in T&&t(10,_=T.saveMessage),"deleteMessage"in T&&t(11,w=T.deleteMessage),"rateMessage"in T&&t(12,y=T.rateMessage),"actionMessage"in T&&t(13,E=T.actionMessage),"submitMessage"in T&&t(14,C=T.submitMessage),"regenerateResponse"in T&&t(15,S=T.regenerateResponse),"continueResponse"in T&&t(16,L=T.continueResponse),"mergeResponses"in T&&t(17,R=T.mergeResponses),"addMessages"in T&&t(18,v=T.addMessages),"triggerScroll"in T&&t(19,N=T.triggerScroll),"readOnly"in T&&t(20,B=T.readOnly)},[i,s,r,o,a,f,u,c,m,d,_,w,y,E,C,S,L,R,v,N,B,l,O]}class nf extends Re{constructor(e){super(),Le(this,e,sf,lf,Be,{chatId:1,idx:2,history:0,messageId:3,user:4,gotoMessage:5,showPreviousMessage:6,showNextMessage:7,updateChat:8,editMessage:9,saveMessage:10,deleteMessage:11,rateMessage:12,actionMessage:13,submitMessage:14,regenerateResponse:15,continueResponse:16,mergeResponses:17,addMessages:18,triggerScroll:19,readOnly:20})}}function un(n,e,t){const l=n.slice();return l[13]=e[t],l[15]=t,l}function rf(n){let e,t,l,s;return{c(){e=I("div"),t=F(n[3]),l=F(" ‧ v"),s=F(dl),this.h()},l(r){e=M(r,"DIV",{class:!0});var i=k(e);t=J(i,n[3]),l=J(i," ‧ v"),s=J(i,dl),i.forEach(g),this.h()},h(){h(e,"class","flex w-full text-center items-center justify-center self-start text-gray-400 dark:text-gray-600")},m(r,i){V(r,e,i),p(e,t),p(e,l),p(e,s)},p(r,i){i&8&&K(t,r[3])},i:ve,o:ve,d(r){r&&g(e)}}}function of(n){let e,t,l=n[2].t("Suggested")+"",s,r;return e=new Rr({}),{c(){x(e.$$.fragment),t=j(),s=F(l)},l(i){ee(e.$$.fragment,i),t=z(i),s=J(i,l)},m(i,o){te(e,i,o),V(i,t,o),V(i,s,o),r=!0},p(i,o){(!r||o&4)&&l!==(l=i[2].t("Suggested")+"")&&K(s,l)},i(i){r||(b(e.$$.fragment,i),r=!0)},o(i){D(e.$$.fragment,i),r=!1},d(i){i&&(g(t),g(s)),le(e,i)}}}function cn(n){let e=[],t=new Map,l,s=Ve(n[1]);const r=i=>i[13].id||i[13].content;for(let i=0;i<s.length;i+=1){let o=un(n,s,i),a=r(o);t.set(a,e[i]=dn(a,o))}return{c(){for(let i=0;i<e.length;i+=1)e[i].c();l=he()},l(i){for(let o=0;o<e.length;o+=1)e[o].l(i);l=he()},m(i,o){for(let a=0;a<e.length;a+=1)e[a]&&e[a].m(i,o);V(i,l,o)},p(i,o){o&38&&(s=Ve(i[1]),e=Gt(e,o,r,1,i,s,t,l.parentNode,_r,dn,l,un))},d(i){i&&g(l);for(let o=0;o<e.length;o+=1)e[o].d(i)}}}function af(n){let e,t=n[13].content+"",l,s,r,i=n[2].t("Prompt")+"",o;return{c(){e=I("div"),l=F(t),s=j(),r=I("div"),o=F(i),this.h()},l(a){e=M(a,"DIV",{class:!0});var f=k(e);l=J(f,t),f.forEach(g),s=z(a),r=M(a,"DIV",{class:!0});var u=k(r);o=J(u,i),u.forEach(g),this.h()},h(){h(e,"class","font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1"),h(r,"class","text-xs text-gray-500 font-normal line-clamp-1")},m(a,f){V(a,e,f),p(e,l),V(a,s,f),V(a,r,f),p(r,o)},p(a,f){f&2&&t!==(t=a[13].content+"")&&K(l,t),f&4&&i!==(i=a[2].t("Prompt")+"")&&K(o,i)},d(a){a&&(g(e),g(s),g(r))}}}function ff(n){let e,t=n[13].title[0]+"",l,s,r,i=n[13].title[1]+"",o;return{c(){e=I("div"),l=F(t),s=j(),r=I("div"),o=F(i),this.h()},l(a){e=M(a,"DIV",{class:!0});var f=k(e);l=J(f,t),f.forEach(g),s=z(a),r=M(a,"DIV",{class:!0});var u=k(r);o=J(u,i),u.forEach(g),this.h()},h(){h(e,"class","font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1"),h(r,"class","text-xs text-gray-500 font-normal line-clamp-1")},m(a,f){V(a,e,f),p(e,l),V(a,s,f),V(a,r,f),p(r,o)},p(a,f){f&2&&t!==(t=a[13].title[0]+"")&&K(l,t),f&2&&i!==(i=a[13].title[1]+"")&&K(o,i)},d(a){a&&(g(e),g(s),g(r))}}}function dn(n,e){let t,l,s,r,i;function o(c,m){return c[13].title&&c[13].title[0]!==""?ff:af}let a=o(e),f=a(e);function u(){return e[9](e[13])}return{key:n,first:null,c(){t=I("button"),l=I("div"),f.c(),s=j(),this.h()},l(c){t=M(c,"BUTTON",{class:!0,style:!0});var m=k(t);l=M(m,"DIV",{class:!0});var d=k(l);f.l(d),d.forEach(g),s=z(m),m.forEach(g),this.h()},h(){h(l,"class","flex flex-col text-left"),h(t,"class","waterfall flex flex-col flex-1 shrink-0 w-full justify-between px-3 py-2 rounded-xl bg-transparent hover:bg-black/5 dark:hover:bg-white/5 transition group svelte-1co34if"),Rt(t,"animation-delay",e[15]*60+"ms"),this.first=t},m(c,m){V(c,t,m),p(t,l),f.m(l,null),p(t,s),r||(i=ue(t,"click",u),r=!0)},p(c,m){e=c,a===(a=o(e))&&f?f.p(e,m):(f.d(1),f=a(e),f&&(f.c(),f.m(l,null))),m&2&&Rt(t,"animation-delay",e[15]*60+"ms")},d(c){c&&g(t),f.d(),r=!1,i()}}}function uf(n){let e,t,l,s,r,i,o;const a=[of,rf],f=[];function u(m,d){return m[1].length>0?0:1}t=u(n),l=f[t]=a[t](n);let c=n[1].length>0&&cn(n);return{c(){e=I("div"),l.c(),s=j(),r=I("div"),c&&c.c(),this.h()},l(m){e=M(m,"DIV",{class:!0});var d=k(e);l.l(d),d.forEach(g),s=z(m),r=M(m,"DIV",{class:!0});var _=k(r);c&&c.l(_),_.forEach(g),this.h()},h(){h(e,"class","mb-1 flex gap-1 text-xs font-medium items-center text-gray-400 dark:text-gray-600"),h(r,"class",i="h-40 overflow-auto scrollbar-none "+n[0]+" items-start svelte-1co34if")},m(m,d){V(m,e,d),f[t].m(e,null),V(m,s,d),V(m,r,d),c&&c.m(r,null),o=!0},p(m,[d]){let _=t;t=u(m),t===_?f[t].p(m,d):(se(),D(f[_],1,1,()=>{f[_]=null}),ne(),l=f[t],l?l.p(m,d):(l=f[t]=a[t](m),l.c()),b(l,1),l.m(e,null)),m[1].length>0?c?c.p(m,d):(c=cn(m),c.c(),c.m(r,null)):c&&(c.d(1),c=null),(!o||d&1&&i!==(i="h-40 overflow-auto scrollbar-none "+m[0]+" items-start svelte-1co34if"))&&h(r,"class",i)},i(m){o||(b(l),o=!0)},o(m){D(l),o=!1},d(m){m&&(g(e),g(s),g(r)),f[t].d(),c&&c.d()}}}function cf(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if((n[t].id??n[t].content)!==(e[t].id??e[t].content))return!1;return!0}function df(n,e,t){let l,s;Ee(n,kr,y=>t(3,s=y));const r=Je("i18n");Ee(n,r,y=>t(2,l=y));const i=gt();let{suggestionPrompts:o=[]}=e,{className:a=""}=e,{inputValue:f=""}=e,u=[];const c={keys:["content","title"],threshold:.5};let m,d=[];const _=y=>{if(y.length>500)t(1,d=[]);else{const E=y.trim()&&m?m.search(y.trim()).map(C=>C.item):u;cf(d,E)||t(1,d=E)}},w=y=>i("select",y.content);return n.$$set=y=>{"suggestionPrompts"in y&&t(6,o=y.suggestionPrompts),"className"in y&&t(0,a=y.className),"inputValue"in y&&t(7,f=y.inputValue)},n.$$.update=()=>{n.$$.dirty&192&&o&&(t(8,u=[...o??[]].sort(()=>Math.random()-.5)),_(f)),n.$$.dirty&256&&(m=new Wr(u,c)),n.$$.dirty&128&&_(f)},[a,d,l,s,r,i,o,f,u,w]}class hf extends Re{constructor(e){super(),Le(this,e,df,uf,Be,{suggestionPrompts:6,className:0,inputValue:7})}}function hn(n,e,t){const l=n.slice();return l[14]=e[t],l[16]=t,l}function mf(n){let e,t;return{c(){e=I("img"),this.h()},l(l){e=M(l,"IMG",{crossorigin:!0,src:!0,class:!0,alt:!0,draggable:!0}),this.h()},h(){var l,s,r;h(e,"crossorigin","anonymous"),Lt(e.src,t=((r=(s=(l=n[14])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:r.profile_image_url)??(n[5].language==="dg-DG"?"/doge.png":`${Pt}/static/favicon.png`))||h(e,"src",t),h(e,"class","size-[2.7rem] rounded-full border-[1px] border-gray-100 dark:border-none"),h(e,"alt","logo"),h(e,"draggable","false")},m(l,s){V(l,e,s)},p(l,s){var r,i,o;s&33&&!Lt(e.src,t=((o=(i=(r=l[14])==null?void 0:r.info)==null?void 0:i.meta)==null?void 0:o.profile_image_url)??(l[5].language==="dg-DG"?"/doge.png":`${Pt}/static/favicon.png`))&&h(e,"src",t)},d(l){l&&g(e)}}}function mn(n){var a,f,u;let e,t,l,s,r,i;t=new Se({props:{content:At.parse(vt(((u=(f=(a=n[0][n[4]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.description)??"")),placement:"right",$$slots:{default:[mf]},$$scope:{ctx:n}}});function o(){return n[12](n[16])}return{c(){e=I("button"),x(t.$$.fragment),l=j()},l(c){e=M(c,"BUTTON",{});var m=k(e);ee(t.$$.fragment,m),l=z(m),m.forEach(g)},m(c,m){V(c,e,m),te(t,e,null),p(e,l),s=!0,r||(i=ue(e,"click",o),r=!0)},p(c,m){var _,w,y;n=c;const d={};m&17&&(d.content=At.parse(vt(((y=(w=(_=n[0][n[4]])==null?void 0:_.info)==null?void 0:w.meta)==null?void 0:y.description)??""))),m&131105&&(d.$$scope={dirty:m,ctx:n}),t.$set(d)},i(c){s||(b(t.$$.fragment,c),s=!0)},o(c){D(t.$$.fragment,c),s=!1},d(c){c&&g(e),le(t),r=!1,i()}}}function gn(n){let e,t;return e=new Se({props:{content:n[5].t("This chat won’t appear in history and your messages will not be saved."),className:"w-full flex justify-center mb-0.5",placement:"top",$$slots:{default:[gf]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s&32&&(r.content=l[5].t("This chat won’t appear in history and your messages will not be saved.")),s&131104&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function gf(n){let e,t,l=n[5].t("Temporary Chat")+"",s,r;return t=new Br({props:{strokeWidth:"2.5",className:"size-5"}}),{c(){e=I("div"),x(t.$$.fragment),s=F(l),this.h()},l(i){e=M(i,"DIV",{class:!0});var o=k(e);ee(t.$$.fragment,o),s=J(o,l),o.forEach(g),this.h()},h(){h(e,"class","flex items-center gap-2 text-gray-500 font-medium text-lg my-2 w-fit")},m(i,o){V(i,e,o),te(t,e,null),p(e,s),r=!0},p(i,o){(!r||o&32)&&l!==(l=i[5].t("Temporary Chat")+"")&&K(s,l)},i(i){r||(b(t.$$.fragment,i),r=!0)},o(i){D(t.$$.fragment,i),r=!1},d(i){i&&g(e),le(t)}}}function _f(n){var l;let e=n[5].t("Hello, {{name}}",{name:(l=n[7])==null?void 0:l.name})+"",t;return{c(){t=F(e)},l(s){t=J(s,e)},m(s,r){V(s,t,r)},p(s,r){var i;r&160&&e!==(e=s[5].t("Hello, {{name}}",{name:(i=s[7])==null?void 0:i.name})+"")&&K(t,e)},d(s){s&&g(t)}}}function pf(n){var l;let e=((l=n[0][n[4]])==null?void 0:l.name)+"",t;return{c(){t=F(e)},l(s){t=J(s,e)},m(s,r){V(s,t,r)},p(s,r){var i;r&17&&e!==(e=((i=s[0][s[4]])==null?void 0:i.name)+"")&&K(t,e)},d(s){s&&g(t)}}}function vf(n){let e,t=n[5].t("How can I help you today?")+"",l;return{c(){e=I("div"),l=F(t),this.h()},l(s){e=M(s,"DIV",{class:!0});var r=k(e);l=J(r,t),r.forEach(g),this.h()},h(){h(e,"class","font-medium text-gray-400 dark:text-gray-500 line-clamp-1 font-p")},m(s,r){V(s,e,r),p(e,l)},p(s,r){r&32&&t!==(t=s[5].t("How can I help you today?")+"")&&K(l,t)},d(s){s&&g(e)}}}function bf(n){var o,a,f,u,c,m;let e,t,l=At.parse(vt((f=(a=(o=n[0][n[4]])==null?void 0:o.info)==null?void 0:a.meta)==null?void 0:f.description))+"",s,r,i=((m=(c=(u=n[0][n[4]])==null?void 0:u.info)==null?void 0:c.meta)==null?void 0:m.user)&&_n(n);return{c(){e=I("div"),t=new mr(!1),s=j(),i&&i.c(),r=he(),this.h()},l(d){e=M(d,"DIV",{class:!0});var _=k(e);t=gr(_,!1),_.forEach(g),s=z(d),i&&i.l(d),r=he(),this.h()},h(){t.a=null,h(e,"class","mt-0.5 text-base font-normal text-gray-500 dark:text-gray-400 line-clamp-3 markdown")},m(d,_){V(d,e,_),t.m(l,e),V(d,s,_),i&&i.m(d,_),V(d,r,_)},p(d,_){var w,y,E,C,S,L;_&17&&l!==(l=At.parse(vt((E=(y=(w=d[0][d[4]])==null?void 0:w.info)==null?void 0:y.meta)==null?void 0:E.description))+"")&&t.p(l),(L=(S=(C=d[0][d[4]])==null?void 0:C.info)==null?void 0:S.meta)!=null&&L.user?i?i.p(d,_):(i=_n(d),i.c(),i.m(r.parentNode,r)):i&&(i.d(1),i=null)},d(d){d&&(g(e),g(s),g(r)),i&&i.d(d)}}}function _n(n){let e,t;function l(i,o){var a,f,u;return(u=(f=(a=i[0][i[4]])==null?void 0:a.info)==null?void 0:f.meta)!=null&&u.user.community?wf:kf}let s=l(n),r=s(n);return{c(){e=I("div"),t=F(`By
								`),r.c(),this.h()},l(i){e=M(i,"DIV",{class:!0});var o=k(e);t=J(o,`By
								`),r.l(o),o.forEach(g),this.h()},h(){h(e,"class","mt-0.5 text-sm font-normal text-gray-400 dark:text-gray-500")},m(i,o){V(i,e,o),p(e,t),r.m(e,null)},p(i,o){s===(s=l(i))&&r?r.p(i,o):(r.d(1),r=s(i),r&&(r.c(),r.m(e,null)))},d(i){i&&g(e),r.d()}}}function kf(n){var l,s,r;let e=((r=(s=(l=n[0][n[4]])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:r.user.name)+"",t;return{c(){t=F(e)},l(i){t=J(i,e)},m(i,o){V(i,t,o)},p(i,o){var a,f,u;o&17&&e!==(e=((u=(f=(a=i[0][i[4]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.user.name)+"")&&K(t,e)},d(i){i&&g(t)}}}function wf(n){var r,i,o,a,f,u,c,m,d;let e,t=((o=(i=(r=n[0][n[4]])==null?void 0:r.info)==null?void 0:i.meta)!=null&&o.user.name?(u=(f=(a=n[0][n[4]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.user.name:`@${(d=(m=(c=n[0][n[4]])==null?void 0:c.info)==null?void 0:m.meta)==null?void 0:d.user.username}`)+"",l,s;return{c(){e=I("a"),l=F(t),this.h()},l(_){e=M(_,"A",{href:!0});var w=k(e);l=J(w,t),w.forEach(g),this.h()},h(){var _,w,y;h(e,"href",s="https://openwebui.com/m/"+((y=(w=(_=n[0][n[4]])==null?void 0:_.info)==null?void 0:w.meta)==null?void 0:y.user.username))},m(_,w){V(_,e,w),p(e,l)},p(_,w){var y,E,C,S,L,R,v,N,B,O,T,H;w&17&&t!==(t=((C=(E=(y=_[0][_[4]])==null?void 0:y.info)==null?void 0:E.meta)!=null&&C.user.name?(R=(L=(S=_[0][_[4]])==null?void 0:S.info)==null?void 0:L.meta)==null?void 0:R.user.name:`@${(B=(N=(v=_[0][_[4]])==null?void 0:v.info)==null?void 0:N.meta)==null?void 0:B.user.username}`)+"")&&K(l,t),w&17&&s!==(s="https://openwebui.com/m/"+((H=(T=(O=_[0][_[4]])==null?void 0:O.info)==null?void 0:T.meta)==null?void 0:H.user.username))&&h(e,"href",s)},d(_){_&&g(e)}}}function pn(n){var X,oe,ie,re,ce,me,Ie;let e,t,l,s,r,i,o,a,f,u,c,m,d,_,w,y,E,C,S=Ve(n[0]),L=[];for(let W=0;W<S.length;W+=1)L[W]=mn(hn(n,S,W));const R=W=>D(L[W],1,1,()=>{L[W]=null});let v=n[6]&&gn(n);function N(W,G){var ge;return(ge=W[0][W[4]])!=null&&ge.name?pf:_f}let B=N(n),O=B(n);function T(W,G){var ge,pe,q;return((q=(pe=(ge=W[0][W[4]])==null?void 0:ge.info)==null?void 0:pe.meta)==null?void 0:q.description)??null?bf:vf}let H=T(n),A=H(n);return y=new hf({props:{className:"grid grid-cols-2",suggestionPrompts:((ie=(oe=(X=n[1])==null?void 0:X.info)==null?void 0:oe.meta)==null?void 0:ie.suggestion_prompts)??((me=(ce=(re=n[0][n[4]])==null?void 0:re.info)==null?void 0:ce.meta)==null?void 0:me.suggestion_prompts)??((Ie=n[8])==null?void 0:Ie.default_prompt_suggestions)??[]}}),y.$on("select",n[13]),{c(){e=I("div"),t=I("div"),l=I("div");for(let W=0;W<L.length;W+=1)L[W].c();r=j(),v&&v.c(),i=j(),o=I("div"),a=I("div"),f=I("div"),O.c(),c=j(),m=I("div"),A.c(),_=j(),w=I("div"),x(y.$$.fragment),this.h()},l(W){e=M(W,"DIV",{class:!0});var G=k(e);t=M(G,"DIV",{class:!0});var ge=k(t);l=M(ge,"DIV",{class:!0});var pe=k(l);for(let P=0;P<L.length;P+=1)L[P].l(pe);pe.forEach(g),ge.forEach(g),r=z(G),v&&v.l(G),i=z(G),o=M(G,"DIV",{class:!0});var q=k(o);a=M(q,"DIV",{});var de=k(a);f=M(de,"DIV",{class:!0});var fe=k(f);O.l(fe),fe.forEach(g),c=z(de),m=M(de,"DIV",{});var _e=k(m);A.l(_e),_e.forEach(g),de.forEach(g),q.forEach(g),_=z(G),w=M(G,"DIV",{class:!0});var be=k(w);ee(y.$$.fragment,be),be.forEach(g),G.forEach(g),this.h()},h(){h(l,"class","flex -space-x-4 mb-0.5"),h(t,"class","flex justify-start"),h(f,"class","capitalize line-clamp-1"),h(o,"class","mt-2 mb-4 text-3xl text-gray-800 dark:text-gray-100 font-medium text-left flex items-center gap-4 font-primary"),h(w,"class","w-full font-primary"),h(e,"class","m-auto w-full max-w-6xl px-8 lg:px-20")},m(W,G){V(W,e,G),p(e,t),p(t,l);for(let ge=0;ge<L.length;ge+=1)L[ge]&&L[ge].m(l,null);p(e,r),v&&v.m(e,null),p(e,i),p(e,o),p(o,a),p(a,f),O.m(f,null),p(a,c),p(a,m),A.m(m,null),p(e,_),p(e,w),te(y,w,null),C=!0},p(W,G){var pe,q,de,fe,_e,be,P;if(G&49){S=Ve(W[0]);let Q;for(Q=0;Q<S.length;Q+=1){const $=hn(W,S,Q);L[Q]?(L[Q].p($,G),b(L[Q],1)):(L[Q]=mn($),L[Q].c(),b(L[Q],1),L[Q].m(l,null))}for(se(),Q=S.length;Q<L.length;Q+=1)R(Q);ne()}W[6]?v?(v.p(W,G),G&64&&b(v,1)):(v=gn(W),v.c(),b(v,1),v.m(e,i)):v&&(se(),D(v,1,1,()=>{v=null}),ne()),B===(B=N(W))&&O?O.p(W,G):(O.d(1),O=B(W),O&&(O.c(),O.m(f,null))),H===(H=T(W))&&A?A.p(W,G):(A.d(1),A=H(W),A&&(A.c(),A.m(m,null)));const ge={};G&275&&(ge.suggestionPrompts=((de=(q=(pe=W[1])==null?void 0:pe.info)==null?void 0:q.meta)==null?void 0:de.suggestion_prompts)??((be=(_e=(fe=W[0][W[4]])==null?void 0:fe.info)==null?void 0:_e.meta)==null?void 0:be.suggestion_prompts)??((P=W[8])==null?void 0:P.default_prompt_suggestions)??[]),y.$set(ge)},i(W){if(!C){for(let G=0;G<S.length;G+=1)b(L[G]);W&&(s||Bt(()=>{s=St(l,Ot,{duration:200}),s.start()})),b(v),W&&(u||Bt(()=>{u=St(f,Ot,{duration:200}),u.start()})),W&&(d||Bt(()=>{d=St(m,Ot,{duration:200,delay:200}),d.start()})),b(y.$$.fragment,W),W&&(E||Bt(()=>{E=St(w,Ot,{duration:200,delay:300}),E.start()})),C=!0}},o(W){L=L.filter(Boolean);for(let G=0;G<L.length;G+=1)D(L[G]);D(v),D(y.$$.fragment,W),C=!1},d(W){W&&g(e),Fe(L,W),v&&v.d(),O.d(),A.d(),le(y)}}}function yf(n){let e=n[3],t,l,s=pn(n);return{c(){s.c(),t=he()},l(r){s.l(r),t=he()},m(r,i){s.m(r,i),V(r,t,i),l=!0},p(r,[i]){i&8&&Be(e,e=r[3])?(se(),D(s,1,1,ve),ne(),s=pn(r),s.c(),b(s,1),s.m(t.parentNode,t)):s.p(r,i)},i(r){l||(b(s),l=!0)},o(r){D(s),l=!1},d(r){r&&g(t),s.d(r)}}}function If(n,e,t){let l,s,r,i,o;Ee(n,jt,E=>t(11,l=E)),Ee(n,Zt,E=>t(6,r=E)),Ee(n,zt,E=>t(7,i=E)),Ee(n,En,E=>t(8,o=E));const a=Je("i18n");Ee(n,a,E=>t(5,s=E));let{modelIds:f=[]}=e,{models:u=[]}=e,{atSelectedModel:c}=e,{submitPrompt:m}=e,d=!1,_=0;bt(()=>{t(3,d=!0)});const w=E=>{t(4,_=E)},y=E=>{m(E.detail)};return n.$$set=E=>{"modelIds"in E&&t(10,f=E.modelIds),"models"in E&&t(0,u=E.models),"atSelectedModel"in E&&t(1,c=E.atSelectedModel),"submitPrompt"in E&&t(2,m=E.submitPrompt)},n.$$.update=()=>{n.$$.dirty&3072&&t(0,u=f.map(E=>l.find(C=>C.id===E))),n.$$.dirty&1025&&f.length>0&&t(4,_=u.length-1)},[u,c,m,d,_,s,r,i,o,a,f,l,w,y]}class Mf extends Re{constructor(e){super(),Le(this,e,If,yf,Be,{modelIds:10,models:0,atSelectedModel:1,submitPrompt:2})}}function vn(n,e,t){const l=n.slice();return l[43]=e[t],l[45]=t,l}function Ef(n){let e,t=n[3],l,s=yn(n);return{c(){e=I("div"),s.c(),this.h()},l(r){e=M(r,"DIV",{class:!0});var i=k(e);s.l(i),i.forEach(g),this.h()},h(){h(e,"class","w-full pt-2")},m(r,i){V(r,e,i),s.m(e,null),l=!0},p(r,i){i[0]&8&&Be(t,t=r[3])?(se(),D(s,1,1,ve),ne(),s=yn(r),s.c(),b(s,1),s.m(e,null)):s.p(r,i)},i(r){l||(b(s),l=!0)},o(r){D(s),l=!1},d(r){r&&g(e),s.d(r)}}}function Nf(n){let e,t;return e=new Mf({props:{modelIds:n[5],atSelectedModel:n[6],submitPrompt:n[34]}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[0]&32&&(r.modelIds=l[5]),s[0]&64&&(r.atSelectedModel=l[6]),s[0]&65538&&(r.submitPrompt=l[34]),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function bn(n){let e,t;return e=new Ur({props:{$$slots:{default:[Df]},$$scope:{ctx:n}}}),e.$on("visible",n[35]),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,s){te(e,l,s),t=!0},p(l,s){const r={};s[1]&32768&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){le(e,l)}}}function Df(n){let e,t,l,s,r="Loading...",i;return t=new Ut({props:{className:" size-4"}}),{c(){e=I("div"),x(t.$$.fragment),l=j(),s=I("div"),s.textContent=r,this.h()},l(o){e=M(o,"DIV",{class:!0});var a=k(e);ee(t.$$.fragment,a),l=z(a),s=M(a,"DIV",{class:!0,"data-svelte-h":!0}),Ue(s)!=="svelte-17uns3n"&&(s.textContent=r),a.forEach(g),this.h()},h(){h(s,"class",""),h(e,"class","w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2")},m(o,a){V(o,e,a),te(t,e,null),p(e,l),p(e,s),i=!0},p:ve,i(o){i||(b(t.$$.fragment,o),i=!0)},o(o){D(t.$$.fragment,o),i=!1},d(o){o&&g(e),le(t)}}}function kn(n,e){let t,l,s,r;function i(a){e[36](a)}let o={chatId:e[3],messageId:e[43].id,idx:e[45],user:e[4],gotoMessage:e[20],showPreviousMessage:e[21],showNextMessage:e[22],updateChat:e[19],editMessage:e[24],deleteMessage:e[27],rateMessage:e[23],actionMessage:e[25],saveMessage:e[26],submitMessage:e[10],regenerateResponse:e[8],continueResponse:e[7],mergeResponses:e[9],addMessages:e[11],triggerScroll:e[28],readOnly:e[12]};return e[0]!==void 0&&(o.history=e[0]),l=new nf({props:o}),je.push(()=>Qe(l,"history",i)),{key:n,first:null,c(){t=he(),x(l.$$.fragment),this.h()},l(a){t=he(),ee(l.$$.fragment,a),this.h()},h(){this.first=t},m(a,f){V(a,t,f),te(l,a,f),r=!0},p(a,f){e=a;const u={};f[0]&8&&(u.chatId=e[3]),f[0]&16384&&(u.messageId=e[43].id),f[0]&16384&&(u.idx=e[45]),f[0]&16&&(u.user=e[4]),f[0]&1024&&(u.submitMessage=e[10]),f[0]&256&&(u.regenerateResponse=e[8]),f[0]&128&&(u.continueResponse=e[7]),f[0]&512&&(u.mergeResponses=e[9]),f[0]&2048&&(u.addMessages=e[11]),f[0]&4096&&(u.readOnly=e[12]),!s&&f[0]&1&&(s=!0,u.history=e[0],Ke(()=>s=!1)),l.$set(u)},i(a){r||(b(l.$$.fragment,a),r=!0)},o(a){D(l.$$.fragment,a),r=!1},d(a){a&&g(t),le(l,a)}}}function wn(n){let e;return{c(){e=I("div"),this.h()},l(t){e=M(t,"DIV",{class:!0}),k(e).forEach(g),this.h()},h(){h(e,"class","pb-6")},m(t,l){V(t,e,l)},d(t){t&&g(e)}}}function yn(n){var w;let e,t=((w=n[14].at(0))==null?void 0:w.parentId)!==null,l,s=[],r=new Map,i,o,a,f,u,c=t&&bn(n),m=Ve(n[14]);const d=y=>y[43].id;for(let y=0;y<m.length;y+=1){let E=vn(n,m,y),C=d(E);r.set(C,s[y]=kn(C,E))}let _=n[13]&&wn();return{c(){e=I("div"),c&&c.c(),l=j();for(let y=0;y<s.length;y+=1)s[y].c();i=j(),o=I("div"),a=j(),_&&_.c(),f=he(),this.h()},l(y){e=M(y,"DIV",{class:!0});var E=k(e);c&&c.l(E),l=z(E);for(let C=0;C<s.length;C+=1)s[C].l(E);E.forEach(g),i=z(y),o=M(y,"DIV",{class:!0}),k(o).forEach(g),a=z(y),_&&_.l(y),f=he(),this.h()},h(){h(e,"class","w-full"),h(o,"class","pb-12")},m(y,E){V(y,e,E),c&&c.m(e,null),p(e,l);for(let C=0;C<s.length;C+=1)s[C]&&s[C].m(e,null);V(y,i,E),V(y,o,E),V(y,a,E),_&&_.m(y,E),V(y,f,E),u=!0},p(y,E){var C;E[0]&16384&&(t=((C=y[14].at(0))==null?void 0:C.parentId)!==null),t?c?(c.p(y,E),E[0]&16384&&b(c,1)):(c=bn(y),c.c(),b(c,1),c.m(e,l)):c&&(se(),D(c,1,1,()=>{c=null}),ne()),E[0]&536371097&&(m=Ve(y[14]),se(),s=Gt(s,E,d,1,y,m,r,e,In,kn,null,vn),ne()),y[13]?_||(_=wn(),_.c(),_.m(f.parentNode,f)):_&&(_.d(1),_=null)},i(y){if(!u){b(c);for(let E=0;E<m.length;E+=1)b(s[E]);u=!0}},o(y){D(c);for(let E=0;E<s.length;E+=1)D(s[E]);u=!1},d(y){y&&(g(e),g(i),g(o),g(a),g(f)),c&&c.d();for(let E=0;E<s.length;E+=1)s[E].d();_&&_.d(y)}}}function Vf(n){let e,t,l,s,r;const i=[Nf,Ef],o=[];function a(f,u){var c;return u[0]&1&&(t=null),t==null&&(t=Object.keys(((c=f[0])==null?void 0:c.messages)??{}).length==0),t?0:1}return l=a(n,[-1,-1]),s=o[l]=i[l](n),{c(){e=I("div"),s.c(),this.h()},l(f){e=M(f,"DIV",{class:!0});var u=k(e);s.l(u),u.forEach(g),this.h()},h(){h(e,"class",n[2])},m(f,u){V(f,e,u),o[l].m(e,null),r=!0},p(f,u){let c=l;l=a(f,u),l===c?o[l].p(f,u):(se(),D(o[c],1,1,()=>{o[c]=null}),ne(),s=o[l],s?s.p(f,u):(s=o[l]=i[l](f),s.c()),b(s,1),s.m(e,null)),(!r||u[0]&4)&&h(e,"class",f[2])},i(f){r||(b(s),r=!0)},o(f){D(s),r=!1},d(f){f&&g(e),o[l].d()}}}function Cf(n,e,t){let l,s,r,i,o;Ee(n,yt,P=>t(37,l=P)),Ee(n,hl,P=>t(38,s=P)),Ee(n,Zt,P=>t(39,r=P)),Ee(n,zt,P=>t(40,i=P)),gt();const a=Je("i18n");Ee(n,a,P=>t(16,o=P));let{className:f="h-full flex pt-8"}=e,{chatId:u=""}=e,{user:c=i}=e,{prompt:m}=e,{history:d={}}=e,{selectedModels:_}=e,{atSelectedModel:w}=e,y=[],{sendPrompt:E}=e,{continueResponse:C}=e,{regenerateResponse:S}=e,{mergeResponses:L}=e,{chatActionHandler:R}=e,{showMessage:v=()=>{}}=e,{submitMessage:N=()=>{}}=e,{addMessages:B=()=>{}}=e,{readOnly:O=!1}=e,{bottomPadding:T=!1}=e,{autoScroll:H}=e,A=20,X=!1;const oe=async()=>{const P=document.getElementById("messages-container");P.scrollTop=P.scrollTop+100,t(15,X=!0),t(33,A+=20),await De(),t(15,X=!1)},ie=()=>{const P=document.getElementById("messages-container");P.scrollTop=P.scrollHeight},re=async()=>{r||(t(0,d),await De(),await Ir(localStorage.token,u,{history:d,messages:y}),hl.set(1),await wr.set(await Mr(localStorage.token,s)))},ce=async(P,Q)=>{let $;P.parentId!==null?$=d.messages[P.parentId].childrenIds:$=Object.values(d.messages).filter(ae=>ae.parentId===null).map(ae=>ae.id),Q=Math.max(0,Math.min(Q,$.length-1));let Z=$[Q];if(P.id!==Z){let ae=d.messages[Z].childrenIds;for(;ae.length!==0;)Z=ae.at(-1),ae=d.messages[Z].childrenIds;t(0,d.currentId=Z,d)}if(await De(),(l==null?void 0:l.scrollOnBranchChange)??!0){const ae=document.getElementById("messages-container");t(29,H=ae.scrollHeight-ae.scrollTop<=ae.clientHeight+50),setTimeout(()=>{ie()},100)}},me=async P=>{if(P.parentId!==null){let Q=d.messages[P.parentId].childrenIds[Math.max(d.messages[P.parentId].childrenIds.indexOf(P.id)-1,0)];if(P.id!==Q){let $=d.messages[Q].childrenIds;for(;$.length!==0;)Q=$.at(-1),$=d.messages[Q].childrenIds;t(0,d.currentId=Q,d)}}else{let Q=Object.values(d.messages).filter(Z=>Z.parentId===null).map(Z=>Z.id),$=Q[Math.max(Q.indexOf(P.id)-1,0)];if(P.id!==$){let Z=d.messages[$].childrenIds;for(;Z.length!==0;)$=Z.at(-1),Z=d.messages[$].childrenIds;t(0,d.currentId=$,d)}}if(await De(),(l==null?void 0:l.scrollOnBranchChange)??!0){const Q=document.getElementById("messages-container");t(29,H=Q.scrollHeight-Q.scrollTop<=Q.clientHeight+50),setTimeout(()=>{ie()},100)}},Ie=async P=>{if(P.parentId!==null){let Q=d.messages[P.parentId].childrenIds[Math.min(d.messages[P.parentId].childrenIds.indexOf(P.id)+1,d.messages[P.parentId].childrenIds.length-1)];if(P.id!==Q){let $=d.messages[Q].childrenIds;for(;$.length!==0;)Q=$.at(-1),$=d.messages[Q].childrenIds;t(0,d.currentId=Q,d)}}else{let Q=Object.values(d.messages).filter(Z=>Z.parentId===null).map(Z=>Z.id),$=Q[Math.min(Q.indexOf(P.id)+1,Q.length-1)];if(P.id!==$){let Z=d.messages[$].childrenIds;for(;Z.length!==0;)$=Z.at(-1),Z=d.messages[$].childrenIds;t(0,d.currentId=$,d)}}if(await De(),(l==null?void 0:l.scrollOnBranchChange)??!0){const Q=document.getElementById("messages-container");t(29,H=Q.scrollHeight-Q.scrollTop<=Q.clientHeight+50),setTimeout(()=>{ie()},100)}},W=async(P,Q)=>{t(0,d.messages[P].annotation={...d.messages[P].annotation,rating:Q},d),await re()},G=async(P,Q,$=!0)=>{if(d.messages[P].role==="user")if($){let Z=Q,ae=ml(),ke={id:ae,parentId:d.messages[P].parentId,childrenIds:[],role:"user",content:Z,...d.messages[P].files&&{files:d.messages[P].files},models:_,timestamp:Math.floor(Date.now()/1e3)},Ce=d.messages[P].parentId;Ce!==null&&t(0,d.messages[Ce].childrenIds=[...d.messages[Ce].childrenIds,ae],d),t(0,d.messages[ae]=ke,d),t(0,d.currentId=ae,d),await De(),await E(d,Z,ae)}else t(0,d.messages[P].content=Q,d),await re();else if($){const Z=ml(),ae=d.messages[P],ke=ae.parentId,Ce={...ae,id:Z,parentId:ke,childrenIds:[],files:void 0,content:Q,timestamp:Math.floor(Date.now()/1e3)};t(0,d.messages[Z]=Ce,d),t(0,d.currentId=Z,d),ke!==null&&t(0,d.messages[ke].childrenIds=[...d.messages[ke].childrenIds,Z],d),await re()}else t(0,d.messages[P].originalContent=d.messages[P].content,d),t(0,d.messages[P].content=Q,d),await re()},ge=async(P,Q,$=null)=>{await R(u,P,Q.model,Q.id,$)},pe=async(P,Q)=>{t(0,d.messages[P]=Q,d),await re()},q=async P=>{const Q=d.messages[P],$=Q.parentId,Z=Q.childrenIds??[],ae=Z.flatMap(ke=>{var Ce;return((Ce=d.messages[ke])==null?void 0:Ce.childrenIds)??[]});$&&d.messages[$]&&t(0,d.messages[$].childrenIds=[...d.messages[$].childrenIds.filter(ke=>ke!==P),...ae],d),ae.forEach(ke=>{d.messages[ke]&&t(0,d.messages[ke].parentId=$,d)}),[P,...Z].forEach(ke=>{delete d.messages[ke]}),await De(),v({id:$}),await re()},de=()=>{if(H){const P=document.getElementById("messages-container");t(29,H=P.scrollHeight-P.scrollTop<=P.clientHeight+50),setTimeout(()=>{ie()},100)}},fe=async P=>{let Q=P;if(P.includes("{{CLIPBOARD}}")){const $=await navigator.clipboard.readText().catch(Z=>(Ae.error(o.t("Failed to read clipboard contents")),"{{CLIPBOARD}}"));Q=P.replaceAll("{{CLIPBOARD}}",$)}t(1,m=Q),await De()},_e=P=>{console.log("visible"),X||oe()};function be(P){d=P,t(0,d)}return n.$$set=P=>{"className"in P&&t(2,f=P.className),"chatId"in P&&t(3,u=P.chatId),"user"in P&&t(4,c=P.user),"prompt"in P&&t(1,m=P.prompt),"history"in P&&t(0,d=P.history),"selectedModels"in P&&t(5,_=P.selectedModels),"atSelectedModel"in P&&t(6,w=P.atSelectedModel),"sendPrompt"in P&&t(30,E=P.sendPrompt),"continueResponse"in P&&t(7,C=P.continueResponse),"regenerateResponse"in P&&t(8,S=P.regenerateResponse),"mergeResponses"in P&&t(9,L=P.mergeResponses),"chatActionHandler"in P&&t(31,R=P.chatActionHandler),"showMessage"in P&&t(32,v=P.showMessage),"submitMessage"in P&&t(10,N=P.submitMessage),"addMessages"in P&&t(11,B=P.addMessages),"readOnly"in P&&t(12,O=P.readOnly),"bottomPadding"in P&&t(13,T=P.bottomPadding),"autoScroll"in P&&t(29,H=P.autoScroll)},n.$$.update=()=>{if(n.$$.dirty[0]&1|n.$$.dirty[1]&4)if(d.currentId){let P=[],Q=d.messages[d.currentId];for(;Q&&P.length<=A;)P.unshift({...Q}),Q=Q.parentId!==null?d.messages[Q.parentId]:null;t(14,y=P)}else t(14,y=[]);n.$$.dirty[0]&536879104&&H&&T&&(async()=>(await De(),ie()))()},[d,m,f,u,c,_,w,C,S,L,N,B,O,T,y,X,o,a,oe,re,ce,me,Ie,W,G,ge,pe,q,de,H,E,R,v,A,fe,_e,be]}class du extends Re{constructor(e){super(),Le(this,e,Cf,Vf,Be,{className:2,chatId:3,user:4,prompt:1,history:0,selectedModels:5,atSelectedModel:6,sendPrompt:30,continueResponse:7,regenerateResponse:8,mergeResponses:9,chatActionHandler:31,showMessage:32,submitMessage:10,addMessages:11,readOnly:12,bottomPadding:13,autoScroll:29},null,[-1,-1])}}export{Fr as K,du as M,hf as S};
//# sourceMappingURL=DoLPNNJC.js.map
